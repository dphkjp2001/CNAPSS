import{a as B,u as I,c as U,b as W,d as _,r as n,R as e}from"./index-aeb17b9a.js";import{u as F}from"./useLoginGate-b82acd3f.js";import{d as x,r as G}from"./relativeTime-8749f4c7.js";import"./en-438d16f7.js";import{l as M,g as O}from"./careerPosts-57396a9f.js";import{P as Q}from"./Pagination-e3f1ee38.js";import"./http-e9473a88.js";x.extend(G);x.locale("en");const f=20;function p(){return e.createElement("li",{className:"animate-pulse"},e.createElement("div",{className:"h-5 w-2/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-3 h-px w-full bg-gray-100"}))}function Z({onWrite:o,primary:s}){return e.createElement("div",{className:"rounded-2xl border border-dashed border-gray-300 bg-white p-10 text-center"},e.createElement("div",{className:"mx-auto mb-3 flex h-14 w-14 items-center justify-center rounded-full bg-gray-100 text-2xl"},"💼"),e.createElement("h3",{className:"text-lg font-semibold text-gray-800"},"No posts yet"),e.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Start the first career discussion."),e.createElement("button",{onClick:o,className:"mt-6 inline-flex items-center rounded-xl px-4 py-2 text-sm font-medium text-white shadow focus:outline-none focus:ring-2 focus:ring-offset-0",style:{backgroundColor:s}},"+ Write Post"))}function X(){const{token:o}=B(),{school:s,schoolTheme:r}=I(),u=U(),d=W(),{ensureAuth:v}=F(),[l,g]=_(),c=Math.max(1,parseInt(l.get("page")||"1",10)),m=l.get("q")||"",i=l.get("sort")||"new",S=t=>{const a=new URLSearchParams(l.toString());a.set("page",String(t)),g(a,{replace:!0})},C=t=>{const a=new URLSearchParams(l.toString());t?a.set("q",t):a.delete("q"),a.set("page","1"),g(a,{replace:!0})},P=t=>{const a=new URLSearchParams(l.toString());a.set("sort",t),a.set("page","1"),g(a,{replace:!0})},[y,k]=n.useState([]),[A,L]=n.useState(0),[R,b]=n.useState(!0),[E,w]=n.useState("");n.useEffect(()=>{let t=!0;if(s)return(async()=>{b(!0),w("");try{let a;o?a=await M({school:s,page:c,limit:f,q:m,sort:i}):a=await O({school:s,page:c,limit:f,q:m,sort:i});let N=[],h=0;if(a&&typeof a=="object"&&Array.isArray(a.items)&&(N=a.items,h=Number(a.total||0)),!t)return;k(N),L(h)}catch{t&&w("Failed to load posts.")}finally{t&&b(!1)}})(),()=>{t=!1}},[s,o,c,m,i]);const j={color:(r==null?void 0:r.text)||"#111827"},q={backgroundColor:(r==null?void 0:r.primary)||"#111827"};return e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(r==null?void 0:r.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-3xl"},e.createElement("div",{className:"mb-5 flex flex-col justify-between gap-3 sm:flex-row sm:items-center"},e.createElement("h2",{className:"text-2xl font-bold tracking-tight",style:j},"Career Board"),e.createElement("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center"},e.createElement("div",{className:"relative sm:w-80"},e.createElement("input",{type:"search",value:m,onChange:t=>C(t.target.value),placeholder:"Search posts",className:"w-full rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 placeholder:text-gray-400 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"search posts"})),e.createElement("select",{value:i,onChange:t=>P(t.target.value),className:"rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"sort posts"},e.createElement("option",{value:"new"},"Newest"),e.createElement("option",{value:"old"},"Oldest")),e.createElement("button",{onClick:()=>v(()=>d(u("/career/write"))),className:"inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-900/10",style:q},"+ Write"))),e.createElement("ul",{className:"divide-y divide-gray-100 rounded-2xl border border-gray-200 bg-white p-4 sm:p-5"},R?e.createElement(e.Fragment,null,e.createElement(p,null),e.createElement(p,null),e.createElement(p,null)):E?e.createElement("li",{className:"p-4 text-sm text-red-700"},E):y.length===0?e.createElement("li",{className:"p-4"},e.createElement(Z,{onWrite:()=>d(u("/career/write")),primary:(r==null?void 0:r.primary)||"#111827"})):y.map(t=>e.createElement("li",{key:t._id,className:"py-3"},e.createElement("button",{onClick:()=>d(u(`/career/${t._id}`)),className:"w-full text-left"},e.createElement("div",{className:"text-base font-medium text-gray-900"},t.title),e.createElement("div",{className:"mt-1 text-xs text-gray-500"},x(t.createdAt).fromNow()," · 💬 ",t.commentsCount??"-"," · 👍"," ",t.likesCount??"-"))))),e.createElement(Q,{page:c,total:A,limit:f,onPageChange:S,className:"mb-8"})))}export{X as default};
