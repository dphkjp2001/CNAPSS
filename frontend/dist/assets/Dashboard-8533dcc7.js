import{u as N,a as v,b as w,c as h,r as d,l as P,R as e,d as E,e as A}from"./index-dc274167.js";import"./en-255401c1.js";import{u as k}from"./useLoginGate-00956e88.js";import{l as S,g as H}from"./posts-b5874beb.js";const L=a=>a==="personalNote"?"personal note":"personal material";function U(){const{token:a}=N(),{school:m,schoolTheme:n}=v(),t=w(),{ensureAuth:u}=k(),r=h(),[s,g]=d.useState([]),[f,y]=d.useState(!0),[b,p]=d.useState("");return d.useEffect(()=>{let l=!0;if(!(!a||!m))return(async()=>{try{y(!0),p("");const i=await P({school:m,token:a,limit:5});if(!l)return;g(Array.isArray(i==null?void 0:i.items)?i.items:[])}catch{if(!l)return;p("Failed to load recent materials."),g([])}finally{l&&y(!1)}})(),()=>{l=!1}},[a,m]),e.createElement("div",{className:"rounded-2xl bg-white p-6 shadow-sm"},e.createElement("h2",{className:"mb-4 text-xl font-semibold",style:{color:(n==null?void 0:n.text)||"#4f46e5"}},"CourseHub"),f?e.createElement("ul",{className:"space-y-3"},Array.from({length:4}).map((l,i)=>e.createElement("li",{key:i,className:"animate-pulse"},e.createElement("div",{className:"h-5 w-3/4 rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 rounded bg-gray-100"})))):b?e.createElement("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},b):s.length===0?e.createElement("div",{className:"rounded-lg border border-dashed p-4 text-sm text-gray-600"},"No posts yet."):e.createElement("ul",{className:"divide-y"},s.map(l=>e.createElement("li",{key:l.id,className:"py-3"},e.createElement("button",{type:"button",className:"block w-full text-left hover:bg-gray-50",onClick:()=>u(()=>r(t(`/courses/materials/${l.id}?course=${encodeURIComponent(l.courseCode||"")}&sem=${encodeURIComponent(l.semester||"")}`)))},e.createElement("div",{className:"flex items-center justify-between gap-3"},e.createElement("div",{className:"min-w-0"},e.createElement("div",{className:"truncate text-sm font-medium text-gray-900"},l.courseTitle||l.courseCode||"Unknown course",e.createElement("span",{className:"mx-2 text-gray-400"},"‚Äî"),e.createElement("span",{className:"text-gray-700"},"N/A"),e.createElement("span",{className:"mx-2 text-gray-400"},"‚Äî"),e.createElement("span",{className:"text-gray-600"},L(l.materialType))),e.createElement("div",{className:"mt-1 truncate text-xs text-gray-500"},l.title)),e.createElement("span",{className:"shrink-0 text-xs text-blue-600 underline"},"open")))))),e.createElement("div",{className:"mt-4 flex justify-end gap-2"},e.createElement("button",{onClick:()=>u(()=>r(t("/courses/write"))),className:"rounded-xl border px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50"},"Upload note"),e.createElement("button",{onClick:()=>u(()=>r(t("/courses"))),className:"rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white"},"Open Course Hub")))}E.extend(A);E.locale("en");const j=a=>({background:a||"linear-gradient(135deg, rgba(124,58,237,0.12), rgba(99,102,241,0.12))"});function _(){const{user:a,token:m}=N(),{school:n,schoolTheme:t}=v(),{ensureAuth:u}=k(),r=h(),s=w(),[g,f]=d.useState([]),[y,b]=d.useState(!0),[p,l]=d.useState("");d.useEffect(()=>{let o=!0;if(n)return(async()=>{b(!0),l("");try{let c;m?c=await S({school:n,token:m}):c=await H({school:n,page:1,limit:10});const C=Array.isArray(c)?c:Array.isArray(c==null?void 0:c.items)?c.items:[];o&&f(C.slice(0,5))}catch{o&&l("Failed to load posts.")}finally{o&&b(!1)}})(),()=>{o=!1}},[n,m]);const i=d.useMemo(()=>((a==null?void 0:a.nickname)||(a!=null&&a.email?a.email.split("@")[0]:"Guest")).slice(0,2).toUpperCase(),[a]);return e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(t==null?void 0:t.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-7xl"},e.createElement("div",{className:"grid grid-cols-1 gap-5 lg:grid-cols-12"},e.createElement("aside",{className:"lg:col-span-3"},e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-6 shadow-sm"},e.createElement("div",{className:"mx-auto mb-4 flex h-24 w-24 items-center justify-center rounded-full text-2xl font-bold text-gray-900",style:j(t==null?void 0:t.bg)},i),e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-lg font-bold text-gray-900"},(a==null?void 0:a.nickname)||"Guest"),e.createElement("div",{className:"mt-0.5 text-xs uppercase tracking-wide text-gray-500"},(n==null?void 0:n.toUpperCase())||"SCHOOL")),e.createElement("nav",{className:"mt-6 space-y-2 text-sm"},e.createElement(x,{onClick:()=>r(s("/myposts"))},"My Posts"),e.createElement(x,{onClick:()=>r(s("/liked"))},"Liked"),e.createElement(x,{onClick:()=>r(s("/commented"))},"Commented"),e.createElement(x,{onClick:()=>r(s("/personal-schedule"))},"Schedule"),e.createElement(x,{onClick:()=>r(s("/market"))},"Marketplace"),e.createElement(x,{onClick:()=>r(s("/foodmap"))},"Food Map")))),e.createElement("main",{className:"lg:col-span-6"},e.createElement("section",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{className:"mb-3 flex items-center justify-between"},e.createElement("h2",{onClick:()=>r(s("/freeboard")),className:"cursor-pointer text-2xl font-extrabold hover:underline",style:{color:(t==null?void 0:t.text)||"#4c1d95"}},"Free Board")),y?e.createElement("ul",{className:"space-y-4"},Array.from({length:3}).map((o,c)=>e.createElement("li",{key:c},e.createElement("div",{className:"h-5 w-2/3 animate-pulse rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 animate-pulse rounded bg-gray-100"})))):p?e.createElement("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},p):g.length===0?e.createElement("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center text-sm text-gray-600"},"No posts yet. Be the first to write!"):e.createElement("ul",{className:"divide-y divide-gray-100"},g.map(o=>e.createElement("li",{key:o._id,className:"py-4"},e.createElement("button",{onClick:()=>u(()=>r(s(`/freeboard/${o._id}`))),className:"block w-full text-left"},e.createElement("h3",{className:"line-clamp-1 text-base font-semibold text-gray-900 hover:underline"},o.title),e.createElement("p",{className:"mt-1 text-xs text-gray-500"},E(o.createdAt).fromNow()))))),e.createElement("div",{className:"mt-4 text-right"},e.createElement("button",{onClick:()=>u(()=>r(s("/freeboard/write"))),className:"rounded-xl px-4 py-2 text-sm font-semibold text-white shadow",style:{backgroundColor:(t==null?void 0:t.primary)||"#6b46c1"}},"+ Write Post"))),e.createElement("section",{className:"mt-5 rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{className:"mb-3 flex items-center justify-between"},e.createElement("h2",{onClick:()=>r(s("/courses")),className:"cursor-pointer text-2xl font-extrabold hover:underline",style:{color:(t==null?void 0:t.text)||"#4c1d95"}},"CourseHub")),e.createElement(U,null))),e.createElement("aside",{className:"space-y-5 lg:col-span-3"},e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("h3",{onClick:()=>r(s("/courses")),className:"mb-3 cursor-pointer text-lg font-bold text-gray-900 hover:underline"},"Course Hub"),e.createElement("div",{className:"flex gap-2"},e.createElement("button",{onClick:()=>r(s("/courses/write")),className:"flex-1 rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 shadow-sm hover:bg-gray-50"},"Upload note"),e.createElement("button",{onClick:()=>r(s("/courses")),className:"flex-1 rounded-xl px-3 py-2 text-sm font-semibold text-white shadow",style:{backgroundColor:(t==null?void 0:t.primary)||"#6b46c1"}},"Open Course Hub"))),e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{onClick:()=>r(s("/foodmap")),className:"mb-2 cursor-pointer text-sm font-semibold text-gray-900 hover:underline"},"üç± Explore Nearby Food"),e.createElement("p",{className:"text-xs text-gray-600"},"Discover top-rated restaurants and cafes near campus."),e.createElement("div",{className:"mt-3 h-28 w-full overflow-hidden rounded-lg bg-gray-100"},e.createElement("div",{className:"h-full w-full animate-pulse"})))))))}function x({children:a,onClick:m}){return e.createElement("button",{onClick:m,className:"w-full rounded-xl border border-transparent px-3 py-2 text-left text-gray-700 hover:border-gray-200 hover:bg-gray-50"},a)}export{_ as default};
