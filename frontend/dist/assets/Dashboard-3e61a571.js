import{u as j,a as F,b as _,c as L,r as n,l as U,R as e}from"./index-d0f85cd5.js";import{d as i,r as W}from"./relativeTime-bc1ba464.js";import"./en-267888ef.js";import{u as B}from"./useLoginGate-662786d7.js";import{l as H,g as D}from"./posts-9dac44f5.js";i.extend(W);i.locale("en");const M=d=>{switch(d){case"personalMaterial":return"personal material";case"personalClassNote":return"personal class note";default:return d||"material"}};function z(){const{user:d,token:c}=j(),{school:o,schoolTheme:s}=F(),{ensureAuth:u}=B(),r=_(),l=L(),[x,k]=n.useState([]),[C,f]=n.useState(!0),[p,y]=n.useState("");n.useEffect(()=>{let t=!0;if(o)return(async()=>{f(!0),y("");try{let a;c?a=await H({school:o,token:c}):a=await D({school:o,page:1,limit:10});const m=Array.isArray(a)?a:Array.isArray(a==null?void 0:a.items)?a.items:[];t&&k(m.slice(0,5))}catch{t&&y("Failed to load posts.")}finally{t&&f(!1)}})(),()=>{t=!1}},[o,c]);const[g,A]=n.useState([]),[P,b]=n.useState(!0),[N,E]=n.useState("");n.useEffect(()=>{let t=!0;if(o)return(async()=>{b(!0),E("");try{const a=await U({school:o,token:c,limit:5}),m=Array.isArray(a==null?void 0:a.items)?a.items:Array.isArray(a)?a:[];t&&A(m)}catch{t&&E("Failed to load CourseHub items.")}finally{t&&b(!1)}})(),()=>{t=!1}},[o,c]);const w={color:(s==null?void 0:s.text)||"#4c1d95"},h={backgroundColor:(s==null?void 0:s.primary)||"#6b46c1"};return e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6 lg:px-8",style:{backgroundColor:(s==null?void 0:s.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto w-full max-w-6xl space-y-6"},e.createElement("section",{className:"rounded-2xl border border-gray-200 bg-white p-4 sm:p-6 shadow-sm"},e.createElement("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},e.createElement("h2",{onClick:()=>r(l("/freeboard")),className:"cursor-pointer text-lg font-semibold sm:text-xl hover:underline",style:w},"Free Board"),e.createElement("button",{onClick:()=>u(()=>r(l("/freeboard/write"))),className:"w-full rounded-xl px-4 py-2 text-sm font-semibold text-white shadow sm:w-auto",style:h},"+ Write Post")),C?e.createElement("ul",{className:"space-y-3"},Array.from({length:5}).map((t,a)=>e.createElement("li",{key:a},e.createElement("div",{className:"h-5 w-3/4 animate-pulse rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 animate-pulse rounded bg-gray-100"})))):p?e.createElement("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},p):x.length===0?e.createElement("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center text-sm text-gray-600"},"No posts yet. Be the first to write!"):e.createElement("ul",{className:"divide-y divide-gray-100"},x.map(t=>e.createElement("li",{key:t._id,className:"py-3"},e.createElement("button",{onClick:()=>u(()=>r(l(`/freeboard/${t._id}`))),className:"flex w-full items-center justify-between text-left"},e.createElement("h3",{className:"min-w-0 truncate text-sm font-semibold text-gray-900 sm:text-base hover:underline"},t.title),e.createElement("span",{className:"ml-3 shrink-0 text-xs text-gray-500"},i(t.createdAt).fromNow())))))),e.createElement("section",{className:"rounded-2xl border border-gray-200 bg-white p-4 sm:p-6 shadow-sm"},e.createElement("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},e.createElement("h2",{onClick:()=>r(l("/courses")),className:"cursor-pointer text-lg font-semibold sm:text-xl hover:underline",style:w},"CourseHub"),e.createElement("div",{className:"flex w-full gap-2 sm:w-auto"},e.createElement("button",{onClick:()=>u(()=>r(l("/courses/write"))),className:"flex-1 rounded-xl border px-4 py-2 text-sm font-medium hover:bg-gray-50 sm:flex-none"},"Upload note"),e.createElement("button",{onClick:()=>r(l("/courses")),className:"flex-1 rounded-xl px-4 py-2 text-sm font-semibold text-white shadow sm:flex-none",style:h},"Open Course Hub"))),P?e.createElement("ul",{className:"space-y-3"},Array.from({length:5}).map((t,a)=>e.createElement("li",{key:a,className:"flex items-center justify-between py-2"},e.createElement("div",{className:"h-4 w-2/3 animate-pulse rounded bg-gray-100"}),e.createElement("div",{className:"h-3 w-16 animate-pulse rounded bg-gray-100"})))):N?e.createElement("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},N):g.length===0?e.createElement("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center text-sm text-gray-600"},"No postings yet."):e.createElement("ul",{className:"space-y-2"},g.map(t=>{const a=t._id||t.id,m=(t.courseCode||t.course||"").toUpperCase(),S=t.professor||"Unknown",R=M(t.materialType),v=(t.listingType||"sale")==="wanted";return e.createElement("li",{key:a,className:"rounded-xl border p-3 hover:bg-gray-50"},e.createElement("button",{onClick:()=>r(l(`/courses/materials/${a}`)),className:"flex w-full items-center justify-between text-left"},e.createElement("div",{className:"min-w-0"},e.createElement("div",{className:"flex flex-wrap items-center gap-2"},e.createElement("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-semibold "+(v?"bg-rose-100 text-rose-700":"bg-emerald-100 text-emerald-700")},v?"Wanted":"For Sale"),e.createElement("span",{className:"truncate text-sm font-semibold text-gray-900 sm:text-base"},m||"UNKNOWN"),e.createElement("span",{className:"truncate text-xs font-medium text-gray-700 sm:text-sm"},S),e.createElement("span",{className:"truncate text-[11px] text-gray-500 sm:text-xs"},R))),e.createElement("span",{className:"ml-3 shrink-0 text-xs text-gray-400"},t.createdAt?i(t.createdAt).fromNow():"")))}))),e.createElement("section",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{onClick:()=>r(l("/foodmap")),className:"mb-2 cursor-pointer text-sm font-semibold text-gray-900 hover:underline"},"üç± Explore Nearby Food"),e.createElement("p",{className:"text-xs text-gray-600"},"Discover top-rated restaurants and cafes near campus."),e.createElement("div",{className:"mt-3 h-48 w-full overflow-hidden rounded-lg bg-gray-100"},e.createElement("div",{className:"h-full w-full animate-pulse"})))))}export{z as default};
