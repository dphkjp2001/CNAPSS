import{u as R,a as j,b as L,c as M,r as o,l as U,R as e}from"./index-ed30e632.js";import{d as u,r as F}from"./relativeTime-9a72948e.js";import"./en-b56e49dc.js";import{u as _}from"./useLoginGate-fb09db8b.js";import{l as H,g as O}from"./posts-ade9d204.js";u.extend(F);u.locale("en");const B=r=>({background:r||"linear-gradient(135deg, rgba(124,58,237,0.12), rgba(99,102,241,0.12))"}),D=r=>{switch(r){case"personalMaterial":return"personal material";case"personalClassNote":return"personal class note";default:return r||"material"}};function z(){const{user:r,token:m}=R(),{school:c,schoolTheme:s}=j(),{ensureAuth:p}=_(),l=L(),n=M(),[x,w]=o.useState([]),[k,y]=o.useState(!0),[g,b]=o.useState("");o.useEffect(()=>{let t=!0;if(c)return(async()=>{y(!0),b("");try{let a;m?a=await H({school:c,token:m}):a=await O({school:c,page:1,limit:10});const d=Array.isArray(a)?a:Array.isArray(a==null?void 0:a.items)?a.items:[];t&&w(d.slice(0,5))}catch{t&&b("Failed to load posts.")}finally{t&&y(!1)}})(),()=>{t=!1}},[c,m]);const[f,h]=o.useState([]),[C,E]=o.useState(!0),[N,v]=o.useState("");o.useEffect(()=>{let t=!0;if(c)return(async()=>{E(!0),v("");try{const a=await U({school:c,token:m,limit:5}),d=Array.isArray(a==null?void 0:a.items)?a.items:Array.isArray(a)?a:[];t&&h(d)}catch{t&&v("Failed to load CourseHub items.")}finally{t&&E(!1)}})(),()=>{t=!1}},[c,m]);const A=o.useMemo(()=>((r==null?void 0:r.nickname)||(r!=null&&r.email?r.email.split("@")[0]:"Guest")).slice(0,2).toUpperCase(),[r]);return e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(s==null?void 0:s.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-7xl"},e.createElement("div",{className:"grid grid-cols-1 gap-5 lg:grid-cols-12"},e.createElement("aside",{className:"lg:col-span-2"},e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{className:"mx-auto mb-3 flex h-20 w-20 items-center justify-center rounded-full text-xl font-bold text-gray-900",style:B(s==null?void 0:s.bg)},A),e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-base font-bold text-gray-900"},(r==null?void 0:r.nickname)||"Guest"),e.createElement("div",{className:"mt-0.5 text-[11px] uppercase tracking-wide text-gray-500"},(c==null?void 0:c.toUpperCase())||"SCHOOL")),e.createElement("nav",{className:"mt-5 space-y-1.5 text-sm"},e.createElement(i,{onClick:()=>l(n("/myposts"))},"My Posts"),e.createElement(i,{onClick:()=>l(n("/liked"))},"Liked"),e.createElement(i,{onClick:()=>l(n("/commented"))},"Commented"),e.createElement(i,{onClick:()=>l(n("/personal-schedule"))},"My Schedule"),e.createElement(i,{onClick:()=>l(n("/market"))},"Marketplace"),e.createElement(i,{onClick:()=>l(n("/foodmap"))},"Food Map")))),e.createElement("main",{className:"lg:col-span-7"},e.createElement("section",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{className:"mb-3 flex items-center justify-between"},e.createElement("h2",{onClick:()=>l(n("/freeboard")),className:"cursor-pointer text-2xl font-extrabold hover:underline",style:{color:(s==null?void 0:s.text)||"#4c1d95"}},"Free Board"),e.createElement("button",{onClick:()=>p(()=>l(n("/freeboard/write"))),className:"rounded-xl px-4 py-2 text-sm font-semibold text-white shadow",style:{backgroundColor:(s==null?void 0:s.primary)||"#6b46c1"}},"+ Write Post")),k?e.createElement("ul",{className:"space-y-4"},Array.from({length:3}).map((t,a)=>e.createElement("li",{key:a},e.createElement("div",{className:"h-5 w-2/3 animate-pulse rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 animate-pulse rounded bg-gray-100"})))):g?e.createElement("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},g):x.length===0?e.createElement("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center text-sm text-gray-600"},"No posts yet. Be the first to write!"):e.createElement("ul",{className:"divide-y divide-gray-100"},x.map(t=>e.createElement("li",{key:t._id,className:"py-3"},e.createElement("button",{onClick:()=>p(()=>l(n(`/freeboard/${t._id}`))),className:"flex w-full items-center justify-between text-left"},e.createElement("h3",{className:"min-w-0 truncate text-base font-semibold text-gray-900 hover:underline"},t.title),e.createElement("span",{className:"ml-3 shrink-0 text-xs text-gray-500"},u(t.createdAt).fromNow())))))),e.createElement("section",{className:"mt-5 rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{className:"mb-3 flex items-center justify-between"},e.createElement("h2",{onClick:()=>l(n("/courses")),className:"cursor-pointer text-2xl font-extrabold hover:underline",style:{color:(s==null?void 0:s.text)||"#4c1d95"}},"CourseHub"),e.createElement("div",{className:"flex gap-2"},e.createElement("button",{onClick:()=>p(()=>l(n("/courses/write"))),className:"rounded-xl border px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50"},"Upload note"),e.createElement("button",{onClick:()=>l(n("/courses")),className:"rounded-xl px-4 py-2 text-sm font-semibold text-white shadow",style:{backgroundColor:(s==null?void 0:s.primary)||"#6b46c1"}},"Open Course Hub"))),C?e.createElement("ul",{className:"space-y-3"},Array.from({length:5}).map((t,a)=>e.createElement("li",{key:a,className:"flex items-center justify-between py-2"},e.createElement("div",{className:"h-4 w-2/3 animate-pulse rounded bg-gray-100"}),e.createElement("div",{className:"h-3 w-16 animate-pulse rounded bg-gray-100"})))):N?e.createElement("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},N):f.length===0?e.createElement("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center text-sm text-gray-600"},"No postings yet."):e.createElement("ul",{className:"divide-y divide-gray-100"},f.map(t=>{const a=t._id||t.id,d=(t.courseCode||t.course||"").toUpperCase(),P=t.professor||"Unknown",S=D(t.materialType);return e.createElement("li",{key:a,className:"py-3"},e.createElement("button",{onClick:()=>l(n(`/courses/materials/${a}`)),className:"flex w-full items-center justify-between text-left"},e.createElement("div",{className:"min-w-0"},e.createElement("div",{className:"flex flex-wrap items-baseline gap-x-12 gap-y-1"},e.createElement("span",{className:"truncate text-base font-semibold text-gray-900"},d||"UNKNOWN"),e.createElement("span",{className:"truncate text-sm font-medium text-gray-700"},P),e.createElement("span",{className:"truncate text-xs text-gray-500"},S))),e.createElement("span",{className:"ml-3 shrink-0 text-xs text-gray-500"},t.createdAt?u(t.createdAt).fromNow():"")))})))),e.createElement("aside",{className:"space-y-5 lg:col-span-3"},e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{onClick:()=>l(n("/foodmap")),className:"mb-2 cursor-pointer text-sm font-semibold text-gray-900 hover:underline"},"üç± Explore Nearby Food"),e.createElement("p",{className:"text-xs text-gray-600"},"Discover top-rated restaurants and cafes near campus."),e.createElement("div",{className:"mt-3 h-48 w-full overflow-hidden rounded-lg bg-gray-100"},e.createElement("div",{className:"h-full w-full animate-pulse"})))))))}function i({children:r,onClick:m}){return e.createElement("button",{onClick:m,className:"w-full rounded-xl border border-transparent px-3 py-2 text-left text-gray-700 hover:border-gray-200 hover:bg-gray-50"},r)}export{z as default};
