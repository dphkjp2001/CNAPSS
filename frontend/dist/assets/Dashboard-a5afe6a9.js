import{u as H,a as X,b as J,c as Z,r as o,R as e}from"./index-4b427570.js";import{u as ee}from"./uploadToCloudinary-dc971086.js";import{l as te,g as ae,c as re}from"./posts-52d3e736.js";import{l as le,g as ne,c as G}from"./careerPosts-bd65ad74.js";const w={pageBg:"#FAFAFA",text:"#0F172A",sub:"#64748B",border:"rgba(0,0,0,0.12)",primary:"#111827",pink:"#FF6B8A",red:"#FF7A70"};function se(){return e.createElement("svg",{viewBox:"0 0 24 24",width:"22",height:"22","aria-hidden":!0},e.createElement("circle",{cx:"12",cy:"8",r:"4",fill:"#cbd5e1"}),e.createElement("path",{d:"M4 20c0-4 4-6 8-6s8 2 8 6",fill:"#cbd5e1"}))}function oe({value:a,onChange:r}){const t=a==="general",n=o.useRef(null),s=o.useRef(null),[i,d]=o.useState({w:0,x:0}),[x,c]=o.useState(null),g=()=>{const l=n.current,m=s.current;if(!l||!m)return;const y=(t?l.offsetWidth:m.offsetWidth)||0,N=t?0:(l.offsetWidth||0)+8;d({w:y,x:N})};o.useLayoutEffect(()=>{g();const f=new ResizeObserver(g);return n.current&&f.observe(n.current),s.current&&f.observe(s.current),()=>f.disconnect()},[t]);const p=()=>{r("general"),c("general"),setTimeout(()=>c(null),360)},h=()=>{r("academic"),c("academic"),setTimeout(()=>c(null),360)};return e.createElement(e.Fragment,null,e.createElement("style",null,`
        @keyframes nudge {0%{transform:translateY(0) rotate(0)}
          28%{transform:translateY(-2px) rotate(-4deg) scale(1.02)}
          56%{transform:translateY(1px) rotate(3deg)}
          84%{transform:translateY(-1px) rotate(-2deg) scale(1.01)}
          100%{transform:translateY(0) rotate(0)}}
        .emoji-wiggle{animation:nudge 340ms ease-in-out}
      `),e.createElement("div",{className:"w-full flex justify-center"},e.createElement("div",{className:"relative inline-flex items-center gap-2 p-1 rounded-full"},e.createElement("span",{"aria-hidden":!0,className:"absolute top-1 bottom-1 rounded-full transition-transform duration-300 ease-out pointer-events-none",style:{width:i.w||148,transform:`translateX(${i.x||0}px)`,background:"transparent",borderStyle:"solid",borderWidth:2,borderImageSlice:1,borderImageSource:`linear-gradient(90deg, ${w.pink}, ${w.red})`}}),e.createElement("button",{ref:n,type:"button",onClick:p,className:`relative z-10 h-11 px-5 rounded-full text-[15px] transition-colors ${t?"text-slate-900":"text-slate-600 hover:text-slate-800"}`,style:{background:"transparent"},"aria-pressed":t},e.createElement("span",{className:`inline-block mr-1 ${x==="general"?"emoji-wiggle":""}`,"aria-hidden":!0},"ðŸ’¬"),e.createElement("span",{style:{fontWeight:t?700:600}},"Freeboard")),e.createElement("button",{ref:s,type:"button",onClick:h,className:`relative z-10 h-11 px-5 rounded-full text-[15px] transition-colors ${t?"text-slate-600 hover:text-slate-800":"text-slate-900"}`,style:{background:"transparent"},"aria-pressed":!t},e.createElement("span",{className:`inline-block mr-1 ${x==="academic"?"emoji-wiggle":""}`,"aria-hidden":!0},"ðŸŽ“"),e.createElement("span",{style:{fontWeight:t?600:700}},"Academic")))))}function ce({children:a}){return e.createElement("div",{className:"rounded-2xl bg-white shadow-lg overflow-hidden"},a)}function ie({valueCode:a,setValueCode:r,valueName:t,setValueName:n,placeholder:s="Type code or name"}){const[i,d]=o.useState([]),[x,c]=o.useState(!1),[g,p]=o.useState("");o.useEffect(()=>{let l=!0;return(async()=>{try{const y=await(await fetch("/NYU_course_DATA.json")).json();if(!l)return;const N=(Array.isArray(y)?y:[]).map((u,S)=>{const A=u.code||u.course_code||u.courseCode||u.id||"",C=u.name||u.course_name||u.title||"";return{id:`${A}-${S}`,code:String(A||"").trim(),name:String(C||"").trim()}}).filter(u=>u.code||u.name);d(N)}catch{d([])}})(),()=>{l=!1}},[]);const h=o.useMemo(()=>{const l=g.trim().toLowerCase();return l?i.filter(({code:m,name:y})=>m.toLowerCase().includes(l)||y.toLowerCase().includes(l)).slice(0,12):i.slice(0,12)},[g,i]),f=l=>{r(l.code),n(l.name),p(`${l.code} â€” ${l.name}`),c(!1)};return o.useEffect(()=>{a||t?p(`${a||""}${a&&t?" â€” ":""}${t||""}`):x||p("")},[a,t]),e.createElement("div",{className:"relative"},e.createElement("input",{type:"text",value:g,onChange:l=>{p(l.target.value),c(!0)},onFocus:()=>c(!0),placeholder:s,className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:w.border},"aria-autocomplete":"list","aria-expanded":x}),x&&e.createElement("div",{className:"absolute z-20 mt-1 w-full rounded-xl border bg-white shadow-lg max-h-72 overflow-auto",style:{borderColor:w.border}},h.length?h.map(l=>e.createElement("button",{key:l.id,type:"button",onClick:()=>f(l),className:"w-full text-left px-3.5 py-2 hover:bg-slate-50"},e.createElement("div",{className:"text-[14px] font-semibold text-slate-900"},l.code||"â€”"),e.createElement("div",{className:"text-[13px] text-slate-600"},l.name||""))):e.createElement("div",{className:"px-3.5 py-3 text-[13px] text-slate-500"},"No matches.")),x&&e.createElement("button",{type:"button",className:"fixed inset-0 cursor-default","aria-hidden":!0,onClick:()=>c(!1),style:{background:"transparent"}}),(a||t)&&e.createElement("p",{className:"mt-1 text-[12px] text-slate-500"},"Selected: ",e.createElement("span",{className:"font-medium"},a||"â€”"),a&&t?" â€” ":" ",t||""))}function me({title:a,setTitle:r,content:t,setContent:n,images:s,setImages:i}){const d=c=>{const g=Array.from(c.target.files||[]);g.length&&i(p=>[...p,...g].slice(0,6))},x=c=>i(g=>g.filter((p,h)=>h!==c));return e.createElement("div",{className:"p-4"},e.createElement("div",{className:"text-[13px] font-semibold text-slate-700 mb-2"},"Write to Freeboard"),e.createElement("input",{type:"text",value:a,onChange:c=>r(c.target.value),placeholder:'e.g. "Best late-night study spots near Bobst?"',className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:w.border}}),e.createElement("textarea",{value:t,onChange:c=>n(c.target.value),rows:4,placeholder:"Share details or ask a follow-up.",className:"mt-3 w-full resize-y rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:w.border}}),e.createElement("div",{className:"mt-3"},e.createElement("label",{className:"block text-[12px] font-medium text-slate-600 mb-1"},"Photos (up to 6)"),e.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:d}),!!s.length&&e.createElement("div",{className:"mt-2 grid grid-cols-3 gap-2"},s.map((c,g)=>e.createElement("div",{key:g,className:"relative"},e.createElement("img",{src:URL.createObjectURL(c),alt:"",className:"aspect-square w-full object-cover rounded-lg"}),e.createElement("button",{type:"button",className:"absolute right-1 top-1 rounded-full bg-black/70 text-white text-xs px-1.5 py-0.5",onClick:()=>x(g)},"âœ•"))))),e.createElement("p",{className:"mt-2 text-[11px] text-slate-500"},"Posting as anonymous."))}function ue({mode:a,setMode:r,title:t,setTitle:n,content:s,setContent:i,courseCode:d,setCourseCode:x,courseName:c,setCourseName:g,materialType:p,setMaterialType:h,extraNote:f,setExtraNote:l}){return e.createElement("div",{className:"p-4"},e.createElement("div",{className:"text-[13px] font-semibold text-slate-700 mb-2"},"Write to Academic"),e.createElement("div",{className:"mb-3 inline-flex rounded-full border border-slate-200 p-1 bg-white"},e.createElement("button",{type:"button",onClick:()=>r("question"),className:`h-9 px-4 rounded-full text-sm ${a==="question"?"font-semibold text-slate-900":"text-slate-600"}`,style:a==="question"?{background:"linear-gradient(#fff,#fff) padding-box, linear-gradient(90deg,#FF6B8A,#FF7A70) border-box",border:"2px solid transparent"}:{}},"Question"),e.createElement("button",{type:"button",onClick:()=>r("looking_for"),className:`h-9 px-4 rounded-full text-sm ${a==="looking_for"?"font-semibold text-slate-900":"text-slate-600"}`,style:a==="looking_for"?{background:"linear-gradient(#fff,#fff) padding-box, linear-gradient(90deg,#FF6B8A,#FF7A70) border-box",border:"2px solid transparent"}:{}},"Looking for")),e.createElement("input",{type:"text",value:t,onChange:m=>n(m.target.value),placeholder:a==="question"?'e.g. "Which prof is better for DS-UA 201?"':'e.g. "Looking for DS-UA 201 midterm review"',className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:w.border}}),a==="question"?e.createElement("textarea",{value:s,onChange:m=>i(m.target.value),rows:5,placeholder:`Share details or ask a follow-up.
â€¢ Interview prep notes?
â€¢ Advice for course planning?`,className:"mt-3 w-full resize-y rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:w.border}}):e.createElement(e.Fragment,null,e.createElement("div",{className:"mt-3 grid grid-cols-1 gap-3"},e.createElement("div",null,e.createElement("label",{className:"block text-[12px] font-medium text-slate-600 mb-1"},"Course (code or name)"),e.createElement(ie,{valueCode:d,setValueCode:x,valueName:c,setValueName:g,placeholder:"Start typing course code or nameâ€¦"})),e.createElement("div",null,e.createElement("label",{className:"block text-[12px] font-medium text-slate-600 mb-1"},"Material type"),e.createElement("input",{type:"text",value:p,onChange:m=>h(m.target.value),placeholder:"e.g. syllabus, midterm review, past exams",className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:w.border}}))),e.createElement("textarea",{value:f,onChange:m=>l(m.target.value),rows:4,placeholder:"Any extra details (links allowed)",className:"mt-3 w-full resize-y rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:w.border}}),e.createElement("p",{className:"mt-2 text-[11px] text-slate-500"},"This post will be highlighted as ",e.createElement("strong",null,"Looking for")," in the feed.")))}function de({images:a=[]}){if(!a.length)return null;const r=a.slice(0,4),t=a.length-r.length;return r.length===1?e.createElement("div",{className:"mt-3 overflow-hidden rounded-xl"},e.createElement("img",{src:r[0],alt:"",className:"w-full max-h-[520px] object-cover",loading:"lazy"})):r.length===2?e.createElement("div",{className:"mt-3 grid grid-cols-2 gap-2 rounded-xl overflow-hidden"},r.map((n,s)=>e.createElement("img",{key:s,src:n,alt:"",className:"aspect-square w-full object-cover",loading:"lazy"}))):e.createElement("div",{className:"mt-3 grid grid-cols-2 gap-2 rounded-xl overflow-hidden"},e.createElement("img",{src:r[0],alt:"",className:"col-span-2 aspect-[2/1] w-full object-cover",loading:"lazy"}),r.slice(1).map((n,s)=>{const i=s===r.slice(1).length-1&&t>0;return e.createElement("div",{key:s,className:"relative"},e.createElement("img",{src:n,alt:"",className:"aspect-square w-full object-cover",loading:"lazy"}),i&&e.createElement("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center"},e.createElement("span",{className:"text-white text-lg font-semibold"},"+",t)))}))}function ge({rows:a=8}){return e.createElement("ul",{className:"mx-auto max-w-[700px] px-2 py-2 divide-y-2 divide-slate-300/90"},Array.from({length:a}).map((r,t)=>e.createElement("li",{key:t,className:"py-5"},e.createElement("div",{className:"flex items-start gap-3"},e.createElement("div",{className:"h-9 w-9 rounded-full bg-slate-200 animate-pulse"}),e.createElement("div",{className:"flex-1 space-y-2"},e.createElement("div",{className:"h-4 w-3/4 rounded bg-slate-200 animate-pulse"}),e.createElement("div",{className:"h-3 w-1/2 rounded bg-slate-200 animate-pulse"})),e.createElement("div",{className:"h-3 w-12 rounded bg-slate-200 animate-pulse"})))))}function fe({post:a,onOpenDetail:r}){return e.createElement("article",{role:"button",tabIndex:0,onClick:r,onKeyDown:t=>(t.key==="Enter"||t.key===" ")&&r(),className:"mx-auto max-w-[700px] px-2 focus:outline-none"},e.createElement("div",{className:"group -mx-2 px-2 py-5 hover:bg-slate-50 transition"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:"h-9 w-9 rounded-full bg-slate-100 flex items-center justify-center"},e.createElement(se,null))),e.createElement("time",{className:"text-[12px] text-slate-500"},a.ago)),e.createElement("div",{className:"mt-2 flex items-start gap-2 flex-wrap"},a.lookingFor&&e.createElement("span",{className:"inline-flex items-center text-white text-[11px] font-semibold px-2 py-0.5 rounded-full bg-gradient-to-r from-[#FF6B8A] to-[#FF7A70]"},"Looking for",a.courseCode||a.courseName?` Â· ${a.courseCode||""}${a.courseCode&&a.courseName?" â€” ":""}${a.courseName||""}`:""),a.title?e.createElement("h3",{className:"text-[16px] font-semibold text-slate-900 leading-snug break-words"},a.title):null),a.firstUrl&&e.createElement("span",{className:"mt-1 block text-[14px] text-blue-600 underline-offset-2 group-hover:underline break-all"},a.firstUrl),a.preview&&e.createElement("p",{className:"mt-1 text-[14px] text-slate-800 whitespace-pre-line break-words"},a.preview),e.createElement(de,{images:a.images}),e.createElement("div",{className:"mt-3 flex items-center gap-6 text-[13px] text-slate-600"},e.createElement("span",{className:"inline-flex items-center gap-1"},e.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0},e.createElement("path",{d:"M12 21s-7-4.35-7-10a4 4 0 0 1 7-2 4 4 0 0 1 7 2c0 5.65-7 10-7 10z",stroke:"currentColor",strokeWidth:"2"})),a.likes),e.createElement("span",{className:"inline-flex items-center gap-1"},e.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0},e.createElement("path",{d:"M21 15a4 4 0 0 1-4 4H9l-6 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4v8z",stroke:"currentColor",strokeWidth:"2"})),a.comments))))}function Ne(){const a=H(),{school:r}=X(),{user:t}=J(),n=Z(),s=!!t,i=r||"nyu",[d,x]=o.useState("general"),[c,g]=o.useState({loading:!0,items:[]}),[p,h]=o.useState({loading:!0,items:[]}),[f,l]=o.useState(""),[m,y]=o.useState(""),[N,u]=o.useState([]),[S,A]=o.useState("question"),[C,_]=o.useState(""),[$,T]=o.useState(""),[P,j]=o.useState(""),[U,B]=o.useState(""),[W,R]=o.useState(!1),[q,F]=o.useState({type:"",text:""});o.useEffect(()=>{let b=!0;async function E(){g(k=>({...k,loading:!0})),h(k=>({...k,loading:!0}));try{const[k,v]=await Promise.all([s?te({school:i,limit:30,sort:"new"}):ae({school:i,limit:30,sort:"new"}),s?le({school:i,limit:30,sort:"new"}):ne({school:i,limit:30,sort:"new"})]);if(!b)return;g({loading:!1,items:Y(k)}),h({loading:!1,items:Y(v)})}catch{if(!b)return;g({loading:!1,items:[]}),h({loading:!1,items:[]})}}return E(),()=>{b=!1}},[s,i]);const L=d==="general"?c:p,M=()=>a(n("/freeboard")),z=()=>a(n("/career")),O=b=>{const E=b.slug||b._id||b.id;if(!E)return d==="general"?M():z();const k=n(d==="general"?`/freeboard/${E}`:`/career/${E}`);a(k)},D=s&&f.trim()&&(m.trim()||N.length),I=s&&f.trim()&&(S==="question"?m.trim():C.trim()&&P.trim()),K=async b=>{const E=[];for(const k of b)try{const v=await ee(k);(v!=null&&v.secure_url||v!=null&&v.url)&&E.push(v.secure_url||v.url)}catch{}return E},V=async b=>{if(b.preventDefault(),F({type:"",text:""}),!s){F({type:"error",text:"Login required to post."});return}R(!0);try{if(d==="general"){if(!D)throw new Error("Missing fields");let E=[];N.length&&(E=await K(N)),await re({school:i,title:f.trim(),content:m.trim(),images:E}),F({type:"success",text:"Posted to Freeboard! Redirectingâ€¦"}),setTimeout(M,400)}else{if(!I)throw new Error("Missing fields");const E={school:i,title:f.trim()};S==="question"?await G({...E,content:m.trim(),postType:"question"}):await G({...E,content:(m||U).trim(),postType:"looking_for",kind:"looking_for",category:"looking_for",lookingFor:!0,isLookingFor:!0,courseCode:C.trim(),courseName:$.trim(),materialType:P.trim(),meta:{courseCode:C.trim(),courseName:$.trim(),materialType:P.trim()}}),F({type:"success",text:"Posted to Academic! Redirectingâ€¦"}),setTimeout(z,400)}l(""),y(""),u([]),_(""),T(""),j(""),B(""),A("question")}catch{F({type:"error",text:"Failed to post. Please check required fields."})}finally{R(!1)}},Q=o.useMemo(()=>d==="general"?{footer:e.createElement(e.Fragment,null,"Posting to ",e.createElement("strong",null,"Freeboard")," as anonymous.")}:{footer:e.createElement(e.Fragment,null,"Posting to ",e.createElement("strong",null,"Academic Board")," as anonymous.")},[d]);return e.createElement("div",{className:"min-h-screen",style:{background:w.pageBg}},e.createElement("main",{className:"mx-auto max-w-6xl px-4 py-6 grid grid-cols-1 md:grid-cols-[minmax(620px,700px)_380px] gap-10"},e.createElement("section",{className:"md:col-start-1"},e.createElement(oe,{value:d,onChange:x}),L.loading?e.createElement(ge,{rows:10}):L.items.length?e.createElement("ul",{className:"mt-3 mx-auto max-w-[700px] px-2 divide-y-2 divide-slate-300/90"},L.items.map(b=>e.createElement("li",{key:b._id},e.createElement(fe,{post:b,onOpenDetail:()=>O(b)})))):e.createElement("div",{className:"mx-auto max-w-[700px] text-center py-16"},e.createElement("p",{className:"text-[15px] text-slate-600"},"No posts yet."),e.createElement("button",{type:"button",onClick:d==="general"?M:z,className:"mt-4 px-4 py-2 rounded-xl bg-black text-white text-[14px] font-semibold"},"Open ",d==="general"?"Freeboard":"Academic Board"))),e.createElement("aside",{className:"md:col-start-2 md:sticky md:top-[24px] self-start"},e.createElement(ce,null,e.createElement("form",{onSubmit:V},d==="general"?e.createElement(me,{title:f,setTitle:l,content:m,setContent:y,images:N,setImages:u}):e.createElement(ue,{mode:S,setMode:A,title:f,setTitle:l,content:m,setContent:y,courseCode:C,setCourseCode:_,courseName:$,setCourseName:T,materialType:P,setMaterialType:j,extraNote:U,setExtraNote:B}),e.createElement("div",{className:"px-4 pb-4 pt-2 flex items-center justify-between"},e.createElement("span",{className:"text-xs text-slate-500"},Q.footer),e.createElement("div",{className:"flex gap-2"},e.createElement("button",{type:"button",onClick:()=>{l(""),y(""),u([]),_(""),T(""),j(""),B(""),A("question"),F({type:"",text:""})},className:"rounded-xl border px-3.5 py-2 text-sm font-semibold hover:bg-black/5",style:{borderColor:w.border}},"Clear"),e.createElement("button",{type:"submit",disabled:W||(d==="general"?!D:!I),className:"rounded-xl px-4 py-2 text-white text-sm font-semibold disabled:opacity-50",style:{background:w.primary}},W?"Posting...":"Post"))),q.text&&e.createElement("div",{className:`mx-4 mb-4 rounded-xl px-3 py-2 text-sm ${q.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`},q.text))))))}function Y(a){return(Array.isArray(a==null?void 0:a.items)&&a.items||Array.isArray(a==null?void 0:a.data)&&a.data||Array.isArray(a)&&a||[]).slice(0,50).map(t=>{var y,N;const n=(t.title||t.subject||"").toString().trim(),s=(t.content||t.text||t.body||"").toString(),i=xe([t.link,t.url,t.sourceUrl,s]),d=s.replace(/https?:\/\/[^\s)]+/gi,"").trim(),x=pe(n,d).slice(0,240),c=typeof t.commentsCount=="number"&&t.commentsCount||(Array.isArray(t.comments)?t.comments.length:0)||(typeof t.replies=="number"?t.replies:0),g=typeof t.likesCount=="number"&&t.likesCount||(Array.isArray(t.likes)?t.likes.length:0)||(typeof t.upvotes=="number"?t.upvotes:0),p=t.lookingFor||t.isLookingFor||t.kind==="looking_for"||t.category==="looking_for"||t.postType==="looking_for"||t.type==="looking_for",h=t.courseCode||t.course||t.course_code||((y=t==null?void 0:t.meta)==null?void 0:y.courseCode)||"",f=t.courseName||t.course_name||((N=t==null?void 0:t.meta)==null?void 0:N.courseName)||"",m=(Array.isArray(t.images)&&t.images||Array.isArray(t.imageUrls)&&t.imageUrls||Array.isArray(t.media)&&t.media||[]).map(u=>typeof u=="string"?u:(u==null?void 0:u.url)||(u==null?void 0:u.secure_url)||"").filter(Boolean);return{_id:t._id||t.id||Math.random().toString(36).slice(2),slug:t.slug,title:n,preview:x,firstUrl:i,comments:c,likes:g,ago:t.createdAt?be(t.createdAt):"",lookingFor:!!p,courseCode:h,courseName:f,images:m}})}function xe(a){const t=a.filter(Boolean).join(" ").match(/https?:\/\/[^\s)]+/i);return t?t[0]:null}function pe(a,r){if(!a)return r;const t=a.trim(),n=r.trim();return n?n.toLowerCase().startsWith(t.toLowerCase())?n.slice(t.length).trim():n:""}function be(a){try{const r=new Date(a),t=Math.floor((Date.now()-r.getTime())/1e3);return t<60?`${t}s ago`:t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}catch{return""}}export{Ne as default};
