import{u as Oe,a as Ie,b as He,c as De,d as ze,r as g,R as r}from"./index-e0330f19.js";import{u as Ye}from"./uploadToCloudinary-dc971086.js";import{g as Ue,c as Be}from"./posts-11cdb806.js";import{g as Fe,c as G}from"./academicPosts-01d2e02d.js";import"./http-a6fe908c.js";var Ee={exports:{}},u={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V=Symbol.for("react.transitional.element"),Ke=Symbol.for("react.portal"),Qe=Symbol.for("react.fragment"),Ge=Symbol.for("react.strict_mode"),We=Symbol.for("react.profiler"),Ze=Symbol.for("react.consumer"),Ve=Symbol.for("react.context"),Xe=Symbol.for("react.forward_ref"),Je=Symbol.for("react.suspense"),et=Symbol.for("react.memo"),be=Symbol.for("react.lazy"),tt=Symbol.for("react.activity"),de=Symbol.iterator;function rt(e){return e===null||typeof e!="object"?null:(e=de&&e[de]||e["@@iterator"],typeof e=="function"?e:null)}var ve={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_e=Object.assign,we={};function M(e,t,s){this.props=e,this.context=t,this.refs=we,this.updater=s||ve}M.prototype.isReactComponent={};M.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};M.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ke(){}ke.prototype=M.prototype;function X(e,t,s){this.props=e,this.context=t,this.refs=we,this.updater=s||ve}var J=X.prototype=new ke;J.constructor=X;_e(J,M.prototype);J.isPureReactComponent=!0;var pe=Array.isArray;function Z(){}var p={H:null,A:null,T:null,S:null},Ne=Object.prototype.hasOwnProperty;function ee(e,t,s){var a=s.ref;return{$$typeof:V,type:e,key:t,ref:a!==void 0?a:null,props:s}}function st(e,t){return ee(e.type,t,e.props)}function te(e){return typeof e=="object"&&e!==null&&e.$$typeof===V}function nt(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var ge=/\/+/g;function W(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nt(""+e.key):t.toString(36)}function at(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(Z,Z):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function T(e,t,s,a,c){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var m=!1;if(e===null)m=!0;else switch(o){case"bigint":case"string":case"number":m=!0;break;case"object":switch(e.$$typeof){case V:case Ke:m=!0;break;case be:return m=e._init,T(m(e._payload),t,s,a,c)}}if(m)return c=c(e),m=a===""?"."+W(e,0):a,pe(c)?(s="",m!=null&&(s=m.replace(ge,"$&/")+"/"),T(c,t,s,"",function(h){return h})):c!=null&&(te(c)&&(c=st(c,s+(c.key==null||e&&e.key===c.key?"":(""+c.key).replace(ge,"$&/")+"/")+m)),t.push(c)),1;m=0;var f=a===""?".":a+":";if(pe(e))for(var y=0;y<e.length;y++)a=e[y],o=f+W(a,y),m+=T(a,t,s,o,c);else if(y=rt(e),typeof y=="function")for(e=y.call(e),y=0;!(a=e.next()).done;)a=a.value,o=f+W(a,y++),m+=T(a,t,s,o,c);else if(o==="object"){if(typeof e.then=="function")return T(at(e),t,s,a,c);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return m}function D(e,t,s){if(e==null)return e;var a=[],c=0;return T(e,a,"","",function(o){return t.call(s,o,c++)}),a}function ot(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ye=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},it={map:D,forEach:function(e,t,s){D(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(t){return t})||[]},only:function(e){if(!te(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};u.Activity=tt;u.Children=it;u.Component=M;u.Fragment=Qe;u.Profiler=We;u.PureComponent=X;u.StrictMode=Ge;u.Suspense=Je;u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=p;u.__COMPILER_RUNTIME={__proto__:null,c:function(e){return p.H.useMemoCache(e)}};u.cache=function(e){return function(){return e.apply(null,arguments)}};u.cacheSignal=function(){return null};u.cloneElement=function(e,t,s){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var a=_e({},e.props),c=e.key;if(t!=null)for(o in t.key!==void 0&&(c=""+t.key),t)!Ne.call(t,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&t.ref===void 0||(a[o]=t[o]);var o=arguments.length-2;if(o===1)a.children=s;else if(1<o){for(var m=Array(o),f=0;f<o;f++)m[f]=arguments[f+2];a.children=m}return ee(e.type,c,a)};u.createContext=function(e){return e={$$typeof:Ve,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:Ze,_context:e},e};u.createElement=function(e,t,s){var a,c={},o=null;if(t!=null)for(a in t.key!==void 0&&(o=""+t.key),t)Ne.call(t,a)&&a!=="key"&&a!=="__self"&&a!=="__source"&&(c[a]=t[a]);var m=arguments.length-2;if(m===1)c.children=s;else if(1<m){for(var f=Array(m),y=0;y<m;y++)f[y]=arguments[y+2];c.children=f}if(e&&e.defaultProps)for(a in m=e.defaultProps,m)c[a]===void 0&&(c[a]=m[a]);return ee(e,o,c)};u.createRef=function(){return{current:null}};u.forwardRef=function(e){return{$$typeof:Xe,render:e}};u.isValidElement=te;u.lazy=function(e){return{$$typeof:be,_payload:{_status:-1,_result:e},_init:ot}};u.memo=function(e,t){return{$$typeof:et,type:e,compare:t===void 0?null:t}};u.startTransition=function(e){var t=p.T,s={};p.T=s;try{var a=e(),c=p.S;c!==null&&c(s,a),typeof a=="object"&&a!==null&&typeof a.then=="function"&&a.then(Z,ye)}catch(o){ye(o)}finally{t!==null&&s.types!==null&&(t.types=s.types),p.T=t}};u.unstable_useCacheRefresh=function(){return p.H.useCacheRefresh()};u.use=function(e){return p.H.use(e)};u.useActionState=function(e,t,s){return p.H.useActionState(e,t,s)};u.useCallback=function(e,t){return p.H.useCallback(e,t)};u.useContext=function(e){return p.H.useContext(e)};u.useDebugValue=function(){};u.useDeferredValue=function(e,t){return p.H.useDeferredValue(e,t)};u.useEffect=function(e,t){return p.H.useEffect(e,t)};u.useEffectEvent=function(e){return p.H.useEffectEvent(e)};u.useId=function(){return p.H.useId()};u.useImperativeHandle=function(e,t,s){return p.H.useImperativeHandle(e,t,s)};u.useInsertionEffect=function(e,t){return p.H.useInsertionEffect(e,t)};u.useLayoutEffect=function(e,t){return p.H.useLayoutEffect(e,t)};u.useMemo=function(e,t){return p.H.useMemo(e,t)};u.useOptimistic=function(e,t){return p.H.useOptimistic(e,t)};u.useReducer=function(e,t,s){return p.H.useReducer(e,t,s)};u.useRef=function(e){return p.H.useRef(e)};u.useState=function(e){return p.H.useState(e)};u.useSyncExternalStore=function(e,t,s){return p.H.useSyncExternalStore(e,t,s)};u.useTransition=function(){return p.H.useTransition()};u.version="19.2.0";Ee.exports=u;var L=Ee.exports;/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ct=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,a)=>a?a.toUpperCase():s.toLowerCase()),he=e=>{const t=ct(e);return t.charAt(0).toUpperCase()+t.slice(1)},Ce=(...e)=>e.filter((t,s,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===s).join(" ").trim(),ut=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=L.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:c="",children:o,iconNode:m,...f},y)=>L.createElement("svg",{ref:y,...mt,width:t,height:t,stroke:e,strokeWidth:a?Number(s)*24/Number(t):s,className:Ce("lucide",c),...!o&&!ut(f)&&{"aria-hidden":"true"},...f},[...m.map(([h,j])=>L.createElement(h,j)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=(e,t)=>{const s=L.forwardRef(({className:a,...c},o)=>L.createElement(ft,{ref:o,iconNode:t,className:Ce(`lucide-${lt(he(e))}`,`lucide-${e}`,a),...c}));return s.displayName=he(e),s};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],pt=q("bookmark",dt);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],yt=q("message-square",gt);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]],xt=q("repeat-2",ht);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],bt=q("send",Et);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]],_t=q("share",vt),wt={pageBg:"#FFFFFF",text:"#0F172A",sub:"#64748B",primary:"#111827",pink:"#FF6B8A",red:"#FF7A70"},kt=(e="")=>String(e).toLowerCase().trim().replace(/[\s_-]+/g,"_"),Ae=(e={})=>{const t=e.postType||e.type||e.mode||(e.lookingFor?"seeking":"question")||"",s=String(t).toLowerCase();return s==="looking_for"||s==="seeking"||s==="lf"?"seeking":"question"},Nt=(e={})=>{const t=kt(e.kind||"");if(t)return t;const s=[e.kind,...Array.isArray(e.tags)?e.tags:[],e.title,e.content].filter(Boolean).join(" ").toLowerCase();return/(course\s*materials?|syllabus|notes?|exam|midterm|final|assignment|hw|homework)/.test(s)?"course_materials":/(study\s*(mate|group)|\bstudy\b|team\s*up)/.test(s)?"study_mate":/(coffee\s*chat|coffee\s*time|\bchat\b)/.test(s)?"coffee_chat":""};function Ct(e){const t=new Date(e),a=new Date-t,c=Math.floor(a/6e4),o=Math.floor(c/60),m=Math.floor(o/24);return c<60?`${c} mins ago`:o<24?`${o} hs ago`:m===1?"yesterday":`${m} days ago`}function At(){return r.createElement("svg",{viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":!0},r.createElement("circle",{cx:"12",cy:"8",r:"4",fill:"#cbd5e1"}),r.createElement("path",{d:"M4 20c0-4 4-6 8-6s8 2 8 6",fill:"#cbd5e1"}))}function St({children:e}){return r.createElement("div",{className:"rounded-2xl bg-white shadow-lg overflow-hidden"},e)}function Tt({post:e,onOpenDetail:t,showBadge:s,showActionsBar:a=!1,commentCount:c=0}){var S;const o=e.raw||{},m=Ae(o),f=Nt(o),y=m==="seeking"?f==="course_materials"?"📝":f==="study_mate"?"👥":f==="coffee_chat"?"☕️":"📌":"",h={lecture_notes:"Lecture Notes",syllabus:"Syllabus",past_exams:"Past Exams",quiz_prep:"Quiz Prep"},N=(Array.isArray(o.materials)&&f==="course_materials"?o.materials:[]).map(w=>h[w]||w);return r.createElement("button",{type:"button",onClick:t,className:"w-full text-left py-4 px-3 hover:bg-slate-50 transition"},r.createElement("div",{className:"flex items-start gap-3"},s?r.createElement("span",{className:"text-[18px] w-6 text-center mt-[2px]"},y):r.createElement("span",{className:"w-6"}),r.createElement("div",{className:"h-8 w-8 rounded-full bg-slate-200 flex items-center justify-center mt-[2px]"},r.createElement(At,null)),r.createElement("div",{className:"min-w-0 flex-1"},r.createElement("div",{className:"flex items-start justify-between gap-3"},r.createElement("div",{className:"truncate font-semibold text-slate-900"},e.title),r.createElement("div",{className:"text-xs text-slate-500 whitespace-nowrap"},Ct(e.createdAt))),((S=e.raw)==null?void 0:S.content)&&r.createElement("p",{className:"mt-1 text-[13.5px] text-slate-600 line-clamp-1"},e.raw.content),N.length>0&&r.createElement("div",{className:"mt-3 flex flex-wrap gap-2"},N.map(w=>r.createElement("span",{key:w,className:"inline-flex items-center rounded-full border border-slate-700 bg-slate-50 px-2.5 py-[3px] text-[11px] text-slate-700"},w))),a&&r.createElement("div",{className:"flex items-center justify-between mt-2 pr-1 pl-[0px] text-slate-500 text-[13px]"},r.createElement("div",{className:"flex items-center gap-6"},r.createElement(pt,{size:18,className:"hover:text-slate-800 cursor-pointer"}),r.createElement(xt,{size:18,className:"hover:text-slate-800 cursor-pointer"}),r.createElement(_t,{size:18,className:"hover:text-slate-800 cursor-pointer"}),r.createElement("div",{className:"flex items-center gap-1"},r.createElement(bt,{size:17,className:"hover:text-slate-800 cursor-pointer"}),r.createElement("span",{className:"text-xs font-medium"},"DM"))),r.createElement("div",{className:"flex items-center gap-1 text-sm"},r.createElement(yt,{size:17,className:"hover:text-slate-800 cursor-pointer"}),r.createElement("span",null,c??0))))))}const Mt=e=>e?Array.isArray(e)?e:Array.isArray(e.items)?e.items:Array.isArray(e.data)?e.data:e.data&&Array.isArray(e.data.items)?e.data.items:[]:[],xe=e=>Mt(e).map(t=>({_id:t._id||t.id,title:t.title||(typeof t.content=="string"?t.content.slice(0,80):"Untitled"),createdAt:t.createdAt||t.updatedAt||new Date().toISOString(),raw:t}));function jt(){const e=Oe(),t=Ie(),{school:s}=He(),{user:a}=De(),c=ze(),o=typeof s=="string"&&s?s.toLowerCase():"nyu",m=()=>{const n=new URLSearchParams(t.search),i=n.get("tab")==="free"?"general":"academic",d={q:n.get("q")||""},l={q:n.get("q")||"",type:n.get("type")||"all",kind:n.get("kind")||""};return{active:i,freeQuery:d,acadQuery:l}},[{active:f,freeQuery:y,acadQuery:h},j]=g.useState(m());g.useEffect(()=>j(m()),[t.search]);const[N,S]=g.useState({loading:!0,items:[],error:""}),[w,Se]=g.useState(12),z=g.useMemo(()=>{const{q:n}=y;let i=N.items;if(n){const d=n.toLowerCase();i=i.filter(l=>{var E;return l.title.toLowerCase().includes(d)||(((E=l.raw)==null?void 0:E.content)||"").toLowerCase().includes(d)})}return i},[N.items,y]),O={loading:N.loading,error:N.error,items:z.slice(0,w),hasMore:z.length>w},[x,C]=g.useState({items:[],page:1,limit:20,total:0,loading:!0,loadingMore:!1,hasMore:!0,error:""}),R=g.useCallback(async(n=1,i=!1)=>{var me,fe;if(!o||o==="undefined"){C(je=>({...je,loading:!1,loadingMore:!1}));return}const d={school:o,page:n,limit:x.limit,q:h.q||"",sort:"new"};h.type&&h.type!=="all"&&(d.type=h.type),h.type==="seeking"&&h.kind&&(d.kind=h.kind);const l=await Fe(d),E=xe(l),k=typeof(l==null?void 0:l.total)=="number"?l.total:typeof((me=l==null?void 0:l.paging)==null?void 0:me.total)=="number"?l.paging.total:i?x.total:E.length,qe=typeof(l==null?void 0:l.limit)=="number"?l.limit:typeof((fe=l==null?void 0:l.paging)==null?void 0:fe.limit)=="number"?l.paging.limit:x.limit,ue=i?[...x.items,...E]:E;C({items:ue,page:n,limit:qe,total:k,loading:!1,loadingMore:!1,hasMore:ue.length<k&&E.length>0,error:""})},[o,h]);g.useEffect(()=>{let n=!0;return(async()=>{try{const i=await Ue({school:o,limit:200,sort:"new"});if(!n)return;S({loading:!1,items:xe(i),error:""})}catch(i){if(!n)return;S({loading:!1,items:[],error:(i==null?void 0:i.message)||"Failed to load posts."})}})(),()=>{n=!1}},[o]),g.useEffect(()=>{C(n=>({...n,loading:!0,error:"",page:1})),R(1,!1).catch(n=>C(i=>({...i,loading:!1,error:(n==null?void 0:n.message)||"Failed to load posts."})))},[o,h.q,h.type,h.kind,R]);const Y=g.useRef(null),U=g.useRef(null);g.useEffect(()=>{if(!Y.current)return;const n=new IntersectionObserver(i=>{i[0].isIntersecting&&Se(l=>l+10)},{rootMargin:"400px 0px 400px 0px"});return n.observe(Y.current),()=>n.disconnect()},[z.length]),g.useEffect(()=>{if(!U.current)return;const n=new IntersectionObserver(i=>{i[0].isIntersecting&&x.hasMore&&!x.loading&&!x.loadingMore&&(C(l=>({...l,loadingMore:!0})),R(x.page+1,!0).catch(l=>C(E=>({...E,loadingMore:!1,error:(l==null?void 0:l.message)||"Failed to load more."}))))},{rootMargin:"600px 0px 600px 0px"});return n.observe(U.current),()=>n.disconnect()},[x.hasMore,x.loading,x.loadingMore,x.page,R]);const Te=(n,i)=>{var E,k;const d=((E=n.raw)==null?void 0:E._id)||n._id||((k=n.raw)==null?void 0:k.id)||n.id;if(!d)return;const l=i==="general"?`/freeboard/${d}`:`/academic/${d}`;e(c(l))},[b,re]=g.useState(""),[A,se]=g.useState(""),[B,Me]=g.useState([]),[v,F]=g.useState("question"),[_,ne]=g.useState("course_materials"),[ae,oe]=g.useState(""),[I,ie]=g.useState([]),Re=[{key:"lecture_notes",label:"Lecture Notes"},{key:"syllabus",label:"Syllabus"},{key:"past_exams",label:"Past Exams"},{key:"quiz_prep",label:"Quiz Prep"}],Pe=n=>ie(i=>i.includes(n)?i.filter(d=>d!==n):[...i,n]),[H,le]=g.useState(!1),[K,P]=g.useState({type:"",text:""}),ce=!!a&&b.trim()&&(A.trim()||B.length),Q=!!a&&(v==="question"?b.trim()&&A.trim():_==="course_materials"?b.trim()&&I.length>0:b.trim()),$e=async n=>{const i=[];for(const d of n)try{const l=await Ye(d);(l!=null&&l.secure_url||l!=null&&l.url)&&i.push(l.secure_url||l.url)}catch{}return i},Le=async n=>{if(n.preventDefault(),P({type:"",text:""}),!a){P({type:"error",text:"Login required to post."});return}le(!0);try{if(f==="general"){if(!ce)throw new Error("Missing fields");let i=[];B.length&&(i=await $e(B)),await Be({school:o,title:b.trim(),content:A.trim(),images:i}),S(d=>({...d,items:[{_id:Math.random().toString(36).slice(2),title:b.trim(),createdAt:new Date().toISOString(),raw:{title:b.trim(),content:A.trim()}},...d.items]}))}else{if(!Q)throw new Error("Missing fields");const i={school:o};v==="question"?await G({...i,title:b.trim(),content:A.trim(),postType:"question"}):_==="course_materials"?await G({...i,title:b.trim(),content:"",postType:"seeking",kind:"course_materials",courseName:b.trim(),professor:ae.trim(),materials:I,tags:["seeking","course_materials"]}):await G({...i,title:b.trim(),content:A.trim(),postType:"seeking",kind:_,tags:["seeking",_]}),C(d=>({...d,loading:!0})),await R(1,!1)}re(""),se(""),Me([]),F("question"),ne("course_materials"),oe(""),ie([]),P({type:"success",text:"Posted!"}),setTimeout(()=>P({type:"",text:""}),1200)}catch(i){P({type:"error",text:(i==null?void 0:i.message)||"Failed to post."})}finally{le(!1)}},$=f==="general"?{loading:O.loading,items:O.items,hasMore:O.hasMore,error:O.error}:{loading:x.loading,items:x.items,hasMore:x.hasMore,error:x.error,loadingMore:x.loadingMore};return r.createElement("div",{className:"min-h-screen",style:{background:wt.pageBg}},r.createElement("main",{className:"mx-auto max-w-6xl px-4 py-6 grid grid-cols-1 md:grid-cols-[minmax(620px,700px)_380px] gap-10"},r.createElement("section",{className:"md:col-start-1"},$.loading?r.createElement("ul",{className:"mt-4 space-y-3"},Array.from({length:10}).map((n,i)=>r.createElement("li",{key:i,className:"h-16 rounded-xl bg-white/70 border border-slate-200 animate-pulse"}))):$.items.length?r.createElement(r.Fragment,null,r.createElement("ul",{className:"mt-5 mx-auto max-w-[700px] px-2 space-y-4"},$.items.map(n=>{var l,E,k;const i=f==="general"||f==="academic"&&Ae(n.raw||{})==="question",d=((l=n.raw)==null?void 0:l.commentCount)??((E=n.raw)==null?void 0:E.commentsCount)??(Array.isArray((k=n.raw)==null?void 0:k.comments)?n.raw.comments.length:0);return r.createElement("li",{key:n._id||Math.random()},r.createElement("div",{className:"mx-6 border-b border-slate-300/80 py-3"},r.createElement(Tt,{post:n,onOpenDetail:()=>Te(n,f),showBadge:f==="academic",showActionsBar:i,commentCount:d})))})),r.createElement("div",{className:"flex justify-center py-6"},r.createElement("div",{ref:f==="general"?Y:U,className:"h-6 w-6 rounded-full border-2 border-dashed border-slate-300","aria-hidden":!0})),f==="academic"&&$.loadingMore&&r.createElement("div",{className:"text-center pb-8 text-slate-500 text-sm"},"Loading more…")):r.createElement("div",{className:"mx-auto max-w-[700px] text-center py-16"},r.createElement("p",{className:"text-[15px] text-slate-600"},$.error||"No posts yet."))),r.createElement("aside",{className:"md:col-start-2 md:sticky md:top-[24px] self-start"},r.createElement(St,null,r.createElement("form",{onSubmit:Le},r.createElement("div",{className:"flex items-center gap-3 p-4 border-b border-slate-200"},r.createElement("div",{className:"shrink-0 h-10 w-10 rounded-full bg-slate-200 flex items-center justify-center"},r.createElement("svg",{viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":!0},r.createElement("circle",{cx:"12",cy:"8",r:"4",fill:"#cbd5e1"}),r.createElement("path",{d:"M4 20c0-4 4-6 8-6s8 2 8 6",fill:"#cbd5e1"}))),r.createElement("div",{className:"flex-1"},r.createElement("input",{value:b,onChange:n=>re(n.target.value),placeholder:f==="general"?"Write a catchy title for your post…":v==="question"?"Ask an academic/career question…":_==="course_materials"?"Course name (e.g., STAT101)":"Seeking… (short title)",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-[15px] font-semibold text-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900/10 focus:border-slate-900"}),r.createElement("p",{className:"mt-1 text-xs text-slate-500"},"Posting as ",r.createElement("span",{className:"font-medium"},"anonymous")))),r.createElement("div",{className:"p-4 space-y-4"},f==="academic"&&r.createElement("div",{className:"flex items-center gap-2"},r.createElement("button",{type:"button",onClick:()=>F("question"),className:`px-3 py-1.5 rounded-full text-sm border ${v==="question"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,"aria-pressed":v==="question"},"General question"),r.createElement("button",{type:"button",onClick:()=>F("seeking"),className:`px-3 py-1.5 rounded-full text-sm border ${v==="seeking"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,"aria-pressed":v==="seeking"},"Seeking 📥"),v==="seeking"&&r.createElement("select",{value:_,onChange:n=>ne(n.target.value),className:"ml-2 rounded-full border border-slate-300 px-3 py-1.5 text-sm"},r.createElement("option",{value:"course_materials"},"Course Materials"),r.createElement("option",{value:"study_mate"},"Study Mate"),r.createElement("option",{value:"coffee_chat"},"Coffee Chat"))),f==="academic"&&v==="seeking"&&_==="course_materials"?r.createElement("div",{className:"space-y-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-slate-700"},"Professor (optional)"),r.createElement("input",{type:"text",value:ae,onChange:n=>oe(n.target.value),placeholder:"Professor name (optional)",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-900/10 focus:border-slate-900"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-slate-700 mb-2"},"Personal Materials (choose one or more)"),r.createElement("div",{className:"grid grid-cols-2 gap-2"},Re.map(n=>r.createElement("label",{key:n.key,className:`flex items-center gap-2 rounded-xl border px-3 py-2 text-sm cursor-pointer ${I.includes(n.key)?"border-slate-900 bg-slate-900/5":"border-slate-300 hover:bg-slate-50"}`},r.createElement("input",{type:"checkbox",checked:I.includes(n.key),onChange:()=>Pe(n.key),className:"accent-black"}),r.createElement("span",null,n.label)))),r.createElement("p",{className:"mt-2 text-xs text-slate-500"},"You can select multiple. Title will be used as course name."))):r.createElement("textarea",{value:A,onChange:n=>se(n.target.value),placeholder:f==="general"?"Write your content here…":v==="question"?"Describe your academic/career question…":_==="study_mate"?"Describe schedule, level, topic…":"Say hello and what you'd like to chat about…",className:"w-full min-h-[120px] rounded-xl border border-slate-300 px-3 py-2 text-[14px] text-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-900/10 focus:border-slate-900"}),r.createElement("div",{className:"flex items-center justify-between pt-2"},r.createElement("p",{className:"text-[12px] text-slate-500"},"Posting to"," ",r.createElement("strong",null,f==="general"?"Freeboard":v==="question"?"Academic":`Seeking: ${_==="course_materials"?"Course Materials":_==="study_mate"?"Study Mate":"Coffee Chat"}`),"."),f==="academic"&&v==="seeking"?r.createElement("div",{className:"flex flex-col items-end"},r.createElement("button",{type:"submit",disabled:!Q||H,className:"rounded-xl bg-[#3044f0] px-4 py-2 text-sm font-semibold text-white hover:bg-[#2433c4] active:scale-[0.98] transition-all shadow-md hover:shadow-lg disabled:opacity-60"},H?"Posting…":r.createElement(r.Fragment,null,"Post"," ",r.createElement("span",{className:"line-through text-[11px] text-gray-400 ml-1"},"6 C point"))),r.createElement("span",{className:"text-[10px] text-gray-400 mt-[2px]"},"0 point during beta season")):r.createElement("button",{type:"submit",disabled:H||(f==="general"?!ce:!Q),className:"rounded-xl bg-[#3044f0] px-4 py-2 text-sm font-semibold text-white hover:bg-[#2433c4] active:scale-[0.98] transition-all shadow-md hover:shadow-lg disabled:opacity-60"},H?"Posting…":"Post")),!!K.text&&r.createElement("div",{className:`text-sm rounded-lg px-3 py-2 ${K.type==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border-red-200"}`},K.text)))))))}export{jt as default};
