import{a as L,b as j,u as M,r,R as e,L as D,d as b,c as F}from"./index-d2a4a0a2.js";import{u as _}from"./schoolPath-0e816004.js";import"./en-3d5e094e.js";import{f as B}from"./posts-5cb016d2.js";b.extend(F);b.locale("en");const y=10;function R(){return e.createElement("li",{className:"animate-pulse"},e.createElement("div",{className:"h-5 w-2/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-3 h-px w-full bg-gray-100"}))}function W({onWrite:u,primary:c}){return e.createElement("div",{className:"rounded-2xl border border-dashed border-gray-300 bg-white p-10 text-center"},e.createElement("div",{className:"mx-auto mb-3 flex h-14 w-14 items-center justify-center rounded-full bg-gray-100 text-2xl"},"📝"),e.createElement("h3",{className:"text-lg font-semibold text-gray-800"},"No posts yet"),e.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Be the first to start a discussion."),e.createElement("button",{onClick:u,className:"mt-6 inline-flex items-center rounded-xl px-4 py-2 text-sm font-medium text-white shadow focus:outline-none focus:ring-2 focus:ring-offset-0",style:{backgroundColor:c}},"+ Write Post"))}function Q(){const{user:u}=L(),{school:c,schoolTheme:a}=j(),g=_(),p=M(),[w,k]=r.useState([]),[S,h]=r.useState(!0),[E,C]=r.useState(null),[m,P]=r.useState(""),[d,A]=r.useState("new"),[o,x]=r.useState(1);r.useEffect(()=>{(async()=>{h(!0);try{const t=await B(c);k(Array.isArray(t)?t:[])}catch{C("Failed to load posts.")}finally{h(!1)}})()},[c]);const f=r.useMemo(()=>{const t=m.trim().toLowerCase();let s=w.filter(l=>{var n,v;return t?((n=l.title)==null?void 0:n.toLowerCase().includes(t))||((v=l.content)==null?void 0:v.toLowerCase().includes(t)):!0});return s=s.sort((l,n)=>d==="old"?new Date(l.createdAt)-new Date(n.createdAt):new Date(n.createdAt)-new Date(l.createdAt)),s},[w,m,d]),i=Math.max(1,Math.ceil(f.length/y)),N=f.slice((o-1)*y,o*y);return r.useEffect(()=>{x(1)},[m,d]),e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(a==null?void 0:a.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-3xl"},e.createElement("div",{className:"mb-5 flex flex-col justify-between gap-3 sm:flex-row sm:items-center"},e.createElement("h2",{className:"text-2xl font-bold tracking-tight text-gray-900"},"Free Board"),e.createElement("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center"},e.createElement("div",{className:"relative sm:w-80"},e.createElement("input",{type:"search",value:m,onChange:t=>P(t.target.value),placeholder:"Search posts",className:"w-full rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 placeholder:text-gray-400 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"search posts"})),e.createElement("select",{value:d,onChange:t=>A(t.target.value),className:"rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"sort posts"},e.createElement("option",{value:"new"},"Newest"),e.createElement("option",{value:"old"},"Oldest")),u&&e.createElement("button",{onClick:()=>p(g("/freeboard/write")),className:"inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold text-white shadow focus:outline-none focus:ring-2 focus:ring-offset-0",style:{backgroundColor:(a==null?void 0:a.primary)||"#6b46c1"}},"+ Write Post"))),S?e.createElement("ul",{className:"space-y-4 rounded-2xl border border-gray-200 bg-white p-4 shadow-sm"},Array.from({length:6}).map((t,s)=>e.createElement(R,{key:s}))):E?e.createElement("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700"},E):f.length===0?e.createElement(W,{onWrite:()=>p(g("/freeboard/write")),primary:(a==null?void 0:a.primary)||"#6b46c1"}):e.createElement(e.Fragment,null,e.createElement("ul",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm"},N.map((t,s)=>e.createElement("li",{key:t._id,className:"px-4 py-4 sm:px-6"},e.createElement(D,{to:g(`/freeboard/${t._id}`),className:"block"},e.createElement("h3",{className:"line-clamp-2 text-base font-semibold text-gray-900 hover:underline"},t.title),e.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Posted by anonymous • ",b(t.createdAt).fromNow())),s!==N.length-1&&e.createElement("div",{className:"mt-4 h-px w-full bg-gray-100"})))),i>1&&e.createElement("div",{className:"mt-6 flex items-center justify-center gap-2"},e.createElement("button",{onClick:()=>x(t=>Math.max(1,t-1)),disabled:o===1,className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm disabled:cursor-not-allowed disabled:opacity-50"},"Previous"),e.createElement("span",{className:"text-sm text-gray-600"},o," / ",i),e.createElement("button",{onClick:()=>x(t=>Math.min(i,t+1)),disabled:o===i,className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm disabled:cursor-not-allowed disabled:opacity-50"},"Next")))))}export{Q as default};
