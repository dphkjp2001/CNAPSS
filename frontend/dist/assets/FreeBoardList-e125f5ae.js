import{a as j,b as M,c as D,u as F,r as s,R as e,L as _,d as p,e as B}from"./index-50e73a55.js";import"./en-93a80531.js";import{l as R}from"./posts-a3317476.js";p.extend(B);p.locale("en");const b=10;function W(){return e.createElement("li",{className:"animate-pulse"},e.createElement("div",{className:"h-5 w-2/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-3 h-px w-full bg-gray-100"}))}function q({onWrite:u,primary:l}){return e.createElement("div",{className:"rounded-2xl border border-dashed border-gray-300 bg-white p-10 text-center"},e.createElement("div",{className:"mx-auto mb-3 flex h-14 w-14 items-center justify-center rounded-full bg-gray-100 text-2xl"},"📝"),e.createElement("h3",{className:"text-lg font-semibold text-gray-800"},"No posts yet"),e.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Be the first to start a discussion."),e.createElement("button",{onClick:u,className:"mt-6 inline-flex items-center rounded-xl px-4 py-2 text-sm font-medium text-white shadow focus:outline-none focus:ring-2 focus:ring-offset-0",style:{backgroundColor:l}},"+ Write Post"))}function Q(){const{user:u,token:l}=j(),{school:g,schoolTheme:r}=M(),x=D(),w=F(),[h,C]=s.useState([]),[P,E]=s.useState(!0),[N,v]=s.useState(""),[m,A]=s.useState(""),[i,L]=s.useState("new"),[o,f]=s.useState(1);s.useEffect(()=>{let t=!0;if(!(!g||!l))return(async()=>{E(!0),v("");try{const a=await R({school:g,token:l});t&&C(Array.isArray(a)?a:[])}catch{t&&v("Failed to load posts.")}finally{t&&E(!1)}})(),()=>{t=!1}},[g,l]);const y=s.useMemo(()=>{const t=m.trim().toLowerCase();let a=h.filter(n=>{var c,S;return t?((c=n.title)==null?void 0:c.toLowerCase().includes(t))||((S=n.content)==null?void 0:S.toLowerCase().includes(t)):!0});return a=a.sort((n,c)=>i==="old"?new Date(n.createdAt)-new Date(c.createdAt):new Date(c.createdAt)-new Date(n.createdAt)),a},[h,m,i]),d=Math.max(1,Math.ceil(y.length/b)),k=y.slice((o-1)*b,o*b);return s.useEffect(()=>{f(1)},[m,i]),e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(r==null?void 0:r.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-3xl"},e.createElement("div",{className:"mb-5 flex flex-col justify-between gap-3 sm:flex-row sm:items-center"},e.createElement("h2",{className:"text-2xl font-bold tracking-tight text-gray-900"},"Free Board"),e.createElement("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center"},e.createElement("div",{className:"relative sm:w-80"},e.createElement("input",{type:"search",value:m,onChange:t=>A(t.target.value),placeholder:"Search posts",className:"w-full rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 placeholder:text-gray-400 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"search posts"})),e.createElement("select",{value:i,onChange:t=>L(t.target.value),className:"rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"sort posts"},e.createElement("option",{value:"new"},"Newest"),e.createElement("option",{value:"old"},"Oldest")),u&&e.createElement("button",{onClick:()=>w(x("/freeboard/write")),className:"inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold text-white shadow focus:outline-none focus:ring-2 focus:ring-offset-0",style:{backgroundColor:(r==null?void 0:r.primary)||"#6b46c1"}},"+ Write Post"))),P?e.createElement("ul",{className:"space-y-4 rounded-2xl border border-gray-200 bg-white p-4 shadow-sm"},Array.from({length:6}).map((t,a)=>e.createElement(W,{key:a}))):N?e.createElement("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700"},N):y.length===0?e.createElement(q,{onWrite:()=>w(x("/freeboard/write")),primary:(r==null?void 0:r.primary)||"#6b46c1"}):e.createElement(e.Fragment,null,e.createElement("ul",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm"},k.map((t,a)=>e.createElement("li",{key:t._id,className:"px-4 py-4 sm:px-6"},e.createElement(_,{to:x(`/freeboard/${t._id}`),className:"block"},e.createElement("h3",{className:"line-clamp-2 text-base font-semibold text-gray-900 hover:underline"},t.title),e.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Posted by anonymous • ",p(t.createdAt).fromNow())),a!==k.length-1&&e.createElement("div",{className:"mt-4 h-px w-full bg-gray-100"})))),d>1&&e.createElement("div",{className:"mt-6 flex items-center justify-center gap-2"},e.createElement("button",{onClick:()=>f(t=>Math.max(1,t-1)),disabled:o===1,className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm disabled:cursor-not-allowed disabled:opacity-50"},"Previous"),e.createElement("span",{className:"text-sm text-gray-600"},o," / ",d),e.createElement("button",{onClick:()=>f(t=>Math.min(d,t+1)),disabled:o===d,className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm disabled:cursor-not-allowed disabled:opacity-50"},"Next")))))}export{Q as default};
