import{c as $,b as k,r as n,R as e}from"./index-547b6ceb.js";import{S as C,a as A}from"./schedule-6d2ebb70.js";const F=t=>t>=8?"fall":t>=5?"summer":"spring";function G(){const t=new Date,a=t.getFullYear(),l=F(t.getMonth()+1);return`${a}-${l}`}function O(){const a=new Date().getFullYear(),l=[`${a-1}-fall`,`${a}-spring`,`${a}-summer`,`${a}-fall`,`${a+1}-spring`];return Array.from(new Set(l))}const I=t=>`${t.day}-${t.start}-${t.end}`;function L(){const{token:t}=$(),{school:a}=k(),[l,f]=n.useState(""),[o,y]=n.useState(G()),h=n.useMemo(O,[]),[c,E]=n.useState(30),[w,i]=n.useState([]),[d,u]=n.useState([]),[b,p]=n.useState(!1),[g,x]=n.useState(""),v=async()=>{if(!(!t||!a)){p(!0),x(""),i([]),u([]);try{const s=l.split(",").map(m=>m.trim().toLowerCase()).filter(Boolean),r=await A({school:a,token:t,semester:o,members:s,min:c}),N=Array.isArray(r==null?void 0:r.windows)?r.windows:[],S=Array.isArray(r==null?void 0:r.missing)?r.missing:[],M=N.map(m=>({day:m.day,start:m.start,end:m.end,label:"FREE",class_number:`free-${I(m)}`}));i(M),u(S)}catch(s){console.error("Compare failed:",s),x("Failed to compare schedules. Make sure members are from the same school and saved.")}finally{p(!1)}}};return e.createElement("div",{className:"p-6"},e.createElement("h1",{className:"mb-2 text-xl font-semibold"},"Group Availability"),e.createElement("p",{className:"mb-4 text-sm text-gray-500"},"Find common free times among your team for the selected semester."),e.createElement("div",{className:"mb-3 flex flex-col gap-2 sm:flex-row sm:items-end"},e.createElement("div",null,e.createElement("label",{className:"mb-1 block text-sm text-gray-600"},"Semester"),e.createElement("select",{value:o,onChange:s=>y(s.target.value),className:"rounded-lg border px-3 py-1.5 text-sm"},h.map(s=>e.createElement("option",{key:s,value:s},s)))),e.createElement("div",{className:"sm:ml-4"},e.createElement("label",{className:"mb-1 block text-sm text-gray-600"},"Members (emails)"),e.createElement("input",{type:"text",placeholder:"friend1@school.edu, friend2@school.edu",className:"w-[360px] rounded-lg border px-3 py-1.5 text-sm",value:l,onChange:s=>f(s.target.value)})),e.createElement("div",{className:"sm:ml-4"},e.createElement("label",{className:"mb-1 block text-sm text-gray-600"},"Min free window (minutes)"),e.createElement("input",{type:"number",min:15,step:15,className:"w-28 rounded-lg border px-3 py-1.5 text-sm",value:c,onChange:s=>E(Math.max(15,parseInt(s.target.value||"30",10)))})),e.createElement("div",{className:"sm:ml-4"},e.createElement("button",{onClick:v,disabled:b||!t,className:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white disabled:opacity-60"},b?"Checking...":"Compare"))),g&&e.createElement("div",{className:"mb-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},g),!!d.length&&e.createElement("div",{className:"mb-3 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-sm text-amber-900"},"The following members donâ€™t have a saved schedule for ",e.createElement("b",null,o),":"," ",e.createElement("span",{className:"font-mono"},d.join(", "))),e.createElement(C,{schedules:w}))}export{L as default};
