const n="https://api.cnapss.com/api".replace(/\/$/,""),i=e=>({"Content-Type":"application/json",Authorization:`Bearer ${e}`});async function d({school:e,token:o,q:r,sort:s,page:t,limit:a}={}){const h=String(e||"").toLowerCase().trim(),c=new URL(`${n}/${h}/market`);r&&c.searchParams.set("q",r),s&&c.searchParams.set("sort",s),t&&c.searchParams.set("page",String(t)),a&&c.searchParams.set("limit",String(a));const m=await fetch(c,{headers:i(o)});if(!m.ok)throw new Error("Failed to load listings");return m.json()}async function w({school:e,token:o,id:r}){const s=String(e||"").toLowerCase().trim(),t=await fetch(`${n}/${s}/market/${r}`,{headers:i(o)});if(!t.ok)throw new Error("Failed to load item");return t.json()}async function f({school:e,token:o,payload:r}){const s=String(e||"").toLowerCase().trim(),t=await fetch(`${n}/${s}/market`,{method:"POST",headers:i(o),body:JSON.stringify(r)});if(!t.ok)throw new Error("Failed to create item");return t.json()}async function u({school:e,token:o,id:r,payload:s}){const t=String(e||"").toLowerCase().trim(),a=await fetch(`${n}/${t}/market/${r}`,{method:"PUT",headers:i(o),body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update item");return a.json()}async function $({school:e,token:o,id:r}){const s=String(e||"").toLowerCase().trim(),t=await fetch(`${n}/${s}/market/${r}`,{method:"DELETE",headers:i(o)});if(!t.ok)throw new Error("Failed to delete item");return t.json()}async function l({school:e,token:o,itemId:r,email:s}){const t=String(e||"").toLowerCase().trim(),a=await fetch(`${n}/${t}/market/request/${r}/${encodeURIComponent(s)}`,{headers:i(o)});if(!a.ok)throw new Error("Failed to check request");return a.json()}async function k({school:e,token:o,itemId:r,buyer:s,message:t}){const a=String(e||"").toLowerCase().trim(),h=await fetch(`${n}/${a}/market/request`,{method:"POST",headers:i(o),body:JSON.stringify({itemId:r,buyer:s,message:t})});if(!h.ok)throw new Error("Failed to send request");return h.json()}export{l as a,f as c,$ as d,w as g,d as l,k as s,u};
