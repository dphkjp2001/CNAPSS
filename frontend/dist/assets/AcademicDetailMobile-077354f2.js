import{i as j,u as I,b as L,c as R,r as p,o as T,p as C,R as e}from"./index-c8330d5b.js";import{A as D,U as G,C as B}from"./CommentSection-8c6d738f.js";import{d as b,r as M}from"./relativeTime-7fc33230.js";import{G as g,B as o,C as O,a as U}from"./graduation-cap-7b039afb.js";import"./createLucideIcon-9a7f566d.js";import"./useLoginGate-0c7ee9b3.js";b.extend(M);b.locale("en");const l=u=>u&&String(u).trim()!==""?String(u):"Not specified";function K(){var E,N,w,S;const{school:u,id:r}=j(),k=I(),{school:F}=L(),n=u||F||"nyu",{user:c,token:y}=R(),[d,f]=p.useState({loading:!0,error:"",post:null}),[h,Q]=p.useState(!1);if(console.log("✅ Rendering AcademicDetailMobile"),p.useEffect(()=>{let a=!0;return(async()=>{try{const s=await T({school:n,id:r});if(!a)return;if(console.log("✅ Public post loaded:",s),f({loading:!1,error:"",post:s}),c&&y){const m=await C({school:n,id:r});if(!a)return;f(A=>({...A,post:m||A.post}))}}catch(s){if(!a)return;console.error("❌ Failed public load:",s),f({loading:!1,error:(s==null?void 0:s.message)||"Failed to load post.",post:null})}})(),()=>{a=!1}},[n,r]),p.useEffect(()=>{if(!c)return;let a=!0;return(async()=>{try{const s=await C({school:n,id:r});if(!a)return;f(m=>({...m,post:s||m.post}))}catch{}})(),()=>{a=!1}},[c,y,n,r]),p.useEffect(()=>{if(h){const a=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=a}}},[h]),d.loading)return e.createElement("div",{className:"min-h-screen bg-[#F8F9FA] flex items-center justify-center"},e.createElement("div",{className:"text-gray-600"},"Loading…"));if(d.error)return e.createElement("div",{className:"min-h-screen bg-[#F8F9FA] flex items-center justify-center"},e.createElement("div",{className:"text-red-600"},d.error));if(!d.post)return e.createElement("div",{className:"min-h-screen bg-[#F8F9FA] flex items-center justify-center"},e.createElement("div",{className:"text-gray-600"},"Post not found."));const t=d.post,x=(t.mode||t.postType||t.type||"").toString().toLowerCase(),v=x==="seeking"||x==="looking_for",_=!v;c&&[(E=t.author)==null?void 0:E._id,(N=t.author)==null?void 0:N.id,t.userId,t.authorId].filter(Boolean).map(String).some(a=>String(a)===String(c._id||c.id));let i=[];if(_)i=[{label:"Related Course",value:l(t.courseName),icon:g},{label:"Question Details",value:l(t.content),icon:o}];else{const a=String(t.kind||"").toLowerCase().replace(/[\s-]+/g,"_");a==="course_materials"?i=[{label:"Course Name",value:l(t.title||t.courseName),icon:o},{label:"Professor",value:l(t.professor),icon:g},{label:"Semester",value:l(t.semester),icon:O},{label:"Looking for Materials",value:Array.isArray(t.materials)&&t.materials.length?t.materials.map(s=>s.replace(/_/g," ")).join(", "):"Not specified",icon:o}]:a==="coffee_chat"?i=[{label:"Title",value:l(t.title),icon:U},{label:"Topic",value:l(t.content),icon:o}]:a==="study_mate"?i=[{label:"Class",value:l(t.courseName),icon:g},{label:"Topic",value:l(t.content),icon:o}]:i=[{label:"Content",value:l(t.content),icon:o}]}const P=((w=t.author)==null?void 0:w.name)||((S=t.author)==null?void 0:S.username)||"Anonymous";return e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"sticky top-0 z-30 bg-white border-b border-gray-200"},e.createElement("div",{className:"flex items-center px-3 py-2"},e.createElement("button",{onClick:()=>k(`/${encodeURIComponent(n)}/dashboard?tab=academic`),className:"flex items-center text-gray-700"},e.createElement(D,{className:"w-5 h-5"})),e.createElement("h1",{className:"ml-3 text-base font-semibold text-gray-900 truncate"},"Academic Detail"))),e.createElement("div",{className:"px-3 py-4"},e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-3"},e.createElement(G,{className:"w-4 h-4 text-gray-400"}),e.createElement("span",null,P),e.createElement("span",null,"•"),e.createElement("span",null,b(t.createdAt).fromNow())),e.createElement("h2",{className:"text-lg font-bold text-gray-900 leading-snug"},t.title),!v&&e.createElement("span",{className:"mt-1 inline-block text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded px-2 py-0.5"},"General Question"),e.createElement("ul",{className:"mt-4 space-y-3"},i.map((a,s)=>{const m=a.icon||o;return e.createElement("li",{key:s,className:"flex items-start gap-2"},e.createElement(m,{className:"w-4 h-4 mt-0.5 text-gray-500"}),e.createElement("div",null,e.createElement("p",{className:"text-xs text-gray-500"},a.label),e.createElement("p",{className:"text-sm text-gray-900 whitespace-pre-wrap"},a.value)))})),e.createElement("div",{className:"mt-6"},e.createElement(B,{postId:t._id||r}))))}export{K as default};
