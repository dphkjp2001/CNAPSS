import{u as H,a as Q,b as V,c as X,r as c,R as e}from"./index-8f7d96be.js";import{u as J}from"./uploadToCloudinary-dc971086.js";import{l as Z,g as ee,c as te}from"./posts-da36a567.js";import{l as re,g as ae,c as D}from"./careerPosts-06cc85a8.js";const x={pageBg:"#FAFAFA",text:"#0F172A",sub:"#64748B",border:"rgba(0,0,0,0.12)",primary:"#111827",pink:"#FF6B8A",red:"#FF7A70"};function ne(){return e.createElement("svg",{viewBox:"0 0 24 24",width:"22",height:"22","aria-hidden":!0},e.createElement("circle",{cx:"12",cy:"8",r:"4",fill:"#cbd5e1"}),e.createElement("path",{d:"M4 20c0-4 4-6 8-6s8 2 8 6",fill:"#cbd5e1"}))}function le({value:r,onChange:l}){const t=r==="general",a=c.useRef(null),s=c.useRef(null),[u,i]=c.useState({w:0,x:0}),[f,o]=c.useState(null),m=()=>{const w=a.current,b=s.current;if(!w||!b)return;const v=(t?w.offsetWidth:b.offsetWidth)||0,k=t?0:(w.offsetWidth||0)+8;i({w:v,x:k})};c.useLayoutEffect(()=>{m();const n=new ResizeObserver(m);return a.current&&n.observe(a.current),s.current&&n.observe(s.current),()=>n.disconnect()},[t]);const p=()=>{l("general"),o("general"),setTimeout(()=>o(null),360)},y=()=>{l("academic"),o("academic"),setTimeout(()=>o(null),360)};return e.createElement(e.Fragment,null,e.createElement("style",null,`
        @keyframes nudge {0%{transform:translateY(0) rotate(0)}
          28%{transform:translateY(-2px) rotate(-4deg) scale(1.02)}
          56%{transform:translateY(1px) rotate(3deg)}
          84%{transform:translateY(-1px) rotate(-2deg) scale(1.01)}
          100%{transform:translateY(0) rotate(0)}}
        .emoji-wiggle{animation:nudge 340ms ease-in-out}
      `),e.createElement("div",{className:"w-full flex justify-center"},e.createElement("div",{className:"relative inline-flex items-center gap-2 p-1 rounded-full"},e.createElement("span",{"aria-hidden":!0,className:"absolute top-1 bottom-1 rounded-full transition-transform duration-300 ease-out pointer-events-none",style:{width:u.w||148,transform:`translateX(${u.x||0}px)`,background:"transparent",borderStyle:"solid",borderWidth:2,borderImageSlice:1,borderImageSource:`linear-gradient(90deg, ${x.pink}, ${x.red})`}}),e.createElement("button",{ref:a,type:"button",onClick:p,className:`relative z-10 h-11 px-5 rounded-full text-[15px] transition-colors ${t?"text-slate-900":"text-slate-600 hover:text-slate-800"}`,style:{background:"transparent"},"aria-pressed":t},e.createElement("span",{className:`inline-block mr-1 ${f==="general"?"emoji-wiggle":""}`,"aria-hidden":!0},"ðŸ’¬"),e.createElement("span",{className:"transition-[font-weight] duration-200",style:{fontWeight:t?700:600}},"Freeboard")),e.createElement("button",{ref:s,type:"button",onClick:y,className:`relative z-10 h-11 px-5 rounded-full text-[15px] transition-colors ${t?"text-slate-600 hover:text-slate-800":"text-slate-900"}`,style:{background:"transparent"},"aria-pressed":!t},e.createElement("span",{className:`inline-block mr-1 ${f==="academic"?"emoji-wiggle":""}`,"aria-hidden":!0},"ðŸŽ“"),e.createElement("span",{className:"transition-[font-weight] duration-200",style:{fontWeight:t?600:700}},"Academic")))))}function oe({children:r}){return e.createElement("div",{className:"mx-auto w-[360px]"},e.createElement("div",{className:"relative rounded-[36px] border-[10px] border-black/90 bg-black/90 shadow-2xl"},e.createElement("div",{className:"absolute left-1/2 -translate-x-1/2 top-0 h-6 w-24 rounded-b-2xl bg-black/70"}),e.createElement("div",{className:"m-2 rounded-[26px] overflow-hidden bg-white"},r)))}function se({title:r,setTitle:l,content:t,setContent:a,images:s,setImages:u}){const i=o=>{const m=Array.from(o.target.files||[]);m.length&&u(p=>[...p,...m].slice(0,6))},f=o=>u(m=>m.filter((p,y)=>y!==o));return e.createElement("div",{className:"p-4"},e.createElement("div",{className:"text-[13px] font-semibold text-slate-700 mb-2"},"Write to Freeboard"),e.createElement("input",{type:"text",value:r,onChange:o=>l(o.target.value),placeholder:'e.g. "Best late-night study spots near Bobst?"',className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:x.border}}),e.createElement("textarea",{value:t,onChange:o=>a(o.target.value),rows:4,placeholder:"Share details or ask a follow-up.",className:"mt-3 w-full resize-y rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:x.border}}),e.createElement("div",{className:"mt-3"},e.createElement("label",{className:"block text-[12px] font-medium text-slate-600 mb-1"},"Photos (up to 6)"),e.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:i}),!!s.length&&e.createElement("div",{className:"mt-2 grid grid-cols-3 gap-2"},s.map((o,m)=>e.createElement("div",{key:m,className:"relative"},e.createElement("img",{src:URL.createObjectURL(o),alt:"",className:"aspect-square w-full object-cover rounded-lg"}),e.createElement("button",{type:"button",className:"absolute right-1 top-1 rounded-full bg-black/70 text-white text-xs px-1.5 py-0.5",onClick:()=>f(m)},"âœ•"))))),e.createElement("p",{className:"mt-2 text-[11px] text-slate-500"},"Posting as anonymous."))}function ie({mode:r,setMode:l,title:t,setTitle:a,content:s,setContent:u,courseCode:i,setCourseCode:f,materialType:o,setMaterialType:m,extraNote:p,setExtraNote:y}){return e.createElement("div",{className:"p-4"},e.createElement("div",{className:"text-[13px] font-semibold text-slate-700 mb-2"},"Write to Academic"),e.createElement("div",{className:"mb-3 inline-flex rounded-full border border-slate-200 p-1 bg-white"},e.createElement("button",{type:"button",onClick:()=>l("question"),className:`h-9 px-4 rounded-full text-sm ${r==="question"?"font-semibold text-slate-900":"text-slate-600"}`,style:r==="question"?{background:"linear-gradient(#fff,#fff) padding-box, linear-gradient(90deg,#FF6B8A,#FF7A70) border-box",border:"2px solid transparent"}:{}},"Question"),e.createElement("button",{type:"button",onClick:()=>l("looking_for"),className:`h-9 px-4 rounded-full text-sm ${r==="looking_for"?"font-semibold text-slate-900":"text-slate-600"}`,style:r==="looking_for"?{background:"linear-gradient(#fff,#fff) padding-box, linear-gradient(90deg,#FF6B8A,#FF7A70) border-box",border:"2px solid transparent"}:{}},"Looking for")),e.createElement("input",{type:"text",value:t,onChange:n=>a(n.target.value),placeholder:r==="question"?'e.g. "Which prof is better for DS-UA 201?"':'e.g. "Looking for DS-UA 201 midterm review"',className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:x.border}}),r==="question"?e.createElement("textarea",{value:s,onChange:n=>u(n.target.value),rows:5,placeholder:`Share details or ask a follow-up.
â€¢ Interview prep notes?
â€¢ Advice for course planning?`,className:"mt-3 w-full resize-y rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:x.border}}):e.createElement(e.Fragment,null,e.createElement("div",{className:"mt-3 grid grid-cols-1 gap-3"},e.createElement("div",null,e.createElement("label",{className:"block text-[12px] font-medium text-slate-600 mb-1"},"Course"),e.createElement("input",{type:"text",inputMode:"text",value:i,onChange:n=>f(n.target.value),placeholder:"e.g. DS-UA 201",className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:x.border}})),e.createElement("div",null,e.createElement("label",{className:"block text-[12px] font-medium text-slate-600 mb-1"},"Material type"),e.createElement("input",{type:"text",value:o,onChange:n=>m(n.target.value),placeholder:"e.g. syllabus, midterm review, past exams",className:"w-full rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:x.border}}))),e.createElement("textarea",{value:p,onChange:n=>y(n.target.value),rows:4,placeholder:"Any extra details (links allowed)",className:"mt-3 w-full resize-y rounded-xl border bg-white px-3.5 py-2.5 text-[15px] outline-none focus:ring-2",style:{borderColor:x.border}}),e.createElement("p",{className:"mt-2 text-[11px] text-slate-500"},"This post will be highlighted as ",e.createElement("strong",null,"Looking for")," in the feed.")))}function ce({rows:r=8}){return e.createElement("ul",{className:"mx-auto max-w-[700px] px-2 py-2 divide-y-2 divide-slate-300/90"},Array.from({length:r}).map((l,t)=>e.createElement("li",{key:t,className:"py-5"},e.createElement("div",{className:"flex items-start gap-3"},e.createElement("div",{className:"h-9 w-9 rounded-full bg-slate-200 animate-pulse"}),e.createElement("div",{className:"flex-1 space-y-2"},e.createElement("div",{className:"h-4 w-3/4 rounded bg-slate-200 animate-pulse"}),e.createElement("div",{className:"h-3 w-1/2 rounded bg-slate-200 animate-pulse"})),e.createElement("div",{className:"h-3 w-12 rounded bg-slate-200 animate-pulse"})))))}function me({post:r,onOpenDetail:l}){return e.createElement("article",{role:"button",tabIndex:0,onClick:l,onKeyDown:t=>(t.key==="Enter"||t.key===" ")&&l(),className:"mx-auto max-w-[700px] px-2 focus:outline-none"},e.createElement("div",{className:"group -mx-2 px-2 py-5 hover:bg-slate-50 transition"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:"h-9 w-9 rounded-full bg-slate-100 flex items-center justify-center"},e.createElement(ne,null))),e.createElement("time",{className:"text-[12px] text-slate-500"},r.ago)),e.createElement("div",{className:"mt-2 flex items-start gap-2 flex-wrap"},r.lookingFor&&e.createElement("span",{className:"inline-flex items-center text-white text-[11px] font-semibold px-2 py-0.5 rounded-full bg-gradient-to-r from-[#FF6B8A] to-[#FF7A70]"},"Looking for",r.courseCode?` Â· ${r.courseCode}`:""),r.title?e.createElement("h3",{className:"text-[16px] font-semibold text-slate-900 leading-snug break-words"},r.title):null),r.firstUrl&&e.createElement("span",{className:"mt-1 block text-[14px] text-blue-600 underline-offset-2 group-hover:underline break-all"},r.firstUrl),r.preview&&e.createElement("p",{className:"mt-1 text-[14px] text-slate-800 whitespace-pre-line break-words"},r.preview),e.createElement("div",{className:"mt-3 flex items-center gap-6 text-[13px] text-slate-600"},e.createElement("span",{className:"inline-flex items-center gap-1"},e.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0},e.createElement("path",{d:"M12 21s-7-4.35-7-10a4 4 0 0 1 7-2 4 4 0 0 1 7 2c0 5.65-7 10-7 10z",stroke:"currentColor",strokeWidth:"2"})),r.likes),e.createElement("span",{className:"inline-flex items-center gap-1"},e.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0},e.createElement("path",{d:"M21 15a4 4 0 0 1-4 4H9l-6 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4v8z",stroke:"currentColor",strokeWidth:"2"})),r.comments))))}function he(){const r=H(),{school:l}=Q(),{user:t}=V(),a=X(),s=!!t,u=l||"nyu",[i,f]=c.useState("general"),[o,m]=c.useState({loading:!0,items:[]}),[p,y]=c.useState({loading:!0,items:[]}),[n,w]=c.useState(""),[b,v]=c.useState(""),[k,F]=c.useState([]),[S,P]=c.useState("question"),[C,_]=c.useState(""),[A,T]=c.useState(""),[L,$]=c.useState(""),[R,j]=c.useState(!1),[B,N]=c.useState({type:"",text:""});c.useEffect(()=>{let d=!0;async function g(){m(E=>({...E,loading:!0})),y(E=>({...E,loading:!0}));try{const[E,h]=await Promise.all([s?Z({school:u,limit:30,sort:"new"}):ee({school:u,limit:30,sort:"new"}),s?re({school:u,limit:30,sort:"new"}):ae({school:u,limit:30,sort:"new"})]);if(!d)return;m({loading:!1,items:G(E)}),y({loading:!1,items:G(h)})}catch{if(!d)return;m({loading:!1,items:[]}),y({loading:!1,items:[]})}}return g(),()=>{d=!1}},[s,u]);const M=i==="general"?o:p,q=()=>r(a("/freeboard")),W=()=>r(a("/career")),I=d=>{const g=d.slug||d._id||d.id;if(!g)return i==="general"?q():W();const E=a(i==="general"?`/freeboard/${g}`:`/career/${g}`);r(E)},U=s&&n.trim()&&(b.trim()||k.length),z=s&&n.trim()&&(S==="question"?b.trim():C.trim()&&A.trim()),Y=async d=>{const g=[];for(const E of d)try{const h=await J(E);(h!=null&&h.secure_url||h!=null&&h.url)&&g.push(h.secure_url||h.url)}catch{}return g},O=async d=>{if(d.preventDefault(),N({type:"",text:""}),!s){N({type:"error",text:"Login required to post."});return}j(!0);try{if(i==="general"){if(!U)throw new Error("Missing fields");let g=[];k.length&&(g=await Y(k)),await te({school:u,title:n.trim(),content:b.trim(),images:g}),N({type:"success",text:"Posted to Freeboard! Redirectingâ€¦"}),setTimeout(q,400)}else{if(!z)throw new Error("Missing fields");const g={school:u,title:n.trim()};S==="question"?await D({...g,content:b.trim(),postType:"question"}):await D({...g,content:(b||L).trim(),postType:"looking_for",kind:"looking_for",category:"looking_for",lookingFor:!0,isLookingFor:!0,courseCode:C.trim(),materialType:A.trim(),meta:{courseCode:C.trim(),materialType:A.trim()}}),N({type:"success",text:"Posted to Academic! Redirectingâ€¦"}),setTimeout(W,400)}w(""),v(""),F([]),_(""),T(""),$(""),P("question")}catch{N({type:"error",text:"Failed to post. Please check required fields."})}finally{j(!1)}},K=c.useMemo(()=>i==="general"?{footer:e.createElement(e.Fragment,null,"Posting to ",e.createElement("strong",null,"Freeboard")," as anonymous.")}:{footer:e.createElement(e.Fragment,null,"Posting to ",e.createElement("strong",null,"Academic Board")," as anonymous.")},[i]);return e.createElement("div",{className:"min-h-screen",style:{background:x.pageBg}},e.createElement("main",{className:"mx-auto max-w-6xl px-4 py-6 grid grid-cols-1 md:grid-cols-[minmax(620px,700px)_380px] gap-10"},e.createElement("section",{className:"md:col-start-1"},e.createElement(le,{value:i,onChange:f}),M.loading?e.createElement(ce,{rows:10}):M.items.length?e.createElement("ul",{className:"mt-3 mx-auto max-w-[700px] px-2 divide-y-2 divide-slate-300/90"},M.items.map(d=>e.createElement("li",{key:d._id},e.createElement(me,{post:d,onOpenDetail:()=>I(d)})))):e.createElement("div",{className:"mx-auto max-w-[700px] text-center py-16"},e.createElement("p",{className:"text-[15px] text-slate-600"},"No posts yet."),e.createElement("button",{type:"button",onClick:i==="general"?q:W,className:"mt-4 px-4 py-2 rounded-xl bg-black text-white text-[14px] font-semibold"},"Open ",i==="general"?"Freeboard":"Academic Board"))),e.createElement("aside",{className:"md:col-start-2 md:sticky md:top-[24px] self-start"},e.createElement(oe,null,e.createElement("form",{onSubmit:O},i==="general"?e.createElement(se,{title:n,setTitle:w,content:b,setContent:v,images:k,setImages:F}):e.createElement(ie,{mode:S,setMode:P,title:n,setTitle:w,content:b,setContent:v,courseCode:C,setCourseCode:_,materialType:A,setMaterialType:T,extraNote:L,setExtraNote:$}),e.createElement("div",{className:"px-4 pb-4 pt-2 flex items-center justify-between"},e.createElement("span",{className:"text-xs text-slate-500"},K.footer),e.createElement("div",{className:"flex gap-2"},e.createElement("button",{type:"button",onClick:()=>{w(""),v(""),F([]),_(""),T(""),$(""),P("question"),N({type:"",text:""})},className:"rounded-xl border px-3.5 py-2 text-sm font-semibold hover:bg-black/5",style:{borderColor:x.border}},"Clear"),e.createElement("button",{type:"submit",disabled:R||(i==="general"?!U:!z),className:"rounded-xl px-4 py-2 text-white text-sm font-semibold disabled:opacity-50",style:{background:x.primary}},R?"Posting...":"Post"))),B.text&&e.createElement("div",{className:`mx-4 mb-4 rounded-xl px-3 py-2 text-sm ${B.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`},B.text))))))}function G(r){return(Array.isArray(r==null?void 0:r.items)&&r.items||Array.isArray(r==null?void 0:r.data)&&r.data||Array.isArray(r)&&r||[]).slice(0,50).map(t=>{const a=(t.title||t.subject||"").toString().trim(),s=(t.content||t.text||t.body||"").toString(),u=ue([t.link,t.url,t.sourceUrl,s]),i=s.replace(/https?:\/\/[^\s)]+/gi,"").trim(),f=de(a,i).slice(0,240),o=typeof t.commentsCount=="number"&&t.commentsCount||(Array.isArray(t.comments)?t.comments.length:0)||(typeof t.replies=="number"?t.replies:0),m=typeof t.likesCount=="number"&&t.likesCount||(Array.isArray(t.likes)?t.likes.length:0)||(typeof t.upvotes=="number"?t.upvotes:0),p=t.lookingFor||t.isLookingFor||t.kind==="looking_for"||t.category==="looking_for"||t.postType==="looking_for"||t.type==="looking_for";return{_id:t._id||t.id||Math.random().toString(36).slice(2),slug:t.slug,title:a,preview:f,firstUrl:u,comments:o,likes:m,ago:t.createdAt?ge(t.createdAt):"",lookingFor:!!p,courseCode:t.courseCode||t.course||t.course_code||""}})}function ue(r){const t=r.filter(Boolean).join(" ").match(/https?:\/\/[^\s)]+/i);return t?t[0]:null}function de(r,l){if(!r)return l;const t=r.trim(),a=l.trim();return a?a.toLowerCase().startsWith(t.toLowerCase())?a.slice(t.length).trim():a:""}function ge(r){try{const l=new Date(r),t=Math.floor((Date.now()-l.getTime())/1e3);return t<60?`${t}s ago`:t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}catch{return""}}export{he as default};
