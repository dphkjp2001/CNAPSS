<<<<<<<< HEAD:frontend/dist/assets/PersonalSchedule-34469b0a.js
import{r as m,R as t,b as P,c as T,d as Y}from"./index-5c0e6d0f.js";import{g as I,S as D,s as H}from"./schedule-6851c9a7.js";import"./http-3230a7f7.js";function O({data:s,onSelect:o}){const[l,i]=m.useState(""),n=r=>r.toLowerCase().replace(/[\s\-]/g,""),u=m.useMemo(()=>!l||!Array.isArray(s)?[]:s.flatMap(r=>Array.isArray(r.sections)?r.sections.map(p=>({course_code:r.course_code,course_title:r.course_title,section_number:p.section_number,class_number:p.class_number,meets:p.meets})):[]).filter(r=>n(r.course_code).includes(n(l))||n(r.course_title).includes(n(l))).slice(0,100),[l,s]);return t.createElement("div",{className:"mb-4"},t.createElement("input",{type:"text",className:"w-full p-2 border rounded text-sm",placeholder:"Search courses by code or title...",value:l,onChange:r=>i(r.target.value),autoComplete:"off"}),t.createElement("div",{className:"space-y-2 max-h-72 overflow-y-auto mt-2"},u.length>0?u.map(r=>t.createElement("div",{key:r.class_number,onClick:()=>o(r),className:"border p-2 rounded bg-white shadow-sm cursor-pointer hover:bg-blue-50 transition"},t.createElement("div",{className:"text-sm font-medium"},r.course_code," - ",r.course_title),t.createElement("div",{className:"text-xs ml-2 text-gray-700"},"Section ",r.section_number,": ",r.meets))):l&&t.createElement("div",{className:"text-sm text-gray-500 p-4"},"No matching courses found.")))}function W(s,o,l){if(!s)return[];const i=/([MTWRF]+)\s(\d{1,2})(?::(\d{2}))?(a|p)?-(\d{1,2})(?::(\d{2}))?(a|p)/i,n=s.match(i);if(!n)return[];const u=n[1],r=parseInt(n[2]),p=parseInt(n[3]||"0"),S=n[4],f=parseInt(n[5]),b=parseInt(n[6]||"0"),x=n[7].toLowerCase(),E=(S||x).toLowerCase(),N=r%12+(E==="p"?12:0),w=f%12+(x==="p"?12:0),_=`${N.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`,h=`${w.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`,M={M:"MON",T:"TUE",W:"WED",R:"THU",F:"FRI"};return u.split("").map(g=>({day:M[g],start:_,end:h,label:o,class_number:l}))}const $=s=>`${s.day}-${s.start}-${s.end}`,j=s=>s>=8?"fall":s>=5?"summer":"spring";function B(){const s=new Date,o=s.getFullYear(),l=j(s.getMonth()+1);return`${o}-${l}`}function q(){const o=new Date().getFullYear(),l=[`${o-1}-fall`,`${o}-spring`,`${o}-summer`,`${o}-fall`,`${o+1}-spring`];return Array.from(new Set(l))}function V(){const{school:s}=P(),{token:o}=T(),l=Y(),i=(s||"").toLowerCase()==="nyu",n=m.useMemo(q,[]),[u,r]=m.useState(B()),[p,S]=m.useState([]),[f,b]=m.useState([]),[x,E]=m.useState(!1),[N,w]=m.useState(!1),[_,h]=m.useState(""),[M,g]=m.useState("");m.useEffect(()=>{let e=!0;if(!(!s||!o||!u))return(async()=>{try{g("");const a=await I({school:s,token:o,semester:u}),C=(Array.isArray(a==null?void 0:a.slots)?a.slots:[]).map(d=>({day:d.day,start:d.start,end:d.end,label:d.label||"Saved",class_number:d.classNumber||`saved-${$(d)}`}));e&&b(C)}catch(a){console.warn("Load schedule failed:",a),e&&b([])}})(),()=>{e=!1}},[s,o,u]),m.useEffect(()=>{let e=!0;return i?(E(!0),fetch("/NYU_course_DATA.json").then(a=>a.json()).then(a=>{e&&S(Array.isArray(a)?a:[])}).catch(a=>console.error("Failed to load course data:",a)).finally(()=>{e&&E(!1)}),()=>{e=!1}):(S([]),()=>{})},[i]);const k=e=>{if(f.some(c=>c.label===e.course_code&&c.class_number===e.class_number))b(c=>c.filter(C=>C.class_number!==e.class_number));else{const c=W(e.meets,e.course_code,e.class_number);if(c.some(d=>f.some(v=>v.day===d.day&&!(d.end<=v.start||d.start>=v.end)))){if(!window.confirm("This course conflicts with an existing one. Replace conflicting blocks with this course?"))return;const v=c.flatMap(y=>f.filter(A=>A.day===y.day&&!(y.end<=A.start||y.start>=A.end))).map(y=>y.class_number),F=f.filter(y=>!v.includes(y.class_number));b([...F,...c]);return}b(d=>[...d,...c])}},R=e=>{b(a=>a.filter(c=>c.class_number!==e))},L=()=>{const e=new Map;for(const a of f){const c=$(a);e.set(c,{day:a.day,start:a.start,end:a.end,label:a.label||void 0,classNumber:a.class_number||void 0})}return Array.from(e.values())},U=async()=>{if(!(!o||!s||!u))try{w(!0),h(""),g("");const e=L();await H({school:s,token:o,semester:u,slots:e}),h("Saved your schedule for this semester.")}catch(e){console.error("Save failed:",e),g("Failed to save schedule. Please try again.")}finally{w(!1),setTimeout(()=>h(""),3e3)}};return t.createElement("div",{className:"p-6"},t.createElement("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},t.createElement("h1",{className:"text-xl font-semibold"},"Personal Schedule Builder"),t.createElement("div",{className:"flex items-center gap-3"},t.createElement("label",{className:"text-sm text-gray-600"},"Semester"),t.createElement("select",{value:u,onChange:e=>r(e.target.value),className:"rounded-lg border px-3 py-1.5 text-sm"},n.map(e=>t.createElement("option",{key:e,value:e},e))),t.createElement("button",{onClick:U,disabled:N||!o,className:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white disabled:opacity-60"},N?"Saving…":"Save"))),!i&&t.createElement("div",{className:"mb-4 rounded-xl border border-amber-200 bg-amber-50 p-5 text-sm text-amber-900"},t.createElement("div",{className:"mb-1 font-semibold"},"Course search is NYU-only (MVP) for now."),t.createElement("p",null,"We don’t have course data for ",t.createElement("b",null,(s||"").toUpperCase())," yet. You can still save a schedule by adding blocks manually once we add that UI; for now, only NYU course search can auto-add blocks."),t.createElement("a",{href:l("/dashboard"),className:"mt-2 inline-block text-blue-600 underline"},"← Back to Dashboard")),_&&t.createElement("div",{className:"mb-3 rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700"},_),M&&t.createElement("div",{className:"mb-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},M),t.createElement("div",{className:"mt-4 flex gap-6"},t.createElement("div",{className:"w-3/12"},i?x?t.createElement("div",{className:"text-sm text-gray-500"},"Loading course list…"):t.createElement(O,{data:p,onSelect:k}):t.createElement("div",{className:"rounded-lg border border-gray-200 bg-white p-3 text-sm text-gray-500"},"Course search is unavailable for this school.")),t.createElement("div",{className:"w-9/12"},t.createElement(D,{schedules:f,onRemove:R}))))}export{V as default};
========
import{r as m,R as t,b as P,c as T,d as Y}from"./index-4e2f07d4.js";import{g as I,S as D,s as H}from"./schedule-81e6ffb8.js";import"./http-3230a7f7.js";function O({data:s,onSelect:o}){const[l,i]=m.useState(""),n=r=>r.toLowerCase().replace(/[\s\-]/g,""),u=m.useMemo(()=>!l||!Array.isArray(s)?[]:s.flatMap(r=>Array.isArray(r.sections)?r.sections.map(p=>({course_code:r.course_code,course_title:r.course_title,section_number:p.section_number,class_number:p.class_number,meets:p.meets})):[]).filter(r=>n(r.course_code).includes(n(l))||n(r.course_title).includes(n(l))).slice(0,100),[l,s]);return t.createElement("div",{className:"mb-4"},t.createElement("input",{type:"text",className:"w-full p-2 border rounded text-sm",placeholder:"Search courses by code or title...",value:l,onChange:r=>i(r.target.value),autoComplete:"off"}),t.createElement("div",{className:"space-y-2 max-h-72 overflow-y-auto mt-2"},u.length>0?u.map(r=>t.createElement("div",{key:r.class_number,onClick:()=>o(r),className:"border p-2 rounded bg-white shadow-sm cursor-pointer hover:bg-blue-50 transition"},t.createElement("div",{className:"text-sm font-medium"},r.course_code," - ",r.course_title),t.createElement("div",{className:"text-xs ml-2 text-gray-700"},"Section ",r.section_number,": ",r.meets))):l&&t.createElement("div",{className:"text-sm text-gray-500 p-4"},"No matching courses found.")))}function W(s,o,l){if(!s)return[];const i=/([MTWRF]+)\s(\d{1,2})(?::(\d{2}))?(a|p)?-(\d{1,2})(?::(\d{2}))?(a|p)/i,n=s.match(i);if(!n)return[];const u=n[1],r=parseInt(n[2]),p=parseInt(n[3]||"0"),S=n[4],f=parseInt(n[5]),b=parseInt(n[6]||"0"),x=n[7].toLowerCase(),E=(S||x).toLowerCase(),N=r%12+(E==="p"?12:0),w=f%12+(x==="p"?12:0),_=`${N.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`,h=`${w.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`,M={M:"MON",T:"TUE",W:"WED",R:"THU",F:"FRI"};return u.split("").map(g=>({day:M[g],start:_,end:h,label:o,class_number:l}))}const $=s=>`${s.day}-${s.start}-${s.end}`,j=s=>s>=8?"fall":s>=5?"summer":"spring";function B(){const s=new Date,o=s.getFullYear(),l=j(s.getMonth()+1);return`${o}-${l}`}function q(){const o=new Date().getFullYear(),l=[`${o-1}-fall`,`${o}-spring`,`${o}-summer`,`${o}-fall`,`${o+1}-spring`];return Array.from(new Set(l))}function V(){const{school:s}=P(),{token:o}=T(),l=Y(),i=(s||"").toLowerCase()==="nyu",n=m.useMemo(q,[]),[u,r]=m.useState(B()),[p,S]=m.useState([]),[f,b]=m.useState([]),[x,E]=m.useState(!1),[N,w]=m.useState(!1),[_,h]=m.useState(""),[M,g]=m.useState("");m.useEffect(()=>{let e=!0;if(!(!s||!o||!u))return(async()=>{try{g("");const a=await I({school:s,token:o,semester:u}),C=(Array.isArray(a==null?void 0:a.slots)?a.slots:[]).map(d=>({day:d.day,start:d.start,end:d.end,label:d.label||"Saved",class_number:d.classNumber||`saved-${$(d)}`}));e&&b(C)}catch(a){console.warn("Load schedule failed:",a),e&&b([])}})(),()=>{e=!1}},[s,o,u]),m.useEffect(()=>{let e=!0;return i?(E(!0),fetch("/NYU_course_DATA.json").then(a=>a.json()).then(a=>{e&&S(Array.isArray(a)?a:[])}).catch(a=>console.error("Failed to load course data:",a)).finally(()=>{e&&E(!1)}),()=>{e=!1}):(S([]),()=>{})},[i]);const k=e=>{if(f.some(c=>c.label===e.course_code&&c.class_number===e.class_number))b(c=>c.filter(C=>C.class_number!==e.class_number));else{const c=W(e.meets,e.course_code,e.class_number);if(c.some(d=>f.some(v=>v.day===d.day&&!(d.end<=v.start||d.start>=v.end)))){if(!window.confirm("This course conflicts with an existing one. Replace conflicting blocks with this course?"))return;const v=c.flatMap(y=>f.filter(A=>A.day===y.day&&!(y.end<=A.start||y.start>=A.end))).map(y=>y.class_number),F=f.filter(y=>!v.includes(y.class_number));b([...F,...c]);return}b(d=>[...d,...c])}},R=e=>{b(a=>a.filter(c=>c.class_number!==e))},L=()=>{const e=new Map;for(const a of f){const c=$(a);e.set(c,{day:a.day,start:a.start,end:a.end,label:a.label||void 0,classNumber:a.class_number||void 0})}return Array.from(e.values())},U=async()=>{if(!(!o||!s||!u))try{w(!0),h(""),g("");const e=L();await H({school:s,token:o,semester:u,slots:e}),h("Saved your schedule for this semester.")}catch(e){console.error("Save failed:",e),g("Failed to save schedule. Please try again.")}finally{w(!1),setTimeout(()=>h(""),3e3)}};return t.createElement("div",{className:"p-6"},t.createElement("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},t.createElement("h1",{className:"text-xl font-semibold"},"Personal Schedule Builder"),t.createElement("div",{className:"flex items-center gap-3"},t.createElement("label",{className:"text-sm text-gray-600"},"Semester"),t.createElement("select",{value:u,onChange:e=>r(e.target.value),className:"rounded-lg border px-3 py-1.5 text-sm"},n.map(e=>t.createElement("option",{key:e,value:e},e))),t.createElement("button",{onClick:U,disabled:N||!o,className:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white disabled:opacity-60"},N?"Saving…":"Save"))),!i&&t.createElement("div",{className:"mb-4 rounded-xl border border-amber-200 bg-amber-50 p-5 text-sm text-amber-900"},t.createElement("div",{className:"mb-1 font-semibold"},"Course search is NYU-only (MVP) for now."),t.createElement("p",null,"We don’t have course data for ",t.createElement("b",null,(s||"").toUpperCase())," yet. You can still save a schedule by adding blocks manually once we add that UI; for now, only NYU course search can auto-add blocks."),t.createElement("a",{href:l("/dashboard"),className:"mt-2 inline-block text-blue-600 underline"},"← Back to Dashboard")),_&&t.createElement("div",{className:"mb-3 rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700"},_),M&&t.createElement("div",{className:"mb-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},M),t.createElement("div",{className:"mt-4 flex gap-6"},t.createElement("div",{className:"w-3/12"},i?x?t.createElement("div",{className:"text-sm text-gray-500"},"Loading course list…"):t.createElement(O,{data:p,onSelect:k}):t.createElement("div",{className:"rounded-lg border border-gray-200 bg-white p-3 text-sm text-gray-500"},"Course search is unavailable for this school.")),t.createElement("div",{className:"w-9/12"},t.createElement(D,{schedules:f,onRemove:R}))))}export{V as default};
>>>>>>>> 77cdf18ec67ca18e3726058f231b83ff2bf411b6:frontend/dist/assets/PersonalSchedule-99e1aaa1.js
