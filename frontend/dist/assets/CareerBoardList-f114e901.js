import{b as I,a as j,c as A,u as B,f as U,d as _,r as l,R as e,e as d,P as F}from"./index-4b427570.js";import{r as G}from"./relativeTime-37f343f6.js";import"./en-fb0f2984.js";import{l as M,g as O}from"./careerPosts-bd65ad74.js";d.extend(G);d.locale("en");const u=20;function g(){return e.createElement("li",{className:"animate-pulse"},e.createElement("div",{className:"h-5 w-2/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 rounded bg-gray-100"}),e.createElement("div",{className:"mt-3 h-px w-full bg-gray-100"}))}function Q(){return e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-10 text-center"},e.createElement("p",{className:"text-sm text-gray-500"},"No posts yet."))}function D(){const{token:p}=I(),{school:n,schoolTheme:r}=j(),f=A(),x=B();U();const[s,i]=_(),o=Math.max(1,parseInt(s.get("page")||"1",10)),c=s.get("q")||"",m=s.get("sort")||"new",N=a=>{const t=new URLSearchParams(s.toString());t.set("page",String(a)),i(t,{replace:!0})},v=a=>{const t=new URLSearchParams(s.toString());a?t.set("q",a):t.delete("q"),t.set("page","1"),i(t,{replace:!0})},S=a=>{const t=new URLSearchParams(s.toString());t.set("sort",a),t.set("page","1"),i(t,{replace:!0})},[y,P]=l.useState([]),[C,k]=l.useState(0),[L,E]=l.useState(!0),[b,w]=l.useState("");l.useEffect(()=>{let a=!0;if(n)return(async()=>{E(!0),w("");try{let t;p?t=await M({school:n,page:o,limit:u,q:c,sort:m}):t=await O({school:n,page:o,limit:u,q:c,sort:m});const h=(t==null?void 0:t.items)||t||[];if(!a)return;P(h),k(Number((t==null?void 0:t.total)??h.length??0))}catch(t){if(!a)return;w((t==null?void 0:t.message)||"Failed to load posts.")}finally{if(!a)return;E(!1)}})(),()=>{a=!1}},[p,n,o,c,m]);const R={color:(r==null?void 0:r.text)||"#111827"},q={backgroundColor:(r==null?void 0:r.primary)||"#111827"};return e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(r==null?void 0:r.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-3xl"},e.createElement("div",{className:"mb-5 flex flex-col justify-between gap-3 sm:flex-row sm:items-center"},e.createElement("h2",{className:"text-2xl font-bold tracking-tight",style:R},"Career Board"),e.createElement("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center"},e.createElement("div",{className:"relative sm:w-80"},e.createElement("input",{type:"search",value:c,onChange:a=>v(a.target.value),placeholder:"Search posts",className:"w-full rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 placeholder:text-gray-400 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"search posts"})),e.createElement("select",{value:m,onChange:a=>S(a.target.value),className:"rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10","aria-label":"sort posts"},e.createElement("option",{value:"new"},"Newest"),e.createElement("option",{value:"old"},"Oldest")),e.createElement("button",{onClick:()=>x(f("/career/write")),className:"inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-900/10",style:q},"+ Write"))),e.createElement("ul",{className:"divide-y divide-gray-100 rounded-2xl border border-gray-200 bg-white p-4 sm:p-5"},L?e.createElement(e.Fragment,null,e.createElement(g,null),e.createElement(g,null),e.createElement(g,null)):b?e.createElement("li",{className:"p-4 text-sm text-red-700"},b):y.length===0?e.createElement("li",{className:"p-4"},e.createElement(Q,null)):y.map(a=>e.createElement("li",{key:a._id,className:"py-3"},e.createElement("button",{onClick:()=>x(f(`/career/${a._id}`)),className:"w-full text-left"},e.createElement("div",{className:"text-base font-medium text-gray-900"},a.title),e.createElement("div",{className:"mt-1 text-xs text-gray-500"},"Posted by anonymous â€¢ ",d(a.createdAt).fromNow()," Â· ğŸ’¬ ",a.commentsCount??"-"," Â· ğŸ‘ ",a.likesCount??"-"))))),e.createElement(F,{page:o,total:C,limit:u,onPageChange:N,className:"mb-8"})))}export{D as default};
