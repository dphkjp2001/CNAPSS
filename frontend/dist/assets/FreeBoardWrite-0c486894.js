import{u as w,a as E,c as N,b as v,e as k,r as o,R as e,A as C}from"./index-ff0a1258.js";import{c as P}from"./posts-fe9489bd.js";function D(){const{user:t}=w(),{school:m,schoolTheme:r}=E(),l=N(),c=v(),{ensureAuth:d}=k(),[n,f]=o.useState(""),[s,h]=o.useState(""),[u,y]=o.useState(""),i=o.useMemo(()=>!!(n.trim()&&s.trim()),[n,s]),g=o.useCallback(async()=>{try{y(""),await P({title:n.trim(),content:s.trim(),email:t==null?void 0:t.email,nickname:t==null?void 0:t.nickname,school:m}),alert("Post submitted!"),c(l("/freeboard"))}catch(a){console.error("Post creation error:",a);const p=(a==null?void 0:a.message)||"Unexpected error occurred.";y(p),alert(p)}},[n,s,t==null?void 0:t.email,t==null?void 0:t.nickname,m,c,l]),x=o.useCallback(async()=>{if(i){if(!t){d();return}await g()}},[i,t,d,g]),b=a=>{(a.metaKey||a.ctrlKey)&&a.key==="Enter"&&(a.preventDefault(),x())};return e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(r==null?void 0:r.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-3xl"},e.createElement("div",{className:"overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm"},e.createElement("div",{className:"border-b border-gray-100 p-5 sm:p-6"},e.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"New Post"),e.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Share announcements, questions, or tips with your campus community.")),e.createElement("form",{onSubmit:a=>a.preventDefault(),className:"space-y-5 p-5 sm:p-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-900"},"Title"),e.createElement("input",{type:"text",value:n,onChange:a=>f(a.target.value),onKeyDown:b,placeholder:"Enter a title",className:"mt-2 w-full rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-400 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10",required:!0,"aria-label":"post title"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-900"},"Content"),e.createElement("textarea",{value:s,onChange:a=>h(a.target.value),onKeyDown:b,placeholder:"Write your content here...",rows:10,className:"mt-2 w-full resize-y rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-400 shadow-sm focus:border-gray-900 focus:ring-2 focus:ring-gray-900/10",required:!0,"aria-label":"post content"}),e.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Tip: Keep it concise and respectful. No personal information.")),u&&e.createElement("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700"},u),e.createElement("div",{className:"flex items-center justify-end gap-2 border-t border-gray-100 pt-4"},e.createElement("button",{type:"button",onClick:()=>c(l("/freeboard")),className:"rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900/10"},"Cancel"),e.createElement(C,{onClick:x,loadingText:"Posting…",className:"inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold text-white shadow disabled:opacity-60",style:{backgroundColor:(r==null?void 0:r.primary)||"#6b46c1"},disabled:!i},"Post")),!t&&e.createElement("p",{className:"pt-1 text-right text-xs text-gray-500"},"You can fill the form now — you’ll be asked to log in when you post.")))))}export{D as default};
