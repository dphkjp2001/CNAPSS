import{e as _,u as I,b as B,c as D,r as d,R as e}from"./index-1bfae1a9.js";import{h as T,i as j,j as R}from"./academicPosts-3f24bdec.js";import{U as V,V as q,C as h}from"./CommentSection-af9011ac.js";import"./http-e19067b4.js";import"./relativeTime-f6ae5453.js";import"./useLoginGate-b769887f.js";const F={lecture_notes:"Lecture Notes",syllabus:"Syllabus",past_exams:"Past Exams",quiz_prep:"Quiz Prep"};function U(c=""){const a=String(c||"").toLowerCase().replace(/[\s-]+/g,"_");return a.includes("course_material")?"📝":a.includes("study")?"👥":a.includes("coffee")?"☕️":"📌"}function J(){var b;const{school:c,id:a}=_(),y=I(),{school:w}=B(),o=c||w||"nyu",{user:n}=D(),[l,m]=d.useState({loading:!0,error:"",post:null});if(d.useEffect(()=>{let t=!0;return(async()=>{try{const r=await T({school:o,id:a});if(!t)return;m({loading:!1,error:"",post:r})}catch(r){if(!t)return;m({loading:!1,error:(r==null?void 0:r.message)||"Failed to load post.",post:null})}})(),()=>{t=!1}},[o,a]),d.useEffect(()=>{if(!n)return;let t=!0;return(async()=>{try{const r=await j({school:o,id:a});if(!t)return;m(E=>({...E,post:r||E.post}))}catch{}})(),()=>{t=!1}},[n,o,a]),l.loading)return e.createElement("div",{className:"max-w-3xl mx-auto px-4 py-6 text-sm text-slate-600"},"Loading…");if(l.error)return e.createElement("div",{className:"max-w-3xl mx-auto px-4 py-6 text-sm text-red-600"},l.error);if(!l.post)return null;const s=l.post,u=(s.mode||s.postType||s.type||(s.lookingFor?"looking_for":"general")).toString().toLowerCase(),i=u==="general"||u==="question",p=n&&[String(((b=s.author)==null?void 0:b._id)||s.author),String(s.userId),String(s.authorId)].filter(Boolean).some(t=>String(t)===String(n._id||n.id)),{title:N,content:v,createdAt:x,kind:S,professor:f,materials:g=[],upCount:A,downCount:k,myVote:C}=s,L=(Array.isArray(g)?g:[]).map(t=>F[t]).filter(Boolean),P=async()=>{window.confirm("Delete this post?")&&(await R({school:o,id:a}),y(`/${encodeURIComponent(o)}/dashboard?tab=academic`))};return e.createElement("div",{className:"max-w-3xl mx-auto px-4 py-6"},e.createElement("article",{className:"bg-white rounded-2xl shadow border border-slate-200 overflow-hidden"},e.createElement("header",{className:"px-5 py-4 border-b border-slate-200"},e.createElement("div",{className:"flex items-center justify-between text-sm text-slate-500"},e.createElement("div",{className:"inline-flex items-center gap-2"},e.createElement("span",null,i?"💬":U(S)),e.createElement("span",{className:"font-medium"},i?"General question":"Seeking")),e.createElement("div",{className:"flex items-center gap-3"},e.createElement("time",{dateTime:x},new Date(x).toLocaleString()),p&&e.createElement("button",{onClick:P,className:"ml-2 rounded-xl bg-red-500 px-3 py-1.5 text-xs font-semibold text-white hover:bg-red-600"},"Delete"))),e.createElement("h1",{className:"mt-2 text-2xl font-semibold text-slate-900"},N),e.createElement("div",{className:"mt-3 flex items-center justify-between"},e.createElement(V,{username:s.authorNickname||s.nickname||"anonymous",tier:s.authorTier,className:"text-sm"}),e.createElement(q,{targetType:"academic",targetId:a,initialCounts:{up:A||0,down:k||0},initialVote:C??null,disabled:!!p,className:"scale-90"})),!i&&e.createElement("div",{className:"mt-3 flex flex-wrap items-center gap-2"},L.map(t=>e.createElement("span",{key:t,className:"inline-flex items-center rounded-full border border-slate-300 bg-slate-50 px-3 py-1 text-xs text-slate-700"},t)),f&&e.createElement("span",{className:"inline-flex items-center rounded-full border border-slate-300 bg-slate-50 px-3 py-1 text-xs text-slate-700"},"Professor: ",f))),e.createElement("div",{className:"px-5 py-5 whitespace-pre-wrap text-[15px] leading-7 text-slate-800"},v),e.createElement("div",{className:"px-5 py-5 border-t border-slate-200 bg-white"},i?e.createElement(h,{postId:a}):e.createElement(h,{postId:a,disabled:!0}))))}export{J as default};
