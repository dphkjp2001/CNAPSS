import{o as h}from"./index-6d921834.js";async function e(a,o={}){const t=new Headers(o.headers||{});let n=o.body;n&&!(n instanceof FormData)&&typeof n=="object"&&(t.has("Content-Type")||t.set("Content-Type","application/json"),n=JSON.stringify(n));const r=localStorage.getItem("token");r&&!t.has("Authorization")&&t.set("Authorization",`Bearer ${r}`);const i=await fetch(a,{...o,headers:t,body:n});if(i.status===401){const c=window.location.pathname;if(!/^\/(login|register|auth-required)(\/|$)/.test(c)){const u=c+window.location.search;return h(u),new Promise(()=>{})}}return i}async function f(a,o){const t=await e(a,{method:"GET",...o||{}});if(!t.ok)throw await s(t);return t.json()}async function d(a,o,t){const n=await e(a,{method:"POST",body:o,...t||{}});if(!n.ok)throw await s(n);return n.json()}async function p(a,o,t){const n=await e(a,{method:"PUT",body:o,...t||{}});if(!n.ok)throw await s(n);return n.json()}async function y(a,o){const t=await e(a,{method:"DELETE",...o||{}});if(!t.ok)throw await s(t);return t.json()}async function s(a){let o=null;try{o=await a.clone().json()}catch{}const t=new Error((o==null?void 0:o.message)||`HTTP ${a.status}`);return t.status=a.status,t.payload=o,t}export{e as a,p as b,y as d,f as g,d as p};
