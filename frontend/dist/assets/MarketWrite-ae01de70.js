import{u as S,a as k,b as C,r as l,R as e}from"./index-0f5aaadd.js";import{a as R}from"./axios-b5ee139b.js";import{u as L}from"./uploadToCloudinary-a2ae08d3.js";const F=()=>{const u=S(),{user:s}=k(),{school:p}=C(),d="https://api.cnapss.com/api",[r,b]=l.useState(""),[n,f]=l.useState(""),[o,g]=l.useState(""),[h,E]=l.useState([]),[x,v]=l.useState([]),[m,i]=l.useState(!1),y=t=>{const a=Array.from(t.target.files).slice(0,3);E(a.map(c=>URL.createObjectURL(c))),v(a)},N=async t=>{if(t.preventDefault(),!r||!n||!o){alert("모든 필드를 입력해주세요.");return}try{i(!0);const a=[];for(const c of x){const w=await L(c);a.push(w)}await R.post(`${d}/market`,{title:r,description:n,price:parseFloat(o),school:p,seller:s==null?void 0:s.email,images:a}),alert("등록이 완료되었습니다."),u("/market")}catch(a){console.error(a),alert("글 작성에 실패했습니다.")}finally{i(!1)}};return s?e.createElement("div",{className:"max-w-xl mx-auto mt-10 bg-white p-6 rounded-xl shadow-md"},e.createElement("h1",{className:"text-2xl font-bold mb-4 text-purple-700"},"중고 물품 등록"),e.createElement("form",{onSubmit:N,className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block font-semibold"},"제목"),e.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",value:r,onChange:t=>b(t.target.value),required:!0})),e.createElement("div",null,e.createElement("label",{className:"block font-semibold"},"설명"),e.createElement("textarea",{className:"w-full border rounded px-3 py-2 h-28 resize-none",value:n,onChange:t=>f(t.target.value),required:!0})),e.createElement("div",null,e.createElement("label",{className:"block font-semibold"},"가격 ($)"),e.createElement("input",{type:"number",min:"0",className:"w-full border rounded px-3 py-2",value:o,onChange:t=>g(t.target.value),required:!0})),e.createElement("div",null,e.createElement("label",{className:"block font-semibold"},"이미지 (최대 3장)"),e.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:y}),e.createElement("div",{className:"flex gap-2 mt-2"},h.map((t,a)=>e.createElement("img",{key:a,src:t,alt:`미리보기-${a}`,className:"w-24 h-24 object-cover rounded border"})))),e.createElement("button",{type:"submit",disabled:m,className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 disabled:opacity-50"},m?"등록 중...":"등록하기"))):e.createElement("p",{className:"text-center mt-10"},"로딩 중...")};export{F as default};
