import{u as qe,a as Oe,b as He,c as Fe,d as De,r as p,R as r}from"./index-9aa4f1a3.js";import{u as ze}from"./uploadToCloudinary-dc971086.js";import{g as Be,c as Ue}from"./posts-ff58ac93.js";import{g as Ye,c as W}from"./academicPosts-01d2e02d.js";import"./http-a6fe908c.js";var be={exports:{}},i={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X=Symbol.for("react.transitional.element"),Ge=Symbol.for("react.portal"),Ke=Symbol.for("react.fragment"),Qe=Symbol.for("react.strict_mode"),We=Symbol.for("react.profiler"),Ze=Symbol.for("react.consumer"),Ve=Symbol.for("react.context"),Xe=Symbol.for("react.forward_ref"),Je=Symbol.for("react.suspense"),et=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),tt=Symbol.for("react.activity"),pe=Symbol.iterator;function rt(e){return e===null||typeof e!="object"?null:(e=pe&&e[pe]||e["@@iterator"],typeof e=="function"?e:null)}var we={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_e=Object.assign,Ne={};function P(e,t,n){this.props=e,this.context=t,this.refs=Ne,this.updater=n||we}P.prototype.isReactComponent={};P.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};P.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ke(){}ke.prototype=P.prototype;function J(e,t,n){this.props=e,this.context=t,this.refs=Ne,this.updater=n||we}var ee=J.prototype=new ke;ee.constructor=J;_e(ee,P.prototype);ee.isPureReactComponent=!0;var ge=Array.isArray;function V(){}var g={H:null,A:null,T:null,S:null},Ce=Object.prototype.hasOwnProperty;function te(e,t,n){var a=n.ref;return{$$typeof:X,type:e,key:t,ref:a!==void 0?a:null,props:n}}function st(e,t){return te(e.type,t,e.props)}function re(e){return typeof e=="object"&&e!==null&&e.$$typeof===X}function nt(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var xe=/\/+/g;function Z(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nt(""+e.key):t.toString(36)}function at(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(V,V):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function M(e,t,n,a,c){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(o){case"bigint":case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case X:case Ge:f=!0;break;case ve:return f=e._init,M(f(e._payload),t,n,a,c)}}if(f)return c=c(e),f=a===""?"."+Z(e,0):a,ge(c)?(n="",f!=null&&(n=f.replace(xe,"$&/")+"/"),M(c,t,n,"",function(y){return y})):c!=null&&(re(c)&&(c=st(c,n+(c.key==null||e&&e.key===c.key?"":(""+c.key).replace(xe,"$&/")+"/")+f)),t.push(c)),1;f=0;var m=a===""?".":a+":";if(ge(e))for(var x=0;x<e.length;x++)a=e[x],o=m+Z(a,x),f+=M(a,t,n,o,c);else if(x=rt(e),typeof x=="function")for(e=x.call(e),x=0;!(a=e.next()).done;)a=a.value,o=m+Z(a,x++),f+=M(a,t,n,o,c);else if(o==="object"){if(typeof e.then=="function")return M(at(e),t,n,a,c);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return f}function D(e,t,n){if(e==null)return e;var a=[],c=0;return M(e,a,"","",function(o){return t.call(n,o,c++)}),a}function ot(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ye=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},lt={map:D,forEach:function(e,t,n){D(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(t){return t})||[]},only:function(e){if(!re(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};i.Activity=tt;i.Children=lt;i.Component=P;i.Fragment=Ke;i.Profiler=We;i.PureComponent=J;i.StrictMode=Qe;i.Suspense=Je;i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=g;i.__COMPILER_RUNTIME={__proto__:null,c:function(e){return g.H.useMemoCache(e)}};i.cache=function(e){return function(){return e.apply(null,arguments)}};i.cacheSignal=function(){return null};i.cloneElement=function(e,t,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var a=_e({},e.props),c=e.key;if(t!=null)for(o in t.key!==void 0&&(c=""+t.key),t)!Ce.call(t,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&t.ref===void 0||(a[o]=t[o]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var f=Array(o),m=0;m<o;m++)f[m]=arguments[m+2];a.children=f}return te(e.type,c,a)};i.createContext=function(e){return e={$$typeof:Ve,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:Ze,_context:e},e};i.createElement=function(e,t,n){var a,c={},o=null;if(t!=null)for(a in t.key!==void 0&&(o=""+t.key),t)Ce.call(t,a)&&a!=="key"&&a!=="__self"&&a!=="__source"&&(c[a]=t[a]);var f=arguments.length-2;if(f===1)c.children=n;else if(1<f){for(var m=Array(f),x=0;x<f;x++)m[x]=arguments[x+2];c.children=m}if(e&&e.defaultProps)for(a in f=e.defaultProps,f)c[a]===void 0&&(c[a]=f[a]);return te(e,o,c)};i.createRef=function(){return{current:null}};i.forwardRef=function(e){return{$$typeof:Xe,render:e}};i.isValidElement=re;i.lazy=function(e){return{$$typeof:ve,_payload:{_status:-1,_result:e},_init:ot}};i.memo=function(e,t){return{$$typeof:et,type:e,compare:t===void 0?null:t}};i.startTransition=function(e){var t=g.T,n={};g.T=n;try{var a=e(),c=g.S;c!==null&&c(n,a),typeof a=="object"&&a!==null&&typeof a.then=="function"&&a.then(V,ye)}catch(o){ye(o)}finally{t!==null&&n.types!==null&&(t.types=n.types),g.T=t}};i.unstable_useCacheRefresh=function(){return g.H.useCacheRefresh()};i.use=function(e){return g.H.use(e)};i.useActionState=function(e,t,n){return g.H.useActionState(e,t,n)};i.useCallback=function(e,t){return g.H.useCallback(e,t)};i.useContext=function(e){return g.H.useContext(e)};i.useDebugValue=function(){};i.useDeferredValue=function(e,t){return g.H.useDeferredValue(e,t)};i.useEffect=function(e,t){return g.H.useEffect(e,t)};i.useEffectEvent=function(e){return g.H.useEffectEvent(e)};i.useId=function(){return g.H.useId()};i.useImperativeHandle=function(e,t,n){return g.H.useImperativeHandle(e,t,n)};i.useInsertionEffect=function(e,t){return g.H.useInsertionEffect(e,t)};i.useLayoutEffect=function(e,t){return g.H.useLayoutEffect(e,t)};i.useMemo=function(e,t){return g.H.useMemo(e,t)};i.useOptimistic=function(e,t){return g.H.useOptimistic(e,t)};i.useReducer=function(e,t,n){return g.H.useReducer(e,t,n)};i.useRef=function(e){return g.H.useRef(e)};i.useState=function(e){return g.H.useState(e)};i.useSyncExternalStore=function(e,t,n){return g.H.useSyncExternalStore(e,t,n)};i.useTransition=function(){return g.H.useTransition()};i.version="19.2.0";be.exports=i;var q=be.exports;/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),it=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,a)=>a?a.toUpperCase():n.toLowerCase()),Ee=e=>{const t=it(e);return t.charAt(0).toUpperCase()+t.slice(1)},Ae=(...e)=>e.filter((t,n,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===n).join(" ").trim(),ut=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=q.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:c="",children:o,iconNode:f,...m},x)=>q.createElement("svg",{ref:x,...mt,width:t,height:t,stroke:e,strokeWidth:a?Number(n)*24/Number(t):n,className:Ae("lucide",c),...!o&&!ut(m)&&{"aria-hidden":"true"},...m},[...f.map(([y,H])=>q.createElement(y,H)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=(e,t)=>{const n=q.forwardRef(({className:a,...c},o)=>q.createElement(ft,{ref:o,iconNode:t,className:Ae(`lucide-${ct(Ee(e))}`,`lucide-${e}`,a),...c}));return n.displayName=Ee(e),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],pt=O("bookmark",dt);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],xt=O("message-square",gt);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]],Et=O("repeat-2",yt);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],bt=O("send",ht);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]],wt=O("share",vt),_t={pageBg:"#FFFFFF",text:"#0F172A",sub:"#64748B",primary:"#111827",pink:"#FF6B8A",red:"#FF7A70"},Nt=(e="")=>String(e).toLowerCase().trim().replace(/[\s_-]+/g,"_"),Se=(e={})=>{const t=e.postType||e.type||e.mode||(e.lookingFor?"seeking":"question")||"",n=String(t).toLowerCase();return n==="looking_for"||n==="seeking"||n==="lf"?"seeking":"question"},kt=(e={})=>{const t=Nt(e.kind||"");if(t)return t;const n=[e.kind,...Array.isArray(e.tags)?e.tags:[],e.title,e.content].filter(Boolean).join(" ").toLowerCase();return/(course\s*materials?|syllabus|notes?|exam|midterm|final|assignment|hw|homework)/.test(n)?"course_materials":/(study\s*(mate|group)|\bstudy\b|team\s*up)/.test(n)?"study_mate":/(coffee\s*chat|coffee\s*time|\bchat\b)/.test(n)?"coffee_chat":""};function Ct(e){const t=new Date(e),a=new Date-t,c=Math.floor(a/6e4),o=Math.floor(c/60),f=Math.floor(o/24);return c<60?`${c} mins ago`:o<24?`${o} hs ago`:f===1?"yesterday":`${f} days ago`}function At(){return r.createElement("svg",{viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":!0},r.createElement("circle",{cx:"12",cy:"8",r:"4",fill:"#cbd5e1"}),r.createElement("path",{d:"M4 20c0-4 4-6 8-6s8 2 8 6",fill:"#cbd5e1"}))}function St({post:e,onOpenDetail:t,showBadge:n,showActionsBar:a=!1,commentCount:c=0}){var T;const o=e.raw||{},f=Se(o),m=kt(o),x=f==="seeking"?m==="course_materials"?"ðŸ“":m==="study_mate"?"ðŸ‘¥":m==="coffee_chat"?"â˜•ï¸":"ðŸ“Œ":"",y={lecture_notes:"Lecture Notes",syllabus:"Syllabus",past_exams:"Past Exams",quiz_prep:"Quiz Prep"},A=(Array.isArray(o.materials)&&m==="course_materials"?o.materials:[]).map(N=>y[N]||N);return r.createElement("button",{type:"button",onClick:t,className:"w-full text-left py-4 px-3 hover:bg-slate-50 transition"},r.createElement("div",{className:"flex items-start gap-3"},n?r.createElement("span",{className:"text-[18px] w-6 text-center mt-[2px]"},x):r.createElement("span",{className:"w-6"}),r.createElement("div",{className:"h-8 w-8 rounded-full bg-slate-200 flex items-center justify-center mt-[2px]"},r.createElement(At,null)),r.createElement("div",{className:"min-w-0 flex-1"},r.createElement("div",{className:"flex items-start justify-between gap-3"},r.createElement("div",{className:"truncate font-semibold text-slate-900"},e.title),r.createElement("div",{className:"text-xs text-slate-500 whitespace-nowrap"},Ct(e.createdAt))),((T=e.raw)==null?void 0:T.content)&&r.createElement("p",{className:"mt-1 text-[13.5px] text-slate-600 line-clamp-1"},e.raw.content),A.length>0&&r.createElement("div",{className:"mt-3 flex flex-wrap gap-2"},A.map(N=>r.createElement("span",{key:N,className:"inline-flex items-center rounded-full border border-slate-700 bg-slate-50 px-2.5 py-[3px] text-[11px] text-slate-700"},N))),a&&r.createElement("div",{className:"flex items-center justify-between mt-2 pr-1 pl-[0px] text-slate-500 text-[13px]"},r.createElement("div",{className:"flex items-center gap-6"},r.createElement(pt,{size:18,className:"hover:text-slate-800 cursor-pointer"}),r.createElement(Et,{size:18,className:"hover:text-slate-800 cursor-pointer"}),r.createElement(wt,{size:18,className:"hover:text-slate-800 cursor-pointer"}),r.createElement("div",{className:"flex items-center gap-1"},r.createElement(bt,{size:17,className:"hover:text-slate-800 cursor-pointer"}),r.createElement("span",{className:"text-xs font-medium"},"DM"))),r.createElement("div",{className:"flex items-center gap-1 text-sm"},r.createElement(xt,{size:17,className:"hover:text-slate-800 cursor-pointer"}),r.createElement("span",null,c??0))))))}const Tt=e=>e?Array.isArray(e)?e:Array.isArray(e.items)?e.items:Array.isArray(e.data)?e.data:e.data&&Array.isArray(e.data.items)?e.data.items:[]:[],he=e=>Tt(e).map(t=>({_id:t._id||t.id,title:t.title||(typeof t.content=="string"?t.content.slice(0,80):"Untitled"),createdAt:t.createdAt||t.updatedAt||new Date().toISOString(),raw:t}));function jt(){const e=qe(),t=Oe(),{school:n}=He(),{user:a}=Fe(),c=De(),o=typeof n=="string"&&n?n.toLowerCase():"nyu",f=()=>{const s=new URLSearchParams(t.search),u=s.get("tab")==="free"?"general":"academic",d={q:s.get("q")||""},l={q:s.get("q")||"",type:s.get("type")||"all",kind:s.get("kind")||""};return{active:u,freeQuery:d,acadQuery:l}},[{active:m,freeQuery:x,acadQuery:y},H]=p.useState(f());p.useEffect(()=>H(f()),[t.search]);const[A,T]=p.useState({loading:!0,items:[],error:""}),[N,Te]=p.useState(12),z=p.useMemo(()=>{const{q:s}=x;let u=A.items;if(s){const d=s.toLowerCase();u=u.filter(l=>{var b;return l.title.toLowerCase().includes(d)||(((b=l.raw)==null?void 0:b.content)||"").toLowerCase().includes(d)})}return u},[A.items,x]),F={loading:A.loading,error:A.error,items:z.slice(0,N),hasMore:z.length>N},[E,S]=p.useState({items:[],page:1,limit:20,total:0,loading:!0,loadingMore:!1,hasMore:!0,error:""}),L=p.useCallback(async()=>{try{const s=await Be({school:o,limit:200,sort:"new"});T({loading:!1,items:he(s),error:""})}catch(s){T({loading:!1,items:[],error:(s==null?void 0:s.message)||"Failed to load posts."})}},[o]),k=p.useCallback(async(s=1,u=!1)=>{var fe,de;if(!o||o==="undefined"){S(Ie=>({...Ie,loading:!1,loadingMore:!1}));return}const d={school:o,page:s,limit:E.limit,q:y.q||"",sort:"new"};y.type&&y.type!=="all"&&(d.type=y.type),y.type==="seeking"&&y.kind&&(d.kind=y.kind);const l=await Ye(d),b=he(l),C=typeof(l==null?void 0:l.total)=="number"?l.total:typeof((fe=l==null?void 0:l.paging)==null?void 0:fe.total)=="number"?l.paging.total:u?E.total:b.length,je=typeof(l==null?void 0:l.limit)=="number"?l.limit:typeof((de=l==null?void 0:l.paging)==null?void 0:de.limit)=="number"?l.paging.limit:E.limit,me=u?[...E.items,...b]:b;S({items:me,page:s,limit:je,total:C,loading:!1,loadingMore:!1,hasMore:me.length<C&&b.length>0,error:""})},[o,y]);p.useEffect(()=>((async()=>await L())(),()=>{}),[o,L]),p.useEffect(()=>{S(s=>({...s,loading:!0,error:"",page:1})),k(1,!1).catch(s=>S(u=>({...u,loading:!1,error:(s==null?void 0:s.message)||"Failed to load posts."})))},[o,y.q,y.type,y.kind,k]),p.useEffect(()=>{m==="general"?L():k(1,!1)},[t.pathname]),p.useEffect(()=>{const s=()=>{m==="general"?L():k(1,!1)};return window.addEventListener("focus",s),()=>window.removeEventListener("focus",s)},[m,L,k]);const B=p.useRef(null),U=p.useRef(null);p.useEffect(()=>{if(!B.current)return;const s=new IntersectionObserver(u=>{u[0].isIntersecting&&Te(l=>l+10)},{rootMargin:"400px 0px 400px 0px"});return s.observe(B.current),()=>s.disconnect()},[z.length]),p.useEffect(()=>{if(!U.current)return;const s=new IntersectionObserver(u=>{u[0].isIntersecting&&E.hasMore&&!E.loading&&!E.loadingMore&&(S(l=>({...l,loadingMore:!0})),k(E.page+1,!0).catch(l=>S(b=>({...b,loadingMore:!1,error:(l==null?void 0:l.message)||"Failed to load more."}))))},{rootMargin:"600px 0px 600px 0px"});return s.observe(U.current),()=>s.disconnect()},[E.hasMore,E.loading,E.loadingMore,E.page,k]);const Re=(s,u)=>{var b,C;const d=((b=s.raw)==null?void 0:b._id)||s._id||((C=s.raw)==null?void 0:C.id)||s.id;if(!d)return;const l=u==="general"?`/freeboard/${d}`:`/academic/${d}`;e(c(l))},[h,R]=p.useState(""),[w,$]=p.useState(""),[Y,Me]=p.useState([]),[v,G]=p.useState("question"),[_,se]=p.useState("course_materials"),[ne,ae]=p.useState(""),[K,oe]=p.useState([]),Pe=s=>oe(u=>u.includes(s)?u.filter(d=>d!==s):[...u,s]),[le,ce]=p.useState(!1),[Q,j]=p.useState({type:"",text:""}),ie=!!a&&h.trim()&&(w.trim()||Y.length),ue=!!a&&(v==="question"?h.trim()&&w.trim():_==="course_materials"?h.trim()&&K.length>0:h.trim()),Le=async s=>{const u=[];for(const d of s)try{const l=await ze(d);(l!=null&&l.secure_url||l!=null&&l.url)&&u.push(l.secure_url||l.url)}catch{}return u},$e=async s=>{if(s.preventDefault(),j({type:"",text:""}),!a){j({type:"error",text:"Login required to post."});return}ce(!0);try{if(m==="general"){if(!ie)throw new Error("Missing fields");let u=[];Y.length&&(u=await Le(Y)),await Ue({school:o,title:h.trim(),content:w.trim(),images:u}),T(d=>({...d,items:[{_id:Math.random().toString(36).slice(2),title:h.trim(),createdAt:new Date().toISOString(),raw:{title:h.trim(),content:w.trim()}},...d.items]}))}else{if(!ue)throw new Error("Missing fields");const u={school:o};v==="question"?await W({...u,title:h.trim(),content:w.trim(),postType:"question"}):_==="course_materials"?await W({...u,title:h.trim(),content:"",postType:"seeking",kind:"course_materials",courseName:h.trim(),professor:ne.trim(),materials:K,tags:["seeking","course_materials"]}):await W({...u,title:h.trim(),content:w.trim(),postType:"seeking",kind:_,tags:["seeking",_]}),S(d=>({...d,loading:!0})),await k(1,!1)}R(""),$(""),Me([]),G("question"),se("course_materials"),ae(""),oe([]),j({type:"success",text:"Posted!"}),setTimeout(()=>j({type:"",text:""}),1200)}catch(u){j({type:"error",text:(u==null?void 0:u.message)||"Failed to post."})}finally{ce(!1)}},I=m==="general"?{loading:F.loading,items:F.items,hasMore:F.hasMore,error:F.error}:{loading:E.loading,items:E.items,hasMore:E.hasMore,error:E.error,loadingMore:E.loadingMore};return r.createElement("div",{className:"min-h-screen",style:{background:_t.pageBg}},r.createElement("main",{className:"mx-auto max-w-6xl px-4 py-6 grid grid-cols-1 md:grid-cols-[minmax(620px,700px)_380px] gap-10"},r.createElement("section",{className:"md:col-start-1"},I.loading?r.createElement("ul",{className:"mt-4 space-y-3"},Array.from({length:10}).map((s,u)=>r.createElement("li",{key:u,className:"h-16 rounded-xl bg-white/70 border border-slate-200 animate-pulse"}))):I.items.length?r.createElement(r.Fragment,null,r.createElement("ul",{className:"mt-5 mx-auto max-w-[700px] px-2 space-y-4"},I.items.map(s=>{var l,b,C;const u=m==="general"||m==="academic"&&Se(s.raw||{})==="question",d=((l=s.raw)==null?void 0:l.commentCount)??((b=s.raw)==null?void 0:b.commentsCount)??(Array.isArray((C=s.raw)==null?void 0:C.comments)?s.raw.comments.length:0);return r.createElement("li",{key:s._id||Math.random()},r.createElement("div",{className:"mx-6 border-b border-slate-300/80 py-3"},r.createElement(St,{post:s,onOpenDetail:()=>Re(s,m),showBadge:m==="academic",showActionsBar:u,commentCount:d})))})),r.createElement("div",{className:"flex justify-center py-6"},r.createElement("div",{ref:m==="general"?B:U,className:"h-6 w-6 rounded-full border-2 border-dashed border-slate-300","aria-hidden":!0})),m==="academic"&&I.loadingMore&&r.createElement("div",{className:"text-center pb-8 text-slate-500 text-sm"},"Loading moreâ€¦")):r.createElement("div",{className:"mx-auto max-w-[700px] text-center py-16"},r.createElement("p",{className:"text-[15px] text-slate-600"},I.error||"No posts yet."))),r.createElement("aside",{className:"md:col-start-2 md:sticky md:top-[24px] self-start"},r.createElement("div",{className:"rounded-2xl bg-white shadow-lg overflow-hidden"},r.createElement("form",{onSubmit:$e},r.createElement("div",{className:"px-5 pt-5"},r.createElement("p",{className:"text-[13px] text-slate-500"},"Posting as ",r.createElement("span",{className:"font-semibold"},"anonymous")," in"," ",r.createElement("span",{className:"font-semibold"},m==="general"?"Free Board":"Academic Board"))),m==="academic"&&r.createElement("div",{className:"px-5 mt-3"},r.createElement("div",{className:"flex items-center gap-6 text-sm font-semibold"},r.createElement("button",{type:"button",onClick:()=>G("question"),className:`pb-2 relative ${v==="question"?"text-slate-900":"text-slate-400"}`,"aria-pressed":v==="question"},"General Q&A",v==="question"&&r.createElement("span",{className:"absolute left-0 right-0 -bottom-[2px] h-[2px] bg-rose-300 rounded-full"})),r.createElement("button",{type:"button",onClick:()=>G("seeking"),className:`pb-2 relative ${v==="seeking"?"text-slate-900":"text-slate-400"}`,"aria-pressed":v==="seeking"},"Seeking",v==="seeking"&&r.createElement("span",{className:"absolute left-0 right-0 -bottom-[2px] h-[2px] bg-rose-300 rounded-full"})))),r.createElement("div",{className:"mt-3 border-t border-slate-200"}),r.createElement("div",{className:"p-5"},m==="academic"&&v==="seeking"&&r.createElement(r.Fragment,null,r.createElement("div",{className:"flex gap-4 justify-start"},[{key:"course_materials",label:`Study
Material`,icon:"ðŸ“„"},{key:"coffee_chat",label:`Coffee
Chat`,icon:"â˜•ï¸"},{key:"study_mate",label:`Study
Group`,icon:"ðŸ‘¥"}].map(s=>{const u=_===s.key;return r.createElement("button",{key:s.key,type:"button",onClick:()=>se(s.key),className:`w-[116px] h-[142px] rounded-3xl border transition 
                                        whitespace-pre-line shadow-sm will-change-transform
                                        ${u?"bg-rose-500 text-white border-rose-500 scale-110":"bg-rose-50 text-rose-500 border-rose-200"} 
                                        hover:bg-rose-500 hover:text-white hover:border-rose-500
                                        hover:shadow-md hover:scale-110 active:scale-110
                                        duration-200 ease-out`,"aria-pressed":u},r.createElement("div",{className:"h-full flex flex-col items-center justify-center gap-2"},r.createElement("div",{className:"text-[30px] leading-none"},s.icon),r.createElement("div",{className:"text-[16px] font-semibold text-center"},s.label)))})),r.createElement("div",{className:"h-5"})),m==="general"&&r.createElement(r.Fragment,null,r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Title"),r.createElement("input",{value:h,onChange:s=>R(s.target.value),placeholder:"Any core course recommendation?",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Related Course (if there is any)"),r.createElement("input",{placeholder:"Intro to Micro Economics ..",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"})),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Content"),r.createElement("textarea",{value:w,onChange:s=>$(s.target.value),placeholder:"I'm Freshman, and looking for a core course which is not that strictly graded and has no exams.",className:"w-full min-h-[120px] rounded-xl border border-rose-200 px-3 py-2 text-[14px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}))),m==="academic"&&v==="question"&&r.createElement(r.Fragment,null,r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Title"),r.createElement("input",{value:h,onChange:s=>R(s.target.value),placeholder:"Any core course recommendation?",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Related Course (if there is any)"),r.createElement("input",{placeholder:"Intro to Micro Economics ..",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"})),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Content"),r.createElement("textarea",{value:w,onChange:s=>$(s.target.value),placeholder:"Describe your academic/career questionâ€¦",className:"w-full min-h-[140px] rounded-xl border border-rose-200 px-3 py-2 text-[14px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}))),m==="academic"&&v==="seeking"&&_==="course_materials"&&r.createElement(r.Fragment,null,r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Course Name"),r.createElement("input",{value:h,onChange:s=>R(s.target.value),placeholder:"Intro to Micro Economics",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Professor (Optional)"),r.createElement("input",{value:ne,onChange:s=>ae(s.target.value),placeholder:"Andy Park",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"})),r.createElement("div",{className:"mt-6"},r.createElement("p",{className:"text-sm text-slate-600"},"Itâ€™d be great if you have personal note on,",r.createElement("span",{className:"ml-2 text-slate-400"},"(Select all)")),r.createElement("div",{className:"mt-3 flex flex-col gap-3"},[{key:"syllabus",label:"Syllabus"},{key:"lecture_notes",label:"Other class material"},{key:"past_exams",label:"Past Exams"},{key:"quiz_prep",label:"Projects"}].map(s=>r.createElement("label",{key:s.key,className:"flex items-center gap-3"},r.createElement("input",{type:"checkbox",className:"h-4 w-4 accent-rose-500 ring-1 ring-rose-300 rounded-[3px] focus:ring-2 focus:ring-rose-400",checked:K.includes(s.key),onChange:()=>Pe(s.key)}),r.createElement("span",{className:"text-[15px] text-slate-700"},s.label)))))),m==="academic"&&v==="seeking"&&_==="coffee_chat"&&r.createElement(r.Fragment,null,r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Title"),r.createElement("input",{value:h,onChange:s=>R(s.target.value),placeholder:"Transfer from CAS to TISCH",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Topic"),r.createElement("textarea",{value:w,onChange:s=>$(s.target.value),placeholder:"Iâ€™m thinking about transferring... looking for some advice...",className:"w-full min-h-[140px] rounded-xl border border-rose-200 px-3 py-2 text-[14px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}))),m==="academic"&&v==="seeking"&&_==="study_mate"&&r.createElement(r.Fragment,null,r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Title"),r.createElement("input",{value:h,onChange:s=>R(s.target.value),placeholder:"Econ 101 midterm study group",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"(optional) Related Course (if any)"),r.createElement("input",{placeholder:"Intro to Micro Economics",className:"w-full rounded-xl border border-rose-200 px-3 py-2 text-[15px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"})),r.createElement("div",{className:"mt-4"},r.createElement("label",{className:"block text-sm text-slate-600 mb-1"},"Topic"),r.createElement("textarea",{value:w,onChange:s=>$(s.target.value),placeholder:"For the Midterm coming in next week, Iâ€™m looking for some study buddies...",className:"w-full min-h-[140px] rounded-xl border border-rose-200 px-3 py-2 text-[14px] focus:outline-none focus:ring-2 focus:ring-rose-200/70"}))),r.createElement("div",{className:"mt-6 flex items-center justify-between"},r.createElement("p",{className:"text-[12px] text-slate-500"},"Posting to"," ",r.createElement("strong",null,m==="general"?"Free Board":v==="question"?"Academic":_==="course_materials"?"Seeking â€¢ Study Material":_==="coffee_chat"?"Seeking â€¢ Coffee Chat":"Seeking â€¢ Study Group"),"."),r.createElement("div",{className:"flex flex-col items-end"},r.createElement("button",{type:"submit",disabled:le||(m==="general"?!ie:!ue),className:"rounded-2xl bg-rose-500 px-5 py-2 text-sm font-semibold text-white shadow-md hover:bg-rose-600 active:scale-[0.98] disabled:opacity-60"},le?"Postingâ€¦":"Post",r.createElement("span",{className:"ml-2 text-white/80"},r.createElement("span",{className:"line-through"}," 6 C points"))),r.createElement("span",{className:"text-[11px] text-slate-400 mt-[3px]"},"0 C points during the beta"))),!!Q.text&&r.createElement("div",{className:`mt-4 text-sm rounded-lg px-3 py-2 ${Q.type==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`},Q.text)))))))}export{jt as default};
