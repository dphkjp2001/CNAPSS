import{u as De,a as Ye,b as ze,c as Be,d as Fe,r as f,R as t,e as Ue}from"./index-054f5cea.js";import{u as We}from"./uploadToCloudinary-dc971086.js";import{g as Ke,c as Ge}from"./posts-11cdb806.js";import{g as Qe,c as ee}from"./academicPosts-c1692ec7.js";import"./http-a6fe908c.js";var Ce={exports:{}},m={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var se=Symbol.for("react.transitional.element"),Ze=Symbol.for("react.portal"),Ve=Symbol.for("react.fragment"),Xe=Symbol.for("react.strict_mode"),Je=Symbol.for("react.profiler"),et=Symbol.for("react.consumer"),tt=Symbol.for("react.context"),rt=Symbol.for("react.forward_ref"),nt=Symbol.for("react.suspense"),st=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),at=Symbol.for("react.activity"),be=Symbol.iterator;function ot(e){return e===null||typeof e!="object"?null:(e=be&&e[be]||e["@@iterator"],typeof e=="function"?e:null)}var Ae={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Re=Object.assign,Me={};function O(e,r,n){this.props=e,this.context=r,this.refs=Me,this.updater=n||Ae}O.prototype.isReactComponent={};O.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};O.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Te(){}Te.prototype=O.prototype;function ae(e,r,n){this.props=e,this.context=r,this.refs=Me,this.updater=n||Ae}var oe=ae.prototype=new Te;oe.constructor=ae;Re(oe,O.prototype);oe.isPureReactComponent=!0;var ve=Array.isArray;function re(){}var x={H:null,A:null,T:null,S:null},Pe=Object.prototype.hasOwnProperty;function le(e,r,n){var s=n.ref;return{$$typeof:se,type:e,key:r,ref:s!==void 0?s:null,props:n}}function lt(e,r){return le(e.type,r,e.props)}function ce(e){return typeof e=="object"&&e!==null&&e.$$typeof===se}function ct(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return r[n]})}var we=/\/+/g;function te(e,r){return typeof e=="object"&&e!==null&&e.key!=null?ct(""+e.key):r.toString(36)}function it(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(re,re):(e.status="pending",e.then(function(r){e.status==="pending"&&(e.status="fulfilled",e.value=r)},function(r){e.status==="pending"&&(e.status="rejected",e.reason=r)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function j(e,r,n,s,l){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var c=!1;if(e===null)c=!0;else switch(a){case"bigint":case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case se:case Ze:c=!0;break;case Se:return c=e._init,j(c(e._payload),r,n,s,l)}}if(c)return l=l(e),c=s===""?"."+te(e,0):s,ve(l)?(n="",c!=null&&(n=c.replace(we,"$&/")+"/"),j(l,r,n,"",function(E){return E})):l!=null&&(ce(l)&&(l=lt(l,n+(l.key==null||e&&e.key===l.key?"":(""+l.key).replace(we,"$&/")+"/")+c)),r.push(l)),1;c=0;var u=s===""?".":s+":";if(ve(e))for(var p=0;p<e.length;p++)s=e[p],a=u+te(s,p),c+=j(s,r,n,a,l);else if(p=ot(e),typeof p=="function")for(e=p.call(e),p=0;!(s=e.next()).done;)s=s.value,a=u+te(s,p++),c+=j(s,r,n,a,l);else if(a==="object"){if(typeof e.then=="function")return j(it(e),r,n,s,l);throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.")}return c}function G(e,r,n){if(e==null)return e;var s=[],l=0;return j(e,s,"","",function(a){return r.call(n,a,l++)}),s}function ut(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var _e=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},mt={map:G,forEach:function(e,r,n){G(e,function(){r.apply(this,arguments)},n)},count:function(e){var r=0;return G(e,function(){r++}),r},toArray:function(e){return G(e,function(r){return r})||[]},only:function(e){if(!ce(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};m.Activity=at;m.Children=mt;m.Component=O;m.Fragment=Ve;m.Profiler=Je;m.PureComponent=ae;m.StrictMode=Xe;m.Suspense=nt;m.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x;m.__COMPILER_RUNTIME={__proto__:null,c:function(e){return x.H.useMemoCache(e)}};m.cache=function(e){return function(){return e.apply(null,arguments)}};m.cacheSignal=function(){return null};m.cloneElement=function(e,r,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var s=Re({},e.props),l=e.key;if(r!=null)for(a in r.key!==void 0&&(l=""+r.key),r)!Pe.call(r,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&r.ref===void 0||(s[a]=r[a]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];s.children=c}return le(e.type,l,s)};m.createContext=function(e){return e={$$typeof:tt,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:et,_context:e},e};m.createElement=function(e,r,n){var s,l={},a=null;if(r!=null)for(s in r.key!==void 0&&(a=""+r.key),r)Pe.call(r,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(l[s]=r[s]);var c=arguments.length-2;if(c===1)l.children=n;else if(1<c){for(var u=Array(c),p=0;p<c;p++)u[p]=arguments[p+2];l.children=u}if(e&&e.defaultProps)for(s in c=e.defaultProps,c)l[s]===void 0&&(l[s]=c[s]);return le(e,a,l)};m.createRef=function(){return{current:null}};m.forwardRef=function(e){return{$$typeof:rt,render:e}};m.isValidElement=ce;m.lazy=function(e){return{$$typeof:Se,_payload:{_status:-1,_result:e},_init:ut}};m.memo=function(e,r){return{$$typeof:st,type:e,compare:r===void 0?null:r}};m.startTransition=function(e){var r=x.T,n={};x.T=n;try{var s=e(),l=x.S;l!==null&&l(n,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(re,_e)}catch(a){_e(a)}finally{r!==null&&n.types!==null&&(r.types=n.types),x.T=r}};m.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()};m.use=function(e){return x.H.use(e)};m.useActionState=function(e,r,n){return x.H.useActionState(e,r,n)};m.useCallback=function(e,r){return x.H.useCallback(e,r)};m.useContext=function(e){return x.H.useContext(e)};m.useDebugValue=function(){};m.useDeferredValue=function(e,r){return x.H.useDeferredValue(e,r)};m.useEffect=function(e,r){return x.H.useEffect(e,r)};m.useEffectEvent=function(e){return x.H.useEffectEvent(e)};m.useId=function(){return x.H.useId()};m.useImperativeHandle=function(e,r,n){return x.H.useImperativeHandle(e,r,n)};m.useInsertionEffect=function(e,r){return x.H.useInsertionEffect(e,r)};m.useLayoutEffect=function(e,r){return x.H.useLayoutEffect(e,r)};m.useMemo=function(e,r){return x.H.useMemo(e,r)};m.useOptimistic=function(e,r){return x.H.useOptimistic(e,r)};m.useReducer=function(e,r,n){return x.H.useReducer(e,r,n)};m.useRef=function(e){return x.H.useRef(e)};m.useState=function(e){return x.H.useState(e)};m.useSyncExternalStore=function(e,r,n){return x.H.useSyncExternalStore(e,r,n)};m.useTransition=function(){return x.H.useTransition()};m.version="19.2.0";Ce.exports=m;var z=Ce.exports;/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ft=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,n,s)=>s?s.toUpperCase():n.toLowerCase()),ke=e=>{const r=ft(e);return r.charAt(0).toUpperCase()+r.slice(1)},Le=(...e)=>e.filter((r,n,s)=>!!r&&r.trim()!==""&&s.indexOf(r)===n).join(" ").trim(),pt=e=>{for(const r in e)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=z.forwardRef(({color:e="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:l="",children:a,iconNode:c,...u},p)=>z.createElement("svg",{ref:p,...gt,width:r,height:r,stroke:e,strokeWidth:s?Number(n)*24/Number(r):n,className:Le("lucide",l),...!a&&!pt(u)&&{"aria-hidden":"true"},...u},[...c.map(([E,w])=>z.createElement(E,w)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=(e,r)=>{const n=z.forwardRef(({className:s,...l},a)=>z.createElement(yt,{ref:a,iconNode:r,className:Le(`lucide-${dt(ke(e))}`,`lucide-${e}`,s),...l}));return n.displayName=ke(e),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],ht=B("bookmark",xt);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],bt=B("message-square",Et);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]],wt=B("repeat-2",vt);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],kt=B("send",_t);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]],Ct=B("share",Nt),ne={pageBg:"#FFFFFF",text:"#0F172A",sub:"#64748B",primary:"#111827",pink:"#FF6B8A",red:"#FF7A70"},St=[{key:"lecture_notes",label:"Lecture Notes"},{key:"syllabus",label:"Syllabus"},{key:"past_exams",label:"Past Exams"},{key:"quiz_prep",label:"Quiz Prep"}],At=(e="")=>String(e).toLowerCase().trim().replace(/[\s_-]+/g,"_"),qe=(e={})=>{const r=e.postType||e.type||e.mode||(e.lookingFor?"seeking":"question")||"",n=String(r).toLowerCase();return n==="looking_for"||n==="seeking"||n==="lf"?"seeking":"question"},Rt=(e={})=>{const r=At(e.kind||"");if(r)return r;const n=[e.kind,...Array.isArray(e.tags)?e.tags:[],e.title,e.content].filter(Boolean).join(" ").toLowerCase();return/(course\s*materials?|syllabus|notes?|exam|midterm|final|assignment|hw|homework)/.test(n)?"course_materials":/(study\s*(mate|group)|\bstudy\b|team\s*up)/.test(n)?"study_mate":/(coffee\s*chat|coffee\s*time|\bchat\b)/.test(n)?"coffee_chat":""};function Mt(e){const r=new Date(e),s=new Date-r,l=Math.floor(s/6e4),a=Math.floor(l/60),c=Math.floor(a/24);return l<60?`${l} mins ago`:a<24?`${a} hs ago`:c===1?"yesterday":`${c} days ago`}function Tt(){return t.createElement("svg",{viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":!0},t.createElement("circle",{cx:"12",cy:"8",r:"4",fill:"#cbd5e1"}),t.createElement("path",{d:"M4 20c0-4 4-6 8-6s8 2 8 6",fill:"#cbd5e1"}))}function Pt({children:e}){return t.createElement("div",{className:"rounded-2xl bg-white shadow-lg overflow-hidden"},e)}function Lt({value:e,onChange:r}){const n=e==="general",s=f.useRef(null),l=f.useRef(null),[a,c]=f.useState({w:0,x:0}),u=()=>{const p=s.current,E=l.current;if(!p||!E)return;const w=n?p:E;c({w:w.offsetWidth,x:w.offsetLeft-p.offsetLeft})};return f.useLayoutEffect(()=>{var E;u();const p=new ResizeObserver(u);return(E=s.current)!=null&&E.parentElement&&p.observe(s.current.parentElement),()=>p.disconnect()},[n]),t.createElement(t.Fragment,null,t.createElement("style",null,`
        @keyframes wiggleScale {
          0% { transform: translateY(0) scale(1); }
          25% { transform: translateY(-2px) scale(1.03); }
          50% { transform: translateY(0.5px) scale(1.01); }
          75% { transform: translateY(-1px) scale(1.02); }
          100% { transform: translateY(0) scale(1); }
        }
      `),t.createElement("div",{className:"w-full flex justify-center"},t.createElement("div",{className:"relative inline-flex items-center gap-8"},t.createElement("span",{"aria-hidden":!0,className:"absolute -bottom-2 h-[3px] rounded-full transition-transform duration-300 ease-out",style:{width:a.w||0,transform:`translateX(${a.x||0}px)`,background:`linear-gradient(90deg, ${ne.pink}, ${ne.red})`}}),t.createElement("button",{ref:s,type:"button",onClick:()=>r("general"),className:`text-[22px] font flex items-center gap-2 transition-all ${n?"text-slate-900":"text-slate-400 hover:text-slate-600"} ${n?"animate-[wiggleScale_360ms_ease-in-out]":""}`,"aria-pressed":n},t.createElement("span",{"aria-hidden":!0},"💬"),t.createElement("span",null,"General")),t.createElement("button",{ref:l,type:"button",onClick:()=>r("academic"),className:`text-[22px] font flex items-center gap-2 transition-all ${n?"text-slate-400 hover:text-slate-600":"text-slate-900 animate-[wiggleScale_360ms_ease-in-out]"}`,"aria-pressed":!n},t.createElement("span",{"aria-hidden":!0},"🎓"),t.createElement("span",null,"Academic")))))}function qt({post:e,onOpenDetail:r,showBadge:n,showActionsBar:s=!1,commentCount:l=0}){var T;const a=e.raw||{},c=qe(a),u=Rt(a),p=c==="seeking"?u==="course_materials"?"📝":u==="study_mate"?"👥":u==="coffee_chat"?"☕️":"📌":"",E={lecture_notes:"Lecture Notes",syllabus:"Syllabus",past_exams:"Past Exams",quiz_prep:"Quiz Prep"},P=(Array.isArray(a.materials)&&u==="course_materials"?a.materials:[]).map(A=>E[A]||A);return t.createElement("button",{type:"button",onClick:r,className:"w-full text-left py-4 px-3 hover:bg-slate-50 transition"},t.createElement("div",{className:"flex items-start gap-3"},n?t.createElement("span",{className:"text-[18px] w-6 text-center mt-[2px]"},p):t.createElement("span",{className:"w-6"}),t.createElement("div",{className:"h-8 w-8 rounded-full bg-slate-200 flex items-center justify-center mt-[2px]"},t.createElement(Tt,null)),t.createElement("div",{className:"min-w-0 flex-1"},t.createElement("div",{className:"flex items-start justify-between gap-3"},t.createElement("div",{className:"truncate font-semibold text-slate-900"},e.title),t.createElement("div",{className:"text-xs text-slate-500 whitespace-nowrap"},Mt(e.createdAt))),((T=e.raw)==null?void 0:T.content)&&t.createElement("p",{className:"mt-1 text-[13.5px] text-slate-600 line-clamp-1"},e.raw.content),P.length>0&&t.createElement("div",{className:"mt-3 flex flex-wrap gap-2"},P.map(A=>t.createElement("span",{key:A,className:"inline-flex items-center rounded-full border border-slate-700 bg-slate-50 px-2.5 py-[3px] text-[11px] text-slate-700"},A))),s&&t.createElement("div",{className:"flex items-center justify-between mt-2 pr-1 pl-[0px] text-slate-500 text-[13px]"},t.createElement("div",{className:"flex items-center gap-6"},t.createElement(ht,{size:18,className:"hover:text-slate-800 cursor-pointer"}),t.createElement(wt,{size:18,className:"hover:text-slate-800 cursor-pointer"}),t.createElement(Ct,{size:18,className:"hover:text-slate-800 cursor-pointer"}),t.createElement("div",{className:"flex items-center gap-1"},t.createElement(kt,{size:17,className:"hover:text-slate-800 cursor-pointer"}),t.createElement("span",{className:"text-xs font-medium"},"DM"))),t.createElement("div",{className:"flex items-center gap-1 text-sm"},t.createElement(bt,{size:17,className:"hover:text-slate-800 cursor-pointer"}),t.createElement("span",null,l??0))))))}const $t=e=>e?Array.isArray(e)?e:Array.isArray(e.items)?e.items:Array.isArray(e.data)?e.data:e.data&&Array.isArray(e.data.items)?e.data.items:[]:[],Ne=e=>$t(e).map(r=>({_id:r._id||r.id,title:r.title||(typeof r.content=="string"?r.content.slice(0,80):"Untitled"),createdAt:r.createdAt||r.updatedAt||new Date().toISOString(),raw:r}));function jt({value:e,onSubmit:r,onReset:n}){const[s,l]=f.useState(e);f.useEffect(()=>l(e),[e]);const a=c=>{c.preventDefault(),r(s)};return t.createElement("form",{onSubmit:a,className:"mx-auto mt-5 w-full max-w-[700px] rounded-full shadow-[0_6px_24px_rgba(0,0,0,0.06)] bg-white border border-slate-200 overflow-hidden"},t.createElement("div",{className:"grid grid-cols-[1fr_auto] items-stretch"},t.createElement("div",{className:"px-5 py-3"},t.createElement("div",{className:"text-[11px] font-semibold text-slate-500"},"Keyword"),t.createElement("input",{value:s.q||"",onChange:c=>l({q:c.target.value}),placeholder:"Search posts…",className:"w-full bg-transparent text-[14px] focus:outline-none"})),t.createElement("div",{className:"flex items-center gap-2 px-3"},t.createElement("button",{type:"button",onClick:()=>n(),className:"px-3 py-2 rounded-full text-sm text-slate-700 hover:bg-slate-100"},"Reset"),t.createElement("button",{type:"submit",className:"px-4 py-2 rounded-full bg-black text-white text-sm font-semibold"},"Search"))))}function Ot({value:e,onSubmit:r,onReset:n}){const[s,l]=f.useState(e),[a,c]=f.useState(!1),[u,p]=f.useState("type"),E=f.useRef(null),[w,P]=f.useState({left:0,top:0,width:0,bottom:0});f.useEffect(()=>l(e),[e]);const T=()=>{const d=E.current;if(!d)return;const v=d.getBoundingClientRect();P({left:v.left,top:v.top,width:v.width,bottom:v.bottom})};f.useLayoutEffect(()=>{T();const d=()=>T();return window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}},[]),f.useEffect(()=>{const d=k=>{var S,R;a&&(E.current&&E.current.contains(k.target)||(R=(S=k.target).closest)!=null&&R.call(S,"[data-acad-popover]")||(c(!1),p("type")))},v=k=>k.key==="Escape"&&c(!1);return document.addEventListener("click",d),document.addEventListener("keydown",v),()=>{document.removeEventListener("click",d),document.removeEventListener("keydown",v)}},[a]);const A=d=>l(v=>({...v,...d})),I=[{key:"question",title:"General question",desc:"Ask about courses, careers, visa, housing…",icon:t.createElement("svg",{viewBox:"0 0 24 24",width:"20",height:"20",className:"text-slate-700"},t.createElement("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor",opacity:".08"}),t.createElement("path",{d:"M9.5 9.5a2.5 2.5 0 1 1 3.9 2l-.8.5a1.6 1.6 0 0 0-.6 1.2v.3",stroke:"currentColor",strokeWidth:"1.6",fill:"none",strokeLinecap:"round"}),t.createElement("circle",{cx:"12",cy:"16.5",r:"1",fill:"currentColor"}))},{key:"seeking",title:"Seeking",desc:"Find materials, study mates, or coffee chats",icon:t.createElement("svg",{viewBox:"0 0 24 24",width:"20",height:"20",className:"text-slate-700"},t.createElement("rect",{x:"4",y:"5",width:"16",height:"12",rx:"2",fill:"currentColor",opacity:".08"}),t.createElement("path",{d:"M5.5 8h13M7 12h10M9 16h6",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}))}],H=[{key:"course_materials",title:"Course Materials",desc:"Syllabus, notes, exams…",emoji:"📝"},{key:"study_mate",title:"Study Mate",desc:"Find peers to study together",emoji:"👥"},{key:"coffee_chat",title:"Coffee Chat",desc:"Casual chat / mentoring",emoji:"☕️"}],q=({leading:d,title:v,desc:k,selected:S,onClick:R})=>t.createElement("button",{type:"button",onClick:R,className:`w-full flex items-center gap-3 px-3 py-3 rounded-2xl transition text-left
        ${S?"bg-slate-50 border border-slate-300 shadow-[inset_0_0_0_1px_rgba(15,23,42,0.06)]":"hover:bg-slate-50 border border-transparent"}`},t.createElement("div",{className:"h-9 w-9 rounded-xl bg-slate-100 flex items-center justify-center shrink-0"},d),t.createElement("div",{className:"min-w-0"},t.createElement("div",{className:"font-medium text-[14.5px] text-slate-900 truncate"},v),t.createElement("div",{className:"text-[12.5px] text-slate-500 truncate"},k))),_=()=>{const S=Math.min(520,Math.max(300,w.width-32,0),window.innerWidth-32),R=Math.round(w.left+(w.width-S)/2),Q=Math.round(w.bottom+8);return Ue.createPortal(t.createElement("div",{"data-acad-popover":!0,className:"z-50 fixed",style:{left:R,top:Q,width:S}},t.createElement("div",{className:"rounded-[24px] bg-white shadow-2xl border border-slate-200 overflow-hidden"},t.createElement("div",{className:"max-h-[70vh] overflow-auto p-3"},t.createElement("div",{className:"px-1 pb-2 text-[11.5px] font-semibold text-slate-500"},u==="type"?"Type":"Seeking · choose kind"),u==="type"&&t.createElement("div",{className:"space-y-2"},I.map(g=>t.createElement(q,{key:g.key,leading:g.icon,title:g.title,desc:g.desc,selected:(s.type||"question")===g.key,onClick:()=>{if(g.key==="question"){const L={...s,type:"question",kind:""};l(L),r(L),c(!1),p("type");return}p("kind")}}))),u==="kind"&&t.createElement("div",{className:"space-y-2"},H.map(g=>t.createElement(q,{key:g.key,leading:t.createElement("span",{className:"text-base"},g.emoji),title:g.title,desc:g.desc,selected:s.type==="seeking"&&s.kind===g.key,onClick:()=>{const L={...s,type:"seeking",kind:g.key};l(L),r(L),c(!1),p("type")}})))))),document.body)},F=d=>{d.preventDefault(),r(s),c(!1),p("type")};return t.createElement("div",{className:"mx-auto mt-5 w-full max-w-[860px]",ref:E},t.createElement("form",{onSubmit:F,className:"rounded-full shadow-[0_6px_24px_rgba(0,0,0,0.06)] bg-white border border-slate-200 overflow-hidden"},t.createElement("div",{className:"grid grid-cols-[1.2fr_0.9fr_auto] items-stretch"},t.createElement("div",{className:"px-5 py-3 border-r"},t.createElement("div",{className:"text-[11px] font-semibold text-slate-500"},"Keyword"),t.createElement("input",{value:s.q||"",onChange:d=>A({q:d.target.value}),placeholder:"Search academic posts…",className:"w-full bg-transparent text-[14px] focus:outline-none"})),t.createElement("button",{type:"button",onClick:()=>{T(),c(!0),p("type")},className:"px-5 text-left py-3 border-r hover:bg-slate-50"},t.createElement("div",{className:"text-[11px] font-semibold text-slate-500"},"Type"),t.createElement("div",{className:"text-[14px]"},s.type==="seeking"?"Seeking":"General Question")),t.createElement("div",{className:"flex items-center gap-2 px-3"},t.createElement("button",{type:"button",onClick:()=>{l({q:"",type:"question",kind:""}),n==null||n()},className:"px-3 py-2 rounded-full text-sm text-slate-700 hover:bg-slate-100"},"Reset"),t.createElement("button",{type:"submit",className:"px-4 py-2 rounded-full bg-black text-white text-sm font-semibold"},"Search")))),a&&t.createElement(_,null))}function It({title:e,setTitle:r,active:n,mode:s,lookingKind:l}){return t.createElement("div",{className:"flex items-center gap-3 p-4 border-b border-slate-200"},t.createElement("div",{className:"shrink-0 h-10 w-10 rounded-full bg-slate-200 flex items-center justify-center"},t.createElement("svg",{viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":!0},t.createElement("circle",{cx:"12",cy:"8",r:"4",fill:"#cbd5e1"}),t.createElement("path",{d:"M4 20c0-4 4-6 8-6s8 2 8 6",fill:"#cbd5e1"}))),t.createElement("div",{className:"flex-1"},t.createElement("input",{value:e,onChange:a=>r(a.target.value),placeholder:n==="general"?"Write a catchy title for your post…":s==="question"?"Ask an academic/career question…":l==="course_materials"?"Course name (e.g., STAT101)":"Seeking… (short title)",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-[15px] font-semibold text-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900/10 focus:border-slate-900"}),t.createElement("p",{className:"mt-1 text-xs text-slate-500"},"Posting as ",t.createElement("span",{className:"font-medium"},"anonymous"))))}function Ft(){const e=De(),r=Ye(),{school:n}=ze(),{user:s}=Be(),l=Fe(),a=n||"nyu",c=!!s,[u,p]=f.useState("academic");f.useEffect(()=>{const i=(new URLSearchParams(r.search).get("tab")||"").toLowerCase();i==="free"?p("general"):i==="academic"&&p("academic")},[r.search]);const[E,w]=f.useState({loading:!0,items:[],error:""}),[P,T]=f.useState({q:""}),[A,I]=f.useState(12),H=f.useMemo(()=>{const{q:o}=P;let i=E.items;if(o){const b=o.toLowerCase();i=i.filter(y=>{var C;return y.title.toLowerCase().includes(b)||(((C=y.raw)==null?void 0:C.content)||"").toLowerCase().includes(b)})}return i},[E.items,P]),q={loading:E.loading,error:E.error,items:H.slice(0,A),hasMore:H.length>A},[_,F]=f.useState({q:"",type:"all",kind:""}),[d,v]=f.useState({items:[],page:1,limit:20,total:0,loading:!0,loadingMore:!1,hasMore:!0,error:""}),k=f.useCallback(async(o=1,i=!1)=>{var he,Ee;const b=_.q||"",y=_.type==="all"?"":_.type,C=_.type==="seeking"?_.kind:"",h=await Qe({school:a,page:o,limit:d.limit,q:b,sort:"new",type:y,kind:C}),K=Ne(h),ye=typeof(h==null?void 0:h.total)=="number"?h.total:typeof((he=h==null?void 0:h.paging)==null?void 0:he.total)=="number"?h.paging.total:i?d.total:K.length,He=typeof(h==null?void 0:h.limit)=="number"?h.limit:typeof((Ee=h==null?void 0:h.paging)==null?void 0:Ee.limit)=="number"?h.paging.limit:d.limit,xe=i?[...d.items,...K]:K;v({items:xe,page:o,limit:He,total:ye,loading:!1,loadingMore:!1,hasMore:xe.length<ye&&K.length>0,error:""})},[a,_,d.items,d.limit,d.total]);f.useEffect(()=>{let o=!0;return(async()=>{try{const i=await Ke({school:a,limit:200,sort:"new"});if(!o)return;w({loading:!1,items:Ne(i),error:""})}catch(i){if(!o)return;w({loading:!1,items:[],error:(i==null?void 0:i.message)||"Failed to load posts."})}})(),()=>{o=!1}},[a]),f.useEffect(()=>{v(o=>({...o,loading:!0,error:"",page:1})),k(1,!1).catch(o=>v(i=>({...i,loading:!1,error:(o==null?void 0:o.message)||"Failed to load posts."})))},[a,_.q,_.type,_.kind]);const S=f.useRef(null),R=f.useRef(null);f.useEffect(()=>{if(!S.current)return;const o=new IntersectionObserver(i=>{i[0].isIntersecting&&I(y=>y+10)},{rootMargin:"400px 0px 400px 0px"});return o.observe(S.current),()=>o.disconnect()},[H.length]),f.useEffect(()=>{if(!R.current)return;const o=new IntersectionObserver(i=>{i[0].isIntersecting&&d.hasMore&&!d.loading&&!d.loadingMore&&(v(y=>({...y,loadingMore:!0})),k(d.page+1,!0).catch(y=>v(C=>({...C,loadingMore:!1,error:(y==null?void 0:y.message)||"Failed to load more."}))))},{rootMargin:"600px 0px 600px 0px"});return o.observe(R.current),()=>o.disconnect()},[d.hasMore,d.loading,d.loadingMore,d.page,k]);const Q=(o,i)=>{var C,h;const b=((C=o.raw)==null?void 0:C._id)||o._id||((h=o.raw)==null?void 0:h.id)||o.id;if(!b)return;const y=i==="general"?`/freeboard/${b}`:`/academic/${b}`;e(l(y))},[g,L]=f.useState(""),[$,ie]=f.useState(""),[Z,$e]=f.useState([]),[N,V]=f.useState("question"),[M,ue]=f.useState("course_materials"),[me,de]=f.useState(""),[U,fe]=f.useState([]),je=o=>fe(i=>i.includes(o)?i.filter(b=>b!==o):[...i,o]),[W,pe]=f.useState(!1),[X,D]=f.useState({type:"",text:""}),ge=c&&g.trim()&&($.trim()||Z.length),J=c&&(N==="question"?g.trim()&&$.trim():M==="course_materials"?g.trim()&&U.length>0:g.trim()),Oe=async o=>{const i=[];for(const b of o)try{const y=await We(b);(y!=null&&y.secure_url||y!=null&&y.url)&&i.push(y.secure_url||y.url)}catch{}return i},Ie=async o=>{if(o.preventDefault(),D({type:"",text:""}),!c){D({type:"error",text:"Login required to post."});return}pe(!0);try{if(u==="general"){if(!ge)throw new Error("Missing fields");let i=[];Z.length&&(i=await Oe(Z)),await Ge({school:a,title:g.trim(),content:$.trim(),images:i}),w(b=>({...b,items:[{_id:Math.random().toString(36).slice(2),title:g.trim(),createdAt:new Date().toISOString(),raw:{title:g.trim(),content:$.trim()}},...b.items]}))}else{if(!J)throw new Error("Missing fields");const i={school:a};N==="question"?await ee({...i,title:g.trim(),content:$.trim(),postType:"question"}):M==="course_materials"?await ee({...i,title:g.trim(),content:"",postType:"seeking",kind:"course_materials",courseName:g.trim(),professor:me.trim(),materials:U,tags:["seeking","course_materials"]}):await ee({...i,title:g.trim(),content:$.trim(),postType:"seeking",kind:M,tags:["seeking",M]}),v(b=>({...b,loading:!0})),await k(1,!1)}L(""),ie(""),$e([]),V("question"),ue("course_materials"),de(""),fe([]),D({type:"success",text:"Posted!"}),setTimeout(()=>D({type:"",text:""}),1200)}catch(i){D({type:"error",text:(i==null?void 0:i.message)||"Failed to post."})}finally{pe(!1)}},Y=u==="general"?{loading:q.loading,items:q.items,hasMore:q.hasMore,error:q.error}:{loading:d.loading,items:d.items,hasMore:d.hasMore,error:d.error,loadingMore:d.loadingMore};return t.createElement("div",{className:"min-h-screen",style:{background:ne.pageBg}},t.createElement("main",{className:"mx-auto max-w-6xl px-4 py-6 grid grid-cols-1 md:grid-cols-[minmax(620px,700px)_380px] gap-10"},t.createElement("section",{className:"md:col-start-1"},t.createElement("div",{className:"-mt-10 md:-mt-12 lg:-mt-14 transition-all"}),t.createElement(Lt,{value:u,onChange:p}),u==="general"?t.createElement(jt,{value:P,onSubmit:o=>{T(o),I(12)},onReset:()=>{T({q:""}),I(12)}}):t.createElement(Ot,{value:{q:_.q,type:_.type,kind:_.kind},onSubmit:o=>F(o),onReset:()=>F({q:"",type:"all",kind:""})}),Y.loading?t.createElement("ul",{className:"mt-4 space-y-3"},Array.from({length:10}).map((o,i)=>t.createElement("li",{key:i,className:"h-16 rounded-xl bg-white/70 border border-slate-200 animate-pulse"}))):Y.items.length?t.createElement(t.Fragment,null,t.createElement("ul",{className:"mt-5 mx-auto max-w-[700px] px-2 space-y-4"},Y.items.map(o=>{var y,C,h;const i=u==="general"||u==="academic"&&qe(o.raw||{})==="question",b=((y=o.raw)==null?void 0:y.commentCount)??((C=o.raw)==null?void 0:C.commentsCount)??(Array.isArray((h=o.raw)==null?void 0:h.comments)?o.raw.comments.length:0);return t.createElement("li",{key:o._id||Math.random()},t.createElement("div",{className:"mx-6 border-b border-slate-300/80 py-3"},t.createElement(qt,{post:o,onOpenDetail:()=>Q(o,u),showBadge:u==="academic",showActionsBar:i,commentCount:b})))})),t.createElement("div",{className:"flex justify-center py-6"},t.createElement("div",{ref:u==="general"?S:R,className:"h-6 w-6 rounded-full border-2 border-dashed border-slate-300","aria-hidden":!0})),u==="academic"&&Y.loadingMore&&t.createElement("div",{className:"text-center pb-8 text-slate-500 text-sm"},"Loading more…")):t.createElement("div",{className:"mx-auto max-w-[700px] text-center py-16"},t.createElement("p",{className:"text-[15px] text-slate-600"},Y.error||"No posts yet."))),t.createElement("aside",{className:"md:col-start-2 md:sticky md:top-[24px] self-start"},t.createElement(Pt,null,t.createElement("form",{onSubmit:Ie},t.createElement(It,{title:g,setTitle:L,active:u,mode:N,lookingKind:M}),t.createElement("div",{className:"p-4 space-y-4"},u==="academic"&&t.createElement("div",{className:"flex items-center gap-2"},t.createElement("button",{type:"button",onClick:()=>V("question"),className:`px-3 py-1.5 rounded-full text-sm border ${N==="question"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,"aria-pressed":N==="question"},"General question"),t.createElement("button",{type:"button",onClick:()=>V("seeking"),className:`px-3 py-1.5 rounded-full text-sm border ${N==="seeking"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,"aria-pressed":N==="seeking"},"Seeking 📥"),N==="seeking"&&t.createElement("select",{value:M,onChange:o=>ue(o.target.value),className:"ml-2 rounded-full border border-slate-300 px-3 py-1.5 text-sm"},t.createElement("option",{value:"course_materials"},"Course Materials"),t.createElement("option",{value:"study_mate"},"Study Mate"),t.createElement("option",{value:"coffee_chat"},"Coffee Chat"))),u==="academic"&&N==="seeking"&&M==="course_materials"?t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-slate-700"},"Professor (optional)"),t.createElement("input",{type:"text",value:me,onChange:o=>de(o.target.value),placeholder:"Professor name (optional)",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-900/10 focus:border-slate-900"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-slate-700 mb-2"},"Personal Materials (choose one or more)"),t.createElement("div",{className:"grid grid-cols-2 gap-2"},St.map(o=>t.createElement("label",{key:o.key,className:`flex items-center gap-2 rounded-xl border px-3 py-2 text-sm cursor-pointer ${U.includes(o.key)?"border-slate-900 bg-slate-900/5":"border-slate-300 hover:bg-slate-50"}`},t.createElement("input",{type:"checkbox",checked:U.includes(o.key),onChange:()=>je(o.key),className:"accent-black"}),t.createElement("span",null,o.label)))),t.createElement("p",{className:"mt-2 text-xs text-slate-500"},"You can select multiple. Title will be used as course name."))):t.createElement("textarea",{value:$,onChange:o=>ie(o.target.value),placeholder:u==="general"?"Write your content here…":N==="question"?"Describe your academic/career question…":M==="study_mate"?"Describe schedule, level, topic…":"Say hello and what you'd like to chat about…",className:"w-full min-h-[120px] rounded-xl border border-slate-300 px-3 py-2 text-[14px] text-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-900/10 focus:border-slate-900"}),t.createElement("div",{className:"flex items-center justify-between pt-2"},t.createElement("p",{className:"text-[12px] text-slate-500"},"Posting to"," ",t.createElement("strong",null,u==="general"?"Freeboard":N==="question"?"Academic":`Seeking: ${M==="course_materials"?"Course Materials":M==="study_mate"?"Study Mate":"Coffee Chat"}`),"."),u==="academic"&&N==="seeking"?t.createElement("div",{className:"flex flex-col items-end"},t.createElement("button",{type:"submit",disabled:!J||W,className:"rounded-xl bg-[#3044f0] px-4 py-2 text-sm font-semibold text-white hover:bg-[#2433c4] active:scale-[0.98] transition-all shadow-md hover:shadow-lg disabled:opacity-60"},W?"Posting…":t.createElement(t.Fragment,null,"Post"," ",t.createElement("span",{className:"line-through text-[11px] text-gray-400 ml-1"},"6 C point"))),t.createElement("span",{className:"text-[10px] text-gray-400 mt-[2px]"},"0 point during beta season")):t.createElement("button",{type:"submit",disabled:W||(u==="general"?!ge:!J),className:"rounded-xl bg-[#3044f0] px-4 py-2 text-sm font-semibold text-white hover:bg-[#2433c4] active:scale-[0.98] transition-all shadow-md hover:shadow-lg disabled:opacity-60"},W?"Posting…":"Post")),!!X.text&&t.createElement("div",{className:`text-sm rounded-lg px-3 py-2 ${X.type==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border-red-200"}`},X.text)))))))}export{Ft as default};
