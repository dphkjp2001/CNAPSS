import{r as p,R as t,b as g,c as x}from"./index-338302ab.js";import{S}from"./ScheduleGrid-47c081cf.js";function C({data:n,onSelect:h}){const[c,b]=p.useState(""),s=e=>e.toLowerCase().replace(/[\s\-]/g,""),l=p.useMemo(()=>!c||!Array.isArray(n)?[]:n.flatMap(e=>Array.isArray(e.sections)?e.sections.map(i=>({course_code:e.course_code,course_title:e.course_title,section_number:i.section_number,class_number:i.class_number,meets:i.meets})):[]).filter(e=>s(e.course_code).includes(s(c))||s(e.course_title).includes(s(c))).slice(0,100),[c,n]);return t.createElement("div",{className:"mb-4"},t.createElement("input",{type:"text",className:"w-full p-2 border rounded text-sm",placeholder:"Search courses by code or title...",value:c,onChange:e=>b(e.target.value),autoComplete:"off"}),t.createElement("div",{className:"space-y-2 max-h-72 overflow-y-auto mt-2"},l.length>0?l.map(e=>t.createElement("div",{key:e.class_number,onClick:()=>h(e),className:"border p-2 rounded bg-white shadow-sm cursor-pointer hover:bg-blue-50 transition"},t.createElement("div",{className:"text-sm font-medium"},e.course_code," - ",e.course_title),t.createElement("div",{className:"text-xs ml-2 text-gray-700"},"Section ",e.section_number,": ",e.meets))):c&&t.createElement("div",{className:"text-sm text-gray-500 p-4"},"No matching courses found.")))}function w(n,h,c){if(!n)return[];const b=/([MTWRF]+)\s(\d{1,2})(?::(\d{2}))?(a|p)?-(\d{1,2})(?::(\d{2}))?(a|p)/i,s=n.match(b);if(!s)return[];const l=s[1],e=parseInt(s[2]),i=parseInt(s[3]||"0"),m=s[4],E=parseInt(s[5]),_=parseInt(s[6]||"0"),r=s[7].toLowerCase(),o=(m||r).toLowerCase(),a=e%12+(o==="p"?12:0),y=E%12+(r==="p"?12:0),u=`${a.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`,f=`${y.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}`,v={M:"MON",T:"TUE",W:"WED",R:"THU",F:"FRI"};return l.split("").map(d=>({day:v[d],start:u,end:f,label:h,class_number:c}))}function R(){const{school:n}=g(),h=x(),[c,b]=p.useState([]),[s,l]=p.useState([]),[e,i]=p.useState(!1),m=(n||"").toLowerCase()==="nyu";p.useEffect(()=>{let r=!0;return m?(i(!0),fetch("/NYU_course_DATA.json").then(o=>o.json()).then(o=>{r&&b(Array.isArray(o)?o:[])}).catch(o=>console.error("Failed to load course data:",o)).finally(()=>{r&&i(!1)}),()=>{r=!1}):(b([]),()=>{})},[m]);const E=r=>{if(s.some(a=>a.label===r.course_code&&a.class_number===r.class_number))l(a=>a.filter(y=>y.class_number!==r.class_number));else{const a=w(r.meets,r.course_code,r.class_number);if(a.some(u=>s.some(f=>f.day===u.day&&!(u.end<=f.start||u.start>=f.end)))){if(!window.confirm("This course conflicts with an existing one. Replace conflicting blocks with this course?"))return;const f=a.flatMap(d=>s.filter(N=>N.day===d.day&&!(d.end<=N.start||d.start>=N.end))).map(d=>d.class_number),v=s.filter(d=>!f.includes(d.class_number));l([...v,...a]);return}l(u=>[...u,...a])}},_=r=>{l(o=>o.filter(a=>a.class_number!==r))};return t.createElement("div",{className:"p-6"},t.createElement("div",{className:"mb-4 flex items-center justify-between"},t.createElement("h1",{className:"text-xl font-semibold"},"Personal Schedule Builder"),!m&&t.createElement("a",{href:h("/dashboard"),className:"text-sm text-blue-600 underline"},"← Back to Dashboard")),m?null:t.createElement("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-5 text-sm text-amber-900"},t.createElement("div",{className:"mb-1 font-semibold"},"Course search is NYU-only (MVP) for now."),t.createElement("p",null,"We don’t have course data for ",t.createElement("b",null,(n||"").toUpperCase())," yet. You can still open the grid and plan manually, but the search box is disabled here.")),t.createElement("div",{className:"mt-4 flex gap-6"},t.createElement("div",{className:"w-3/12"},m?e?t.createElement("div",{className:"text-sm text-gray-500"},"Loading course list…"):t.createElement(C,{data:c,onSelect:E}):t.createElement("div",{className:"rounded-lg border border-gray-200 bg-white p-3 text-sm text-gray-500"},"Course search is unavailable for this school.")),t.createElement("div",{className:"w-9/12"},t.createElement(S,{schedules:s,onRemove:_}))))}export{R as default};
