import{u as v,a as w,b as k,c as h,r as d,R as e,d as u,e as C}from"./index-a74e7749.js";import"./en-6613d7cf.js";import{u as P}from"./useLoginGate-d14fedf4.js";import{l as A,g as S}from"./posts-3ed07744.js";u.extend(C);u.locale("en");const j=s=>({background:s||"linear-gradient(135deg, rgba(124,58,237,0.12), rgba(99,102,241,0.12))"});function O(){const{user:s,token:m}=v(),{school:n,schoolTheme:t}=w(),{ensureAuth:i}=P(),a=k(),r=h(),[x,y]=d.useState([]),[f,b]=d.useState(!0),[g,p]=d.useState("");d.useEffect(()=>{let l=!0;if(n)return(async()=>{b(!0),p("");try{let o;m?o=await A({school:n,token:m}):o=await S({school:n,page:1,limit:10});const N=Array.isArray(o)?o:Array.isArray(o==null?void 0:o.items)?o.items:[];l&&y(N.slice(0,5))}catch{l&&p("Failed to load posts.")}finally{l&&b(!1)}})(),()=>{l=!1}},[n,m]);const E=d.useMemo(()=>((s==null?void 0:s.nickname)||(s!=null&&s.email?s.email.split("@")[0]:"Guest")).slice(0,2).toUpperCase(),[s]);return e.createElement("div",{className:"min-h-screen px-4 py-6 sm:px-6",style:{backgroundColor:(t==null?void 0:t.bg)||"#f6f3ff"}},e.createElement("div",{className:"mx-auto max-w-7xl"},e.createElement("div",{className:"grid grid-cols-1 gap-5 lg:grid-cols-12"},e.createElement("aside",{className:"lg:col-span-3"},e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-6 shadow-sm"},e.createElement("div",{className:"mx-auto mb-4 flex h-24 w-24 items-center justify-center rounded-full text-2xl font-bold text-gray-900",style:j(t==null?void 0:t.bg)},E),e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-lg font-bold text-gray-900"},(s==null?void 0:s.nickname)||"Guest"),e.createElement("div",{className:"mt-0.5 text-xs uppercase tracking-wide text-gray-500"},(n==null?void 0:n.toUpperCase())||"SCHOOL")),e.createElement("nav",{className:"mt-6 space-y-2 text-sm"},e.createElement(c,{onClick:()=>a(r("/myposts"))},"My Posts"),e.createElement(c,{onClick:()=>a(r("/liked"))},"Liked"),e.createElement(c,{onClick:()=>a(r("/commented"))},"Commented"),e.createElement(c,{onClick:()=>a(r("/personal-schedule"))},"Schedule"),e.createElement(c,{onClick:()=>a(r("/market"))},"Marketplace"),e.createElement(c,{onClick:()=>a(r("/foodmap"))},"Food Map")))),e.createElement("main",{className:"lg:col-span-6"},e.createElement("section",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{className:"mb-3 flex items-center justify-between"},e.createElement("h2",{onClick:()=>a(r("/freeboard")),className:"cursor-pointer text-2xl font-extrabold hover:underline",style:{color:(t==null?void 0:t.text)||"#4c1d95"}},"Free Board")),f?e.createElement("ul",{className:"space-y-4"},Array.from({length:3}).map((l,o)=>e.createElement("li",{key:o},e.createElement("div",{className:"h-5 w-2/3 animate-pulse rounded bg-gray-100"}),e.createElement("div",{className:"mt-2 h-3 w-1/3 animate-pulse rounded bg-gray-100"})))):g?e.createElement("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},g):x.length===0?e.createElement("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center text-sm text-gray-600"},"No posts yet. Be the first to write!"):e.createElement("ul",{className:"divide-y divide-gray-100"},x.map(l=>e.createElement("li",{key:l._id,className:"py-4"},e.createElement("button",{onClick:()=>i(()=>a(r(`/freeboard/${l._id}`))),className:"block w-full text-left"},e.createElement("h3",{className:"line-clamp-1 text-base font-semibold text-gray-900 hover:underline"},l.title),e.createElement("p",{className:"mt-1 text-xs text-gray-500"},u(l.createdAt).fromNow()))))),e.createElement("div",{className:"mt-4 text-right"},e.createElement("button",{onClick:()=>i(()=>a(r("/freeboard/write"))),className:"rounded-xl px-4 py-2 text-sm font-semibold text-white shadow",style:{backgroundColor:(t==null?void 0:t.primary)||"#6b46c1"}},"+ Write Post"))),e.createElement("section",{className:"mt-5 rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{className:"mb-3 flex items-center justify-between"},e.createElement("h2",{onClick:()=>a(r("/courses")),className:"cursor-pointer text-2xl font-extrabold hover:underline",style:{color:(t==null?void 0:t.text)||"#4c1d95"}},"CourseHub")),e.createElement("div",{className:"flex justify-end gap-2"},e.createElement("button",{onClick:()=>i(()=>a(r("/courses/write"))),className:"rounded-xl border px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50"},"Upload note"),e.createElement("button",{onClick:()=>a(r("/courses")),className:"rounded-xl px-4 py-2 text-sm font-semibold text-white shadow",style:{backgroundColor:(t==null?void 0:t.primary)||"#6b46c1"}},"Open Course Hub")))),e.createElement("aside",{className:"space-y-5 lg:col-span-3"},e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("h3",{onClick:()=>a(r("/courses")),className:"mb-3 cursor-pointer text-lg font-bold text-gray-900 hover:underline"},"Course Hub"),e.createElement("div",{className:"flex gap-2"},e.createElement("button",{onClick:()=>a(r("/courses/write")),className:"flex-1 rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 shadow-sm hover:bg-gray-50"},"Upload note"),e.createElement("button",{onClick:()=>a(r("/courses")),className:"flex-1 rounded-xl px-3 py-2 text-sm font-semibold text-white shadow",style:{backgroundColor:(t==null?void 0:t.primary)||"#6b46c1"}},"Open Course Hub"))),e.createElement("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm"},e.createElement("div",{onClick:()=>a(r("/foodmap")),className:"mb-2 cursor-pointer text-sm font-semibold text-gray-900 hover:underline"},"üç± Explore Nearby Food"),e.createElement("p",{className:"text-xs text-gray-600"},"Discover top-rated restaurants and cafes near campus."),e.createElement("div",{className:"mt-3 h-28 w-full overflow-hidden rounded-lg bg-gray-100"},e.createElement("div",{className:"h-full w-full animate-pulse"})))))))}function c({children:s,onClick:m}){return e.createElement("button",{onClick:m,className:"w-full rounded-xl border border-transparent px-3 py-2 text-left text-gray-700 hover:border-gray-200 hover:bg-gray-50"},s)}export{O as default};
